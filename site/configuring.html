<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Configurando Aplicações Rails — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/highlight.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/search.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/clipboard.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/search.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr-documents.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/toggle-theme.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Configurando Aplicações Rails — Ruby on Rails Guides" />
  <meta name="description" content="Configurando Aplicações RailsEste guia cobre as configurações e funcionalidades de inicialização disponíveis para aplicações Rails.Após ler esse guia, você vai saber: Como ajustar o comportamento das suas aplicações Rails. Como adicionar código que deve ser executado durante a inicialização da aplicação." />
  <meta property="og:description" content="Configurando Aplicações RailsEste guia cobre as configurações e funcionalidades de inicialização disponíveis para aplicações Rails.Após ler esse guia, você vai saber: Como ajustar o comportamento das suas aplicações Rails. Como adicionar código que deve ser executado durante a inicialização da aplicação." />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:site_name" content="Guia Ruby on Rails" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
    <div id="version-badge">v6.1.4</div>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Veja mais em <a href="https://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        Mais Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://weblog.rubyonrails.org/">Blog</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Guia oficial</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://discuss.rubyonrails.org/">Forum</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Contribua no GitHub</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Voltar para a página principal">Guiarails.com.br</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Home</a></li>
        <li class="guides-search guides-search-large">
          <input class="search-box search-box-large nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">Guias</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>Comece aqui</dt>
                  <dd><a href="getting_started.html">Começando com Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Models</dt>
                  <dd><a href="active_record_basics.html">Active Record Basics</a></dd>
                  <dd><a href="active_record_migrations.html">Active Record Migrations</a></dd>
                  <dd><a href="active_record_validations.html">Active Record Validations</a></dd>
                  <dd><a href="active_record_callbacks.html">Active Record Callbacks</a></dd>
                  <dd><a href="association_basics.html">Active Record Associations</a></dd>
                  <dd><a href="active_record_querying.html">Active Record Query Interface</a></dd>
                  <dd><a href="active_model_basics.html">Active Model Basics</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Views</dt>
                  <dd><a href="action_view_overview.html">Action View Overview</a></dd>
                  <dd><a href="layouts_and_rendering.html">Layouts and Rendering in Rails</a></dd>
                  <dd><a href="action_view_helpers.html">Action View Helpers</a></dd>
                  <dd><a href="form_helpers.html">Action View Form Helpers</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controllers</dt>
                  <dd><a href="action_controller_overview.html">Action Controller Overview</a></dd>
                  <dd><a href="routing.html">Rails Routing from the Outside In</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Outros componentes</dt>
                  <dd><a href="active_support_core_extensions.html">Active Support Core Extensions</a></dd>
                  <dd><a href="action_mailer_basics.html">Action Mailer Basics</a></dd>
                  <dd><a href="action_mailbox_basics.html">Action Mailbox Basics</a></dd>
                  <dd><a href="action_text_overview.html">Action Text Overview</a></dd>
                  <dd><a href="active_job_basics.html">Active Job Basics</a></dd>
                  <dd><a href="active_storage_overview.html">Active Storage Overview</a></dd>
                  <dd><a href="action_cable_overview.html">Action Cable Overview</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Indo mais fundo</dt>
                  <dd><a href="i18n.html">Rails Internationalization (I18n) API</a></dd>
                  <dd><a href="testing.html">Testing Rails Applications</a></dd>
                  <dd><a href="security.html">Securing Rails Applications</a></dd>
                  <dd><a href="debugging_rails_applications.html">Debugging Rails Applications</a></dd>
                  <dd><a href="configuring.html">Configuring Rails Applications</a></dd>
                  <dd><a href="command_line.html">The Rails Command Line</a></dd>
                  <dd><a href="asset_pipeline.html">The Asset Pipeline</a></dd>
                  <dd><a href="working_with_javascript_in_rails.html">Working with JavaScript in Rails</a></dd>
                  <dd><a href="initialization.html">The Rails Initialization Process</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants (Zeitwerk Mode)</a></dd>
                  <dd><a href="autoloading_and_reloading_constants_classic_mode.html">Autoloading and Reloading Constants (Classic Mode)</a></dd>
                  <dd><a href="caching_with_rails.html">Caching with Rails: An Overview</a></dd>
                  <dd><a href="active_support_instrumentation.html">Active Support Instrumentation</a></dd>
                  <dd><a href="api_app.html">Using Rails for API-only Applications</a></dd>
                  <dd><a href="active_record_postgresql.html">Active Record and PostgreSQL</a></dd>
                  <dd><a href="active_record_multiple_databases.html">Multiple Databases with Active Record</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Estendendo o Rails</dt>
                  <dd><a href="plugins.html">The Basics of Creating Rails Plugins</a></dd>
                  <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                  <dd><a href="generators.html">Creating and Customizing Rails Generators &amp; Templates</a></dd>
                  <dd><a href="engines.html">Getting Started with Engines</a></dd>
                  <dd><a href="threading_and_code_execution.html">Threading and Code Execution in Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Contribuições</dt>
                  <dd><a href="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</a></dd>
                  <dd><a href="api_documentation_guidelines.html">API Documentation Guidelines</a></dd>
                  <dd><a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Políticas</dt>
                  <dd><a href="maintenance_policy.html">Maintenance Policy for Ruby on Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Release Notes</dt>
                  <dd><a href="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</a></dd>
                  <dd><a href="6_1_release_notes.html">Version 6.1 - Dezembro 2020</a></dd>
                  <dd><a href="6_0_release_notes.html">Version 6.0 - Agosto 2019</a></dd>
                  <dd><a href="5_2_release_notes.html">Version 5.2 - April 2018</a></dd>
                  <dd><a href="5_1_release_notes.html">Version 5.1 - April 2017</a></dd>
                  <dd><a href="5_0_release_notes.html">Version 5.0 - June 2016</a></dd>
                  <dd><a href="4_2_release_notes.html">Version 4.2 - December 2014</a></dd>
                  <dd><a href="4_1_release_notes.html">Version 4.1 - April 2014</a></dd>
                  <dd><a href="4_0_release_notes.html">Version 4.0 - June 2013</a></dd>
                  <dd><a href="3_2_release_notes.html">Version 3.2 - January 2012</a></dd>
                  <dd><a href="3_1_release_notes.html">Version 3.1 - August 2011</a></dd>
                  <dd><a href="3_0_release_notes.html">Version 3.0 - August 2010</a></dd>
                  <dd><a href="2_3_release_notes.html">Version 2.3 - March 2009</a></dd>
                  <dd><a href="2_2_release_notes.html">Version 2.2 - November 2008</a></dd>
                </div>
            </div>
          </dl>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">Contribua</a></li>
        <li class="guides-search guides-search-small">
          <input class="search-box search-box-small nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guias</option>
              <optgroup label="Comece aqui">
                  <option value="getting_started.html">Começando com Rails</option>
              </optgroup>
              <optgroup label="Models">
                  <option value="active_record_basics.html">Active Record Basics</option>
                  <option value="active_record_migrations.html">Active Record Migrations</option>
                  <option value="active_record_validations.html">Active Record Validations</option>
                  <option value="active_record_callbacks.html">Active Record Callbacks</option>
                  <option value="association_basics.html">Active Record Associations</option>
                  <option value="active_record_querying.html">Active Record Query Interface</option>
                  <option value="active_model_basics.html">Active Model Basics</option>
              </optgroup>
              <optgroup label="Views">
                  <option value="action_view_overview.html">Action View Overview</option>
                  <option value="layouts_and_rendering.html">Layouts and Rendering in Rails</option>
                  <option value="action_view_helpers.html">Action View Helpers</option>
                  <option value="form_helpers.html">Action View Form Helpers</option>
              </optgroup>
              <optgroup label="Controllers">
                  <option value="action_controller_overview.html">Action Controller Overview</option>
                  <option value="routing.html">Rails Routing from the Outside In</option>
              </optgroup>
              <optgroup label="Outros componentes">
                  <option value="active_support_core_extensions.html">Active Support Core Extensions</option>
                  <option value="action_mailer_basics.html">Action Mailer Basics</option>
                  <option value="action_mailbox_basics.html">Action Mailbox Basics</option>
                  <option value="action_text_overview.html">Action Text Overview</option>
                  <option value="active_job_basics.html">Active Job Basics</option>
                  <option value="active_storage_overview.html">Active Storage Overview</option>
                  <option value="action_cable_overview.html">Action Cable Overview</option>
              </optgroup>
              <optgroup label="Indo mais fundo">
                  <option value="i18n.html">Rails Internationalization (I18n) API</option>
                  <option value="testing.html">Testing Rails Applications</option>
                  <option value="security.html">Securing Rails Applications</option>
                  <option value="debugging_rails_applications.html">Debugging Rails Applications</option>
                  <option value="configuring.html">Configuring Rails Applications</option>
                  <option value="command_line.html">The Rails Command Line</option>
                  <option value="asset_pipeline.html">The Asset Pipeline</option>
                  <option value="working_with_javascript_in_rails.html">Working with JavaScript in Rails</option>
                  <option value="initialization.html">The Rails Initialization Process</option>
                  <option value="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants (Zeitwerk Mode)</option>
                  <option value="autoloading_and_reloading_constants_classic_mode.html">Autoloading and Reloading Constants (Classic Mode)</option>
                  <option value="caching_with_rails.html">Caching with Rails: An Overview</option>
                  <option value="active_support_instrumentation.html">Active Support Instrumentation</option>
                  <option value="api_app.html">Using Rails for API-only Applications</option>
                  <option value="active_record_postgresql.html">Active Record and PostgreSQL</option>
                  <option value="active_record_multiple_databases.html">Multiple Databases with Active Record</option>
              </optgroup>
              <optgroup label="Estendendo o Rails">
                  <option value="plugins.html">The Basics of Creating Rails Plugins</option>
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators &amp; Templates</option>
                  <option value="engines.html">Getting Started with Engines</option>
                  <option value="threading_and_code_execution.html">Threading and Code Execution in Rails</option>
              </optgroup>
              <optgroup label="Contribuições">
                  <option value="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</option>
                  <option value="api_documentation_guidelines.html">API Documentation Guidelines</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</option>
              </optgroup>
              <optgroup label="Políticas">
                  <option value="maintenance_policy.html">Maintenance Policy for Ruby on Rails</option>
              </optgroup>
              <optgroup label="Release Notes">
                  <option value="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</option>
                  <option value="6_1_release_notes.html">Version 6.1 - Dezembro 2020</option>
                  <option value="6_0_release_notes.html">Version 6.0 - Agosto 2019</option>
                  <option value="5_2_release_notes.html">Version 5.2 - April 2018</option>
                  <option value="5_1_release_notes.html">Version 5.1 - April 2017</option>
                  <option value="5_0_release_notes.html">Version 5.0 - June 2016</option>
                  <option value="4_2_release_notes.html">Version 4.2 - December 2014</option>
                  <option value="4_1_release_notes.html">Version 4.1 - April 2014</option>
                  <option value="4_0_release_notes.html">Version 4.0 - June 2013</option>
                  <option value="3_2_release_notes.html">Version 3.2 - January 2012</option>
                  <option value="3_1_release_notes.html">Version 3.1 - August 2011</option>
                  <option value="3_0_release_notes.html">Version 3.0 - August 2010</option>
                  <option value="2_3_release_notes.html">Version 2.3 - March 2009</option>
                  <option value="2_2_release_notes.html">Version 2.2 - November 2008</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Configurando Aplicações Rails</h2><p>Este guia cobre as configurações e funcionalidades de inicialização disponíveis
para aplicações Rails.</p><p>Após ler esse guia, você vai saber:</p>
<ul>
<li>Como ajustar o comportamento das suas aplicações Rails.</li>
<li>Como adicionar código que deve ser executado durante a inicialização da
aplicação.</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#locais-para-codigo-de-inicializacao">Locais para Código de Inicialização</a></li>
<li><a href="#executando-codigo-antes-do-rails">Executando Código Antes do Rails</a></li>
<li>
<a href="#configurando-componentes-rails">Configurando Componentes Rails</a>

<ul>
<li><a href="#configuracao-geral-do-rails">Configuração Geral do Rails</a></li>
<li><a href="#configuring-assets">Configuring Assets</a></li>
<li><a href="#configuring-generators">Configuring Generators</a></li>
<li><a href="#configuring-middleware">Configuring Middleware</a></li>
<li><a href="#configuring-i18n">Configuring i18n</a></li>
<li><a href="#configuring-active-model">Configuring Active Model</a></li>
<li><a href="#configuring-active-record">Configuring Active Record</a></li>
<li><a href="#configuring-action-controller">Configuring Action Controller</a></li>
<li><a href="#configuring-action-dispatch">Configuring Action Dispatch</a></li>
<li><a href="#configuring-action-view">Configuring Action View</a></li>
<li><a href="#configuring-action-mailbox">Configuring Action Mailbox</a></li>
<li><a href="#configuring-action-mailer">Configuring Action Mailer</a></li>
<li><a href="#configuring-active-support">Configuring Active Support</a></li>
<li><a href="#configuring-active-job">Configuring Active Job</a></li>
<li><a href="#configuring-action-cable">Configuring Action Cable</a></li>
<li><a href="#configuring-active-storage">Configuring Active Storage</a></li>
<li><a href="#results-of-config-load-defaults">Results of <code>config.load_defaults</code></a></li>
<li><a href="#configuring-a-database">Configuring a Database</a></li>
<li><a href="#connection-preference">Connection Preference</a></li>
<li><a href="#creating-rails-environments">Creating Rails Environments</a></li>
<li><a href="#deploy-to-a-subdirectory-relative-url-root">Deploy to a Subdirectory (relative URL root)</a></li>
</ul>
</li>
<li><a href="#rails-environment-settings">Rails Environment Settings</a></li>
<li><a href="#using-initializer-files">Using Initializer Files</a></li>
<li>
<a href="#initialization-events">Initialization events</a>

<ul>
<li><a href="#rails-railtie-initializer"><code>Rails::Railtie#initializer</code></a></li>
<li><a href="#initializers">Initializers</a></li>
</ul>
</li>
<li><a href="#database-pooling">Database pooling</a></li>
<li><a href="#custom-configuration">Custom configuration</a></li>
<li><a href="#search-engines-indexing">Search Engines Indexing</a></li>
<li><a href="#evented-file-system-monitor">Evented File System Monitor</a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="locais-para-codigo-de-inicializacao"><a class="anchorlink" href="#locais-para-codigo-de-inicializacao">1 Locais para Código de Inicialização</a></h3><p>O Rails oferece quatro opções padrão para adicionar código para a inicialização:</p>
<ul>
<li><code>config/application.rb</code></li>
<li>Arquivos de configuração específicos para os ambientes</li>
<li><em>Initializers</em></li>
<li>Pós <em>initializers</em>
</li>
</ul>
<h3 id="executando-codigo-antes-do-rails"><a class="anchorlink" href="#executando-codigo-antes-do-rails">2 Executando Código Antes do Rails</a></h3><p>Em raras situações em que sua aplicação necessita executar código antes que o
próprio Rails tenha sido carregado, coloque este código acima da chamada 
<code>require "rails/all"</code> no arquivo <code>config/application.rb</code>.</p><h3 id="configurando-componentes-rails"><a class="anchorlink" href="#configurando-componentes-rails">3 Configurando Componentes Rails</a></h3><p>Em geral, o ato de configurar o Rails significa configurar os componentes do
Rails, assim como configurar o Rails em si. O arquivo de configuração
<code>config/application.rb</code> e arquivos de configuração específicos de ambiente (como
o arquivo <code>config/environments/production.rb</code>) permitem definir diversas
configurações que serão passadas para todos os componentes.</p><p>Por exemplo, você pode adicionar a configuração abaixo ao arquivo
<code>config/application.rb</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">time_zone</span> <span class="o">=</span> <span class="s1">'Brasilia'</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8af5e6bbe0158712822d3ed88de61883">config.time_zone = 'Brasilia'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8af5e6bbe0158712822d3ed88de61883">Copiar</button>
</div>
<p>Essa é uma configuração para o próprio Rails. Se você deseja definir ajustes
para componentes do Rails, você pode fazê-lo através do mesmo objeto <code>config</code> em
<code>config/application.rb</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">schema_format</span> <span class="o">=</span> <span class="ss">:ruby</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-5a663d85d341b2b92ada0b191802e697">config.active_record.schema_format = :ruby
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-5a663d85d341b2b92ada0b191802e697">Copiar</button>
</div>
<p>O Rails vai usar essa configuração em particular no Active Record.</p><h4 id="configuracao-geral-do-rails"><a class="anchorlink" href="#configuracao-geral-do-rails">3.1 Configuração Geral do Rails</a></h4><p>Esses métodos de configuração devem ser enviados para objetos do tipo
<code>Rails::Railtie</code>, como uma subclasse de <code>Rails::Engine</code> ou
<code>Rails::Application</code>.</p>
<ul>
<li>
<code>config.after_initialize</code> recebe um bloco que será executado <em>após</em> a inicialização da aplicação Rails. Isso inclui a inicialização do <em>framework</em> em si, <em>engines</em>  e todos <em>initializers</em>  definidos em
<code>config/initializers</code>. Perceba que esse bloco <em>será</em> executado em tarefas
<em>rake</em>. Essa opção é útil para configurações feitas por outros <em>initializers</em>:</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">after_initialize</span> <span class="k">do</span>
  <span class="no">ActionView</span><span class="o">::</span><span class="no">Base</span><span class="p">.</span><span class="nf">sanitized_allowed_tags</span><span class="p">.</span><span class="nf">delete</span> <span class="s1">'div'</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-72308b13110bcb6fc96938fb9eeb3448">config.after_initialize do
  ActionView::Base.sanitized_allowed_tags.delete 'div'
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-72308b13110bcb6fc96938fb9eeb3448">Copiar</button>
</div>

<ul>
<li><p><code>config.asset_host</code> define o <em>host</em> para os <em>assets</em>. Essa opção é útil quando
CDNs são usados para hospedar <em>assets</em>, ou para quando você deseja contornar
restrições de concorrência embutidas em navegadores usando diferentes <em>aliases</em>
de domínios. Essa é uma versão encurtada de <code>config.action_controller.asset_host</code>.</p></li>
<li><p><code>config.autoload_once_paths</code> aceita um <em>array</em> de caminhos de onde o Rails
deve carregar automaticamente constantes que não serão removidas por uma
requisição. Essa configuração é relevante se <code>config.cache_classes</code> está definido como
<code>false</code>, que é o padrão no modo de desenvolvimento. De outra forma,
todo auto carregamento acontece somente uma vez. Todos elementos desse array
devem estar também em <code>autoload_paths</code>. O valor padrão é um <em>array</em> vazio.</p></li>
<li><p><code>config.autoload_paths</code> aceita um <em>array</em> de caminhos de onde o Rails deve
carregar automaticamente constantes. O padrão é um array vazio. Desde o <a href="upgrading_ruby_on_rails.html#autoloading">Rails 6</a>,
não é mais recomendado ajustar essa configuração. Veja mais em <a href="autoloading_and_reloading_constants.html#autoload-paths-and-eager-load-paths">Auto carregamento e Recarregando Constantes</a></p></li>
<li><p><code>config.add_autoload_paths_to_load_path</code> determina se os caminhos de auto carregamento devem ser adicionados para <code>$LOAD_PATH</code>. Esta configuração é <code>true</code> por padrão, mas é recomendado que seja
definida como <code>false</code> no recém lançado modo <code>:zeitwerk</code>, em
<code>config/application.rb</code>. O modo <em>Zeitwerk</em> usa caminhos absolutos internamente e
aplicações executadas neste  modo não necessitam de <code>require_dependency</code>, então <em>models</em>, <em>controllers</em>, <em>jobs</em>, <em>etc</em> não 
precisam estar no <code>$LOAD_PATH</code>. Ao ser definido como <code>false</code>, previne o Ruby de
verificar estes diretórios quando resolver chamadas de <code>require</code> com caminhos
relativos e reduz o processamento e o consumo de memória RAM do <code>Bootsnap</code>, já
que ele não precisa construir um índice para eles.</p></li>
<li><p><code>config.cache_classes</code> controla quando as classes e módulos da aplicação devem ser recarregados em caso de mudanças.
O padrão é <code>false</code> no modo desenvolvimento e <code>true</code> no modo de produção. No modo de <code>test</code>, o padrão é <code>false</code> se o Spring estiver instalado, caso contrário é <code>true</code>.</p></li>
<li><p><code>config.beginning_of_week</code> configura o começo da semana para a aplicação. O
valor deve ser um <em>symbol</em> com um dia da semana válido (por ex: <code>:monday</code>).</p></li>
<li><p><code>config.cache_store</code> configura qual armazenamento de <em>cache</em> o Rails deve utilizar. As opções
incluem um dos <em>symbols</em>: <code>:memory_store</code>, <code>:file_store</code>, <code>:mem_cache_store</code>, <code>:null_store</code>, <code>:redis_cache_store</code>, 
ou um objeto que implementa a API de cache. O padrão é <code>:file_store</code>. Veja <a href="caching_with_rails.html#cache-stores">Cache Stores</a> para opções de configuração por <em>store</em>.</p></li>
<li><p><code>config.colorize_logging</code> determina quando utilizar ou não códigos de cores ANSI ao registrar informações no <em>log</em>. O padrão é <code>true</code>.</p></li>
<li><p><code>config.consider_all_requests_local</code> quando <code>true</code> adiciona
informações detalhadas de <em>debug</em> de erros à resposta HTTP, e o <em>controller</em>
<code>Rails::Info</code> irá exibir o contexto de execução da aplicação em
<code>/rails/info/properties</code>. <code>true</code> é o padrão nos ambientes de desenvolvimento e
teste e <code>false</code> é o padrão no modo de produção. Para um controle mais refinado,
defina como <code>false</code> e implemente o método <code>show_detailed_exceptions?</code> em seus <em>controllers</em>
para especificar que requisições devem prover informações de <em>debug</em> em erros.</p></li>
<li>
<p><code>config.console</code>  permite que você defina qual classe deve ser usada quando executar <code>bin/rails console</code>. É melhor que seja executada dentre de um bloco <code>console</code>: </p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">console</span> <span class="k">do</span>
  <span class="c1"># este bloco só é chamado quando o console estiver executando,</span>
  <span class="c1"># então podemos requerer o pry de forma segura</span>
  <span class="nb">require</span> <span class="s2">"pry"</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">console</span> <span class="o">=</span> <span class="no">Pry</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-653fa979509ae6b4f001c15762cc40a8">console do
  # este bloco só é chamado quando o console estiver executando,
  # então podemos requerer o pry de forma segura
  require "pry"
  config.console = Pry
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-653fa979509ae6b4f001c15762cc40a8">Copiar</button>
</div>
</li>
<li><p><code>config.disable_sandbox</code> controla se o <em>console</em> pode ser iniciado ou não no
modo <em>sandbox</em>. Esta configuração é útil para evitar sessões muito longas de console em
modo <em>sandbox</em>, o que poderia levar o servidor de banco de dados a ficar sem
memória. O padrão é <em>false</em>.</p></li>
<li><p><code>config.eager_load</code> quando <code>true</code>, todos <em>namespaces</em> definidos em <code>config.eager_load_namespaces</code> são carregados de forma ativa (<em>eager load</em>).
Isto inclui a sua aplicação, <em>engines</em>, frameworks do Rails e qualquer outra
<em>namespace</em> definida.</p></li>
<li><p><code>config.eager_load_namespaces</code> define todas <em>namespaces</em> que serão carregadas ativamente (<em>eager load</em>) quando <code>config.eager_load</code> estiver definido como <code>true</code>.
Todas <em>namespaces</em> na lista devem responder ao método <code>eager_load!</code>.</p></li>
<li><p><code>config.eager_load_paths</code> recebe um <em>array</em> de caminhos de onde o Rails deve carregar ativamente durante a inicialização se o cache de classes está ativo.
O padrão são todas as pastas dentro do diretório <code>app</code>.</p></li>
<li><p><code>config.enable_dependency_loading</code>: quando definido como <code>true</code>, habilita o autocarregamento mesmo que a aplicação esteja carregada ativamente (<em>eager load</em>)
e que <code>config.cache_classes</code> esteja definido como <code>true</code>. O padrão é <code>false</code></p></li>
<li><p><code>config.encoding</code> define o <em>encoding</em> para toda a aplicação. O padrão é UTF-8.</p></li>
<li><p><code>config.exceptions_app</code> define a aplicação invocada pelo <em>middleware</em>
<code>ShowException</code> quando uma exceção acontece. O padrão é <code>ActionDispatch::PublicExceptions.new(Rails.public_path)</code>.</p></li>
<li><p><code>config.debug_exception_response_format</code> define o formato usado nas respostas quando errors acontecem em modo desenvolvimento.
O padrão é <code>:api</code> para aplicações somente API e <code>:default</code> para aplicações
regulares.</p></li>
<li><p><code>config.file_watcher</code> é a classe usada para detectar atualizações nos arquivos
quando <code>config.reload_classes_only_on_change</code> está definido como <code>true</code>. Rails é distribuído com a classe <code>ActiveSupport::FileUpdateChecker</code>, 
que é o padrão, e com <code>ActiveSupport::EventedFileUpdateChecker</code> (que depende da gem <a href="https://github.com/guard/listen">listen</a>).
Classes customizadas devem respeitar a API de <code>ActiveSupport::FileUpdateChecker</code>.</p></li>
<li><p><code>config.filter_parameters</code> é usado para filtrar os parâmetros que você não
deseja exibir nos <em>logs</em>, tais como senhas ou números de cartões de crédito.
Essa configuração também filtra valores sensíveis de colunas de bancos de dados
quando o método <code>#inspect</code> é enviado a um objeto de <em>Active Record</em>. Por padrão o
Rails filtra senhas ao adicionar  <code>Rails.application.config.filter_parameters += [:password]</code> em <code>config/initializers/filter_parameter_logging.rb</code>. 
O filtro de parâmetros funciona através da equivalência parcial de expressões
regulares.</p></li>
<li><p><code>config.force_ssl</code> impõe que todas requisições sejam tratadas através de HTTPS e define "https://" como protocolo padrão para gerar URLs. Execução de HTTPS é manipulada pelo <em>middleware</em> <code>ActionDispatch::SSL</code>, que pode ser configurado através de <code>config.ssl_options</code> - veja <a href="https://api.rubyonrails.org/v6.1.4/classes/ActionDispatch/SSL.html">a documentação</a> para mais detalhes.</p></li>
<li><p><code>config.javascript_path</code> define o caminho onde o JavaScript da sua aplicação
reside em relação ao diretório <code>app</code>. O padrão é <code>javascript</code>, usado pelo
<a href="https://github.com/rails/webpacker">webpacker</a>. O <code>javascript_path</code> configurado
de uma aplicação será excluído de <code>autoload_paths</code>.</p></li>
<li><p><code>config.log_formatter</code> define o formatador do <em>logger</em> do Rails. O valor
padrão é uma instância de <code>ActiveSupport::Logger::SimpleFormatter</code> para todos os ambientes.
Se você definir um valor para <code>config.logger</code> você deve enviar o valor do seu
formatador manualmente, antes que ele seja acondicionado em uma instância de <code>ActiveSupport::TaggedLogging</code>, o Rails não fará isso por você.</p></li>
<li><p><code>config.log_level</code> define a verbosidade do <em>logger</em> do Rails. O padrão dessa
opção é <code>:debug</code> para todos ambientes exceto produção, onde o padrão é <code>:info</code>. Os níveis disponíveis são <code>:debug</code>,
<code>:info</code>, <code>:warn</code>, <code>:error</code>, <code>:fatal</code>, e <code>:unknown</code>.</p></li>
<li><p><code>config.log_tags</code> aceita uma lista de: mmétodos que o objeto <code>request</code>
responde, uma <code>Proc</code> que aceita um objeto de <code>request</code>, ou algo que responda
ao método <code>to_s</code>. Isto torna fácil adicionar linhas ao <em>log</em> com informações
sobre o <em>debug</em>, como subdomínios e <em>ids</em> de requisições - ambos muito úteis
para <em>debugar</em> aplicações multi-usuário em produção.</p></li>
<li>
<p><code>config.logger</code> é o <em>logger</em> que será usado pelo <code>Rails.logger</code> e qualquer
outro <em>log</em> relacionado ao Rails, tal como <code>ActiveRecord::Base.logger</code>. 
O padrão é uma instância de <code>ActiveSupport::TaggedLogging</code> que envolve uma instância de <code>ActiveSupport::Logger</code>, que registra a saída do <em>log</em> no diretório <code>log/</code>.
Você pode informar um <em>logger</em> personalizado mas para obter compatibilidade total
você deve seguir esses requisitos:</p>
<ul>
<li>Para suportar um formatador, você deve atribuir manualmente o formatador definido em
<code>config.log_formatter</code> para o <em>logger</em>.</li>
<li>Para suportar <em>logs</em> com etiquetaas (<em>tags</em>), a instância do <em>log</em> deve ser
envolvida com <code>ActiveSupport::TaggedLogging</code>
</li>
<li>Para suportar o silenciamento, o <em>logger</em> deve incluir o módulo <code>ActiveSupport::LoggerSilence</code>. A classe <code>ActiveSupport::Logger</code> já inclui esse módulo.</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">MyLogger</span> <span class="o">&lt;</span> <span class="o">::</span><span class="no">Logger</span>
  <span class="kp">include</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">LoggerSilence</span>
<span class="k">end</span>

<span class="n">mylogger</span>           <span class="o">=</span> <span class="no">MyLogger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
<span class="n">mylogger</span><span class="p">.</span><span class="nf">formatter</span> <span class="o">=</span> <span class="n">config</span><span class="p">.</span><span class="nf">log_formatter</span>
<span class="n">config</span><span class="p">.</span><span class="nf">logger</span>      <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">TaggedLogging</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">mylogger</span><span class="p">)</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-0006e58c9678dbe4ecd385f08b62ad95">class MyLogger &lt; ::Logger
  include ActiveSupport::LoggerSilence
end

mylogger           = MyLogger.new(STDOUT)
mylogger.formatter = config.log_formatter
config.logger      = ActiveSupport::TaggedLogging.new(mylogger)
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-0006e58c9678dbe4ecd385f08b62ad95">Copiar</button>
</div>
</li>
<li><p><code>config.middleware</code> permite configurar o <em>middleware</em> da aplicação. Esse tópico é coberto em detalhes em <a href="#configuring-middleware">Configurando o Middleware</a>.</p></li>
<li><p><code>config.rake_eager_load</code> quando<code>true</code>, carrega antecipadamente a aplicação ao executar tarefas Rake. O padrão é <code>false</code>.</p></li>
<li><p><code>config.reload_classes_only_on_change</code> habilita ou desabilita a recarga de
classes somente quando arquivos monitorados são modificados. Por padrão são
monitorados todos caminhos de auto carregamento (<em>autoload</em>). Se
<code>config.cache_classes</code> está definido como <code>true</code> essa opção é ignorada. </p></li>
<li><p><code>config.credentials.content_path</code> configura o caminho para busca por credenciais criptografadas.</p></li>
<li><p><code>config.credentials.key_path</code> configura o caminho para busca por chaves de
criptografia.</p></li>
<li><p><code>secret_key_base</code> é usado para especificar uma chave que permite que sessões
da aplicação sejam verificadas contra uma chave segura conhecida prevenindo falsificações (<em>tampering</em>). Aplicações recebem uma chave gerada
aleatoriamente nos ambientes de desenvolvimento e teste, outros ambientes devem
definir uma chave em <code>config/credentials.yml.enc</code>.</p></li>
<li><p><code>config.require_master_key</code> faz com que a app não inicialize se uma chave mestre (<em>master key</em>) não tiver sido disponibilizada através de <code>ENV["RAILS_MASTER_KEY"]</code> ou do arquivo <code>config/master.key</code>.</p></li>
<li><p><code>config.public_file_server.enabled</code> configura o Rails para servir arquivos estáticos a partir do diretório <code>public</code>.
O padrão é <code>true</code>, mas no ambiente de produção é definido como <code>false</code> porque o
software servidor (como NGINX ou Apache) usado para executar a aplicação deve
servir os arquivos estáticos. Se você esta executando ou testando sua aplicação
em produção usando WEBrick (não é recomendado usar WEBrick em produção)
defina a opção como <code>true</code>. De outra forma, você não será capaz de usar o
cacheamento de páginas e requisições para arquivos que existam no diretório
<code>public</code>.</p></li>
<li>
<p><code>config.session_store</code> define que classe usar para armazenar a sessão. Os
valores possíveis são <code>:cookie_store</code>, que é o padrão, <code>:mem_cache_store</code> e
<code>:disabled</code>. O último indica que o Rails não deve tratar de sessões. O padrão
armazena <em>cookies</em> com o nome da aplicação como a chave da sessão. Armazenadores
personalizados de sessão também podem ser definidos:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">session_store</span> <span class="ss">:my_custom_store</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9f4abb7b2f7a6e9d71f482539d171dc6">config.session_store :my_custom_store
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9f4abb7b2f7a6e9d71f482539d171dc6">Copiar</button>
</div>
<p>Esse armazenador personalizado deve ser definido como <code>ActionDispatch::Session::MyCustomStore</code>.</p>
</li>
<li><p><code>config.time_zone</code> define o fuso horário para a aplicação e torna o <em>Active Record</em> ciente deste fuso horário.</p></li>
<li>
<p><code>config.autoloader</code> configura o modo de autocarregamento. O padrão é
<code>:zeitwerk</code> se em <code>config.load_defaults</code> o valor for <code>6.0</code> ou maior. Aplicações ainda
podem usar o autocarregador clássico ao definir o valor dessa configuração
como <code>:classic</code> após carregar os valores padrões do <em>framework</em>:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">load_defaults</span> <span class="mf">6.0</span>
<span class="n">config</span><span class="p">.</span><span class="nf">autoloader</span> <span class="o">=</span> <span class="ss">:classic</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a3241c3b759c663992ce3826586895a9">config.load_defaults 6.0
config.autoloader = :classic
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a3241c3b759c663992ce3826586895a9">Copiar</button>
</div>
</li>
</ul>
<h4 id="configuring-assets"><a class="anchorlink" href="#configuring-assets">3.2 Configuring Assets</a></h4>
<ul>
<li><p><code>config.assets.enabled</code> a flag that controls whether the asset
pipeline is enabled. It is set to <code>true</code> by default.</p></li>
<li><p><code>config.assets.css_compressor</code> defines the CSS compressor to use. It is set by default by <code>sass-rails</code>. The unique alternative value at the moment is <code>:yui</code>, which uses the <code>yui-compressor</code> gem.</p></li>
<li><p><code>config.assets.js_compressor</code> defines the JavaScript compressor to use. Possible values are <code>:closure</code>, <code>:uglifier</code> and <code>:yui</code> which require the use of the <code>closure-compiler</code>, <code>uglifier</code> or <code>yui-compressor</code> gems respectively.</p></li>
<li><p><code>config.assets.gzip</code> a flag that enables the creation of gzipped version of compiled assets, along with non-gzipped assets. Set to <code>true</code> by default.</p></li>
<li><p><code>config.assets.paths</code> contains the paths which are used to look for assets. Appending paths to this configuration option will cause those paths to be used in the search for assets.</p></li>
<li><p><code>config.assets.precompile</code> allows you to specify additional assets (other than <code>application.css</code> and <code>application.js</code>) which are to be precompiled when <code>rake assets:precompile</code> is run.</p></li>
<li><p><code>config.assets.unknown_asset_fallback</code> allows you to modify the behavior of the asset pipeline when an asset is not in the pipeline, if you use sprockets-rails 3.2.0 or newer. Defaults to <code>false</code>.</p></li>
<li><p><code>config.assets.prefix</code> defines the prefix where assets are served from. Defaults to <code>/assets</code>.</p></li>
<li><p><code>config.assets.manifest</code> defines the full path to be used for the asset precompiler's manifest file. Defaults to a file named <code>manifest-&lt;random&gt;.json</code> in the <code>config.assets.prefix</code> directory within the public folder.</p></li>
<li><p><code>config.assets.digest</code> enables the use of SHA256 fingerprints in asset names. Set to <code>true</code> by default.</p></li>
<li><p><code>config.assets.debug</code> disables the concatenation and compression of assets. Set to <code>true</code> by default in <code>development.rb</code>.</p></li>
<li><p><code>config.assets.version</code> is an option string that is used in SHA256 hash generation. This can be changed to force all files to be recompiled.</p></li>
<li><p><code>config.assets.compile</code> is a boolean that can be used to turn on live Sprockets compilation in production.</p></li>
<li><p><code>config.assets.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby <code>Logger</code> class. Defaults to the same configured at <code>config.logger</code>. Setting <code>config.assets.logger</code> to <code>false</code> will turn off served assets logging.</p></li>
<li><p><code>config.assets.quiet</code> disables logging of assets requests. Set to <code>true</code> by default in <code>development.rb</code>.</p></li>
</ul>
<h4 id="configuring-generators"><a class="anchorlink" href="#configuring-generators">3.3 Configuring Generators</a></h4><p>Rails allows you to alter what generators are used with the <code>config.generators</code> method. This method takes a block:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">orm</span> <span class="ss">:active_record</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">test_framework</span> <span class="ss">:test_unit</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a956a0d63347544e93a88b883974e72c">config.generators do |g|
  g.orm :active_record
  g.test_framework :test_unit
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a956a0d63347544e93a88b883974e72c">Copiar</button>
</div>
<p>The full set of methods that can be used in this block are as follows:</p>
<ul>
<li>
<code>assets</code> allows to create assets on generating a scaffold. Defaults to <code>true</code>.</li>
<li>
<code>force_plural</code> allows pluralized model names. Defaults to <code>false</code>.</li>
<li>
<code>helper</code> defines whether or not to generate helpers. Defaults to <code>true</code>.</li>
<li>
<code>integration_tool</code> defines which integration tool to use to generate integration tests. Defaults to <code>:test_unit</code>.</li>
<li>
<code>system_tests</code> defines which integration tool to use to generate system tests. Defaults to <code>:test_unit</code>.</li>
<li>
<code>orm</code> defines which orm to use. Defaults to <code>false</code> and will use Active Record by default.</li>
<li>
<code>resource_controller</code> defines which generator to use for generating a controller when using <code>bin/rails generate resource</code>. Defaults to <code>:controller</code>.</li>
<li>
<code>resource_route</code> defines whether a resource route definition should be generated
or not. Defaults to <code>true</code>.</li>
<li>
<code>scaffold_controller</code> different from <code>resource_controller</code>, defines which generator to use for generating a <em>scaffolded</em> controller when using <code>bin/rails generate scaffold</code>. Defaults to <code>:scaffold_controller</code>.</li>
<li>
<code>stylesheets</code> turns on the hook for stylesheets in generators. Used in Rails for when the <code>scaffold</code> generator is run, but this hook can be used in other generates as well. Defaults to <code>true</code>.</li>
<li>
<code>stylesheet_engine</code> configures the stylesheet engine (for e.g. sass) to be used when generating assets. Defaults to <code>:css</code>.</li>
<li>
<code>scaffold_stylesheet</code> creates <code>scaffold.css</code> when generating a scaffolded resource. Defaults to <code>true</code>.</li>
<li>
<code>test_framework</code> defines which test framework to use. Defaults to <code>false</code> and will use minitest by default.</li>
<li>
<code>template_engine</code> defines which template engine to use, such as ERB or Haml. Defaults to <code>:erb</code>.</li>
</ul>
<h4 id="configuring-middleware"><a class="anchorlink" href="#configuring-middleware">3.4 Configuring Middleware</a></h4><p>Every Rails application comes with a standard set of middleware which it uses in this order in the development environment:</p>
<ul>
<li>
<p>  <code>ActionDispatch::HostAuthorization</code> prevents against DNS rebinding and other <code>Host</code> header attacks.
It is included in the development environment by default with the following configuration:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">=</span> <span class="p">[</span>
  <span class="no">IPAddr</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"0.0.0.0/0"</span><span class="p">),</span> <span class="c1"># All IPv4 addresses.</span>
  <span class="no">IPAddr</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"::/0"</span><span class="p">),</span>      <span class="c1"># All IPv6 addresses.</span>
  <span class="s2">"localhost"</span>              <span class="c1"># The localhost reserved domain.</span>
<span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8df67cd23884187a3eafd17922bec76a">Rails.application.config.hosts = [
  IPAddr.new("0.0.0.0/0"), # All IPv4 addresses.
  IPAddr.new("::/0"),      # All IPv6 addresses.
  "localhost"              # The localhost reserved domain.
]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8df67cd23884187a3eafd17922bec76a">Copiar</button>
</div>
<p>In other environments <code>Rails.application.config.hosts</code> is empty and no
<code>Host</code> header checks will be done. If you want to guard against header
attacks on production, you have to manually permit the allowed hosts
with:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="s2">"product.com"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-6eba82b7c7bbff82637f8b3aa06ebedc">Rails.application.config.hosts &lt;&lt; "product.com"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-6eba82b7c7bbff82637f8b3aa06ebedc">Copiar</button>
</div>
<p>The host of a request is checked against the <code>hosts</code> entries with the case
operator (<code>#===</code>), which lets <code>hosts</code> support entries of type <code>Regexp</code>,
<code>Proc</code> and <code>IPAddr</code> to name a few. Here is an example with a regexp.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># Allow requests from subdomains like `www.product.com` and</span>
<span class="c1"># `beta1.product.com`.</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="sr">/.*\.product\.com/</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-0d85f2e36b52570f6c339bf1a352ac9a"># Allow requests from subdomains like `www.product.com` and
# `beta1.product.com`.
Rails.application.config.hosts &lt;&lt; /.*\.product\.com/
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-0d85f2e36b52570f6c339bf1a352ac9a">Copiar</button>
</div>
<p>The provided regexp will be wrapped with both anchors (<code>\A</code> and <code>\z</code>) so it
must match the entire hostname. <code>/product.com/</code>, for example, once anchored,
would fail to match <code>www.product.com</code>.</p>
<p>A special case is supported that allows you to permit all sub-domains:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># Allow requests from subdomains like `www.product.com` and</span>
<span class="c1"># `beta1.product.com`.</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">hosts</span> <span class="o">&lt;&lt;</span> <span class="s2">".product.com"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3811dfb7a49b6e5705b143929f6a7d2e"># Allow requests from subdomains like `www.product.com` and
# `beta1.product.com`.
Rails.application.config.hosts &lt;&lt; ".product.com"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3811dfb7a49b6e5705b143929f6a7d2e">Copiar</button>
</div>
</li>
<li><p><code>ActionDispatch::SSL</code> forces every request to be served using HTTPS. Enabled if <code>config.force_ssl</code> is set to <code>true</code>. Options passed to this can be configured by setting <code>config.ssl_options</code>.</p></li>
<li><p><code>ActionDispatch::Static</code> is used to serve static assets. Disabled if <code>config.public_file_server.enabled</code> is <code>false</code>. Set <code>config.public_file_server.index_name</code> if you need to serve a static directory index file that is not named <code>index</code>. For example, to serve <code>main.html</code> instead of <code>index.html</code> for directory requests, set <code>config.public_file_server.index_name</code> to <code>"main"</code>.</p></li>
<li><p><code>ActionDispatch::Executor</code> allows thread safe code reloading. Disabled if <code>config.allow_concurrency</code> is <code>false</code>, which causes <code>Rack::Lock</code> to be loaded. <code>Rack::Lock</code> wraps the app in mutex so it can only be called by a single thread at a time.</p></li>
<li><p><code>ActiveSupport::Cache::Strategy::LocalCache</code> serves as a basic memory backed cache. This cache is not thread safe and is intended only for serving as a temporary memory cache for a single thread.</p></li>
<li><p><code>Rack::Runtime</code> sets an <code>X-Runtime</code> header, containing the time (in seconds) taken to execute the request.</p></li>
<li><p><code>Rails::Rack::Logger</code> notifies the logs that the request has begun. After request is complete, flushes all the logs.</p></li>
<li><p><code>ActionDispatch::ShowExceptions</code> rescues any exception returned by the application and renders nice exception pages if the request is local or if <code>config.consider_all_requests_local</code> is set to <code>true</code>. If <code>config.action_dispatch.show_exceptions</code> is set to <code>false</code>, exceptions will be raised regardless.</p></li>
<li><p><code>ActionDispatch::RequestId</code> makes a unique X-Request-Id header available to the response and enables the <code>ActionDispatch::Request#uuid</code> method. Configurable with <code>config.action_dispatch.request_id_header</code>.</p></li>
<li><p><code>ActionDispatch::RemoteIp</code> checks for IP spoofing attacks and gets valid <code>client_ip</code> from request headers. Configurable with the <code>config.action_dispatch.ip_spoofing_check</code>, and <code>config.action_dispatch.trusted_proxies</code> options.</p></li>
<li><p><code>Rack::Sendfile</code> intercepts responses whose body is being served from a file and replaces it with a server specific X-Sendfile header. Configurable with <code>config.action_dispatch.x_sendfile_header</code>.</p></li>
<li><p><code>ActionDispatch::Callbacks</code> runs the prepare callbacks before serving the request.</p></li>
<li><p><code>ActionDispatch::Cookies</code> sets cookies for the request.</p></li>
<li><p><code>ActionDispatch::Session::CookieStore</code> is responsible for storing the session in cookies. An alternate middleware can be used for this by changing the <code>config.action_controller.session_store</code> to an alternate value. Additionally, options passed to this can be configured by using <code>config.action_controller.session_options</code>.</p></li>
<li><p><code>ActionDispatch::Flash</code> sets up the <code>flash</code> keys. Only available if <code>config.action_controller.session_store</code> is set to a value.</p></li>
<li><p><code>Rack::MethodOverride</code> allows the method to be overridden if <code>params[:_method]</code> is set. This is the middleware which supports the PATCH, PUT, and DELETE HTTP method types.</p></li>
<li><p><code>Rack::Head</code> converts HEAD requests to GET requests and serves them as so.</p></li>
</ul>
<p>Besides these usual middleware, you can add your own by using the <code>config.middleware.use</code> method:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">use</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e63c57398689bcb3e69e91ba81f633e6">config.middleware.use Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e63c57398689bcb3e69e91ba81f633e6">Copiar</button>
</div>
<p>This will put the <code>Magical::Unicorns</code> middleware on the end of the stack. You can use <code>insert_before</code> if you wish to add a middleware before another.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_before</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Head</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-4a27ec595704a6d65934cb83bd74c938">config.middleware.insert_before Rack::Head, Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-4a27ec595704a6d65934cb83bd74c938">Copiar</button>
</div>
<p>Or you can insert a middleware to exact position by using indexes. For example, if you want to insert <code>Magical::Unicorns</code> middleware on top of the stack, you can do it, like so:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_before</span> <span class="mi">0</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-4f9b48561eb1c63c301a02a5d9095bf1">config.middleware.insert_before 0, Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-4f9b48561eb1c63c301a02a5d9095bf1">Copiar</button>
</div>
<p>There's also <code>insert_after</code> which will insert a middleware after another:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">insert_after</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Head</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9cda183a0e04d6c350001dcc9c4f3c13">config.middleware.insert_after Rack::Head, Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9cda183a0e04d6c350001dcc9c4f3c13">Copiar</button>
</div>
<p>Middlewares can also be completely swapped out and replaced with others:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">swap</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Failsafe</span><span class="p">,</span> <span class="no">Lifo</span><span class="o">::</span><span class="no">Failsafe</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8ca0ae590bdbdf5ad6f44e9aaa7f895c">config.middleware.swap ActionController::Failsafe, Lifo::Failsafe
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8ca0ae590bdbdf5ad6f44e9aaa7f895c">Copiar</button>
</div>
<p>Middlewares can be moved from one place to another:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">move_before</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Flash</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-93e926aeb803459104e27348d0f4672d">config.middleware.move_before ActionDispatch::Flash, Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-93e926aeb803459104e27348d0f4672d">Copiar</button>
</div>
<p>This will move the <code>Magical::Unicorns</code> middleware before
<code>ActionDispatch::Flash</code>. You can also move it after:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">move_after</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">Flash</span><span class="p">,</span> <span class="no">Magical</span><span class="o">::</span><span class="no">Unicorns</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f88a50e31daebde3f2ecbe4f7fdf913f">config.middleware.move_after ActionDispatch::Flash, Magical::Unicorns
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f88a50e31daebde3f2ecbe4f7fdf913f">Copiar</button>
</div>
<p>They can also be removed from the stack completely:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">delete</span> <span class="no">Rack</span><span class="o">::</span><span class="no">MethodOverride</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f04a4ee30f09bfdd03f52cd19ae679ae">config.middleware.delete Rack::MethodOverride
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f04a4ee30f09bfdd03f52cd19ae679ae">Copiar</button>
</div>
<h4 id="configuring-i18n"><a class="anchorlink" href="#configuring-i18n">3.5 Configuring i18n</a></h4><p>All these configuration options are delegated to the <code>I18n</code> library.</p>
<ul>
<li><p><code>config.i18n.available_locales</code> defines the permitted available locales for the app. Defaults to all locale keys found in locale files, usually only <code>:en</code> on a new application.</p></li>
<li><p><code>config.i18n.default_locale</code> sets the default locale of an application used for i18n. Defaults to <code>:en</code>.</p></li>
<li><p><code>config.i18n.enforce_available_locales</code> ensures that all locales passed through i18n must be declared in the <code>available_locales</code> list, raising an <code>I18n::InvalidLocale</code> exception when setting an unavailable locale. Defaults to <code>true</code>. It is recommended not to disable this option unless strongly required, since this works as a security measure against setting any invalid locale from user input.</p></li>
<li><p><code>config.i18n.load_path</code> sets the path Rails uses to look for locale files. Defaults to <code>config/locales/*.{yml,rb}</code>.</p></li>
<li><p><code>config.i18n.raise_on_missing_translations</code> determines whether an error should be raised for missing translations
in controllers and views. This defaults to <code>false</code>.</p></li>
<li>
<p><code>config.i18n.fallbacks</code> sets fallback behavior for missing translations. Here are 3 usage examples for this option:</p>
<ul>
<li>You can set the option to <code>true</code> for using default locale as fallback, like so:</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-151ce87585c00ecb20092a03b4a32829">config.i18n.fallbacks = true
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-151ce87585c00ecb20092a03b4a32829">Copiar</button>
</div>

<ul>
<li>Or you can set an array of locales as fallback, like so:</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="p">[</span><span class="ss">:tr</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-89b419cb24768d2ec6f7a4ff2abe7ade">config.i18n.fallbacks = [:tr, :en]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-89b419cb24768d2ec6f7a4ff2abe7ade">Copiar</button>
</div>

<ul>
<li>Or you can set different fallbacks for locales individually. For example, if you want to use <code>:tr</code> for <code>:az</code> and <code>:de</code>, <code>:en</code> for <code>:da</code> as fallbacks, you can do it, like so:</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">az: :tr</span><span class="p">,</span> <span class="ss">da: </span><span class="p">[</span><span class="ss">:de</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span> <span class="p">}</span>
<span class="c1">#or</span>
<span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">fallbacks</span><span class="p">.</span><span class="nf">map</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">az: :tr</span><span class="p">,</span> <span class="ss">da: </span><span class="p">[</span><span class="ss">:de</span><span class="p">,</span> <span class="ss">:en</span><span class="p">]</span> <span class="p">}</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-cee8fc1f1f23e538b1df66a24b430dd7">config.i18n.fallbacks = { az: :tr, da: [:de, :en] }
#or
config.i18n.fallbacks.map = { az: :tr, da: [:de, :en] }
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-cee8fc1f1f23e538b1df66a24b430dd7">Copiar</button>
</div>
</li>
</ul>
<h4 id="configuring-active-model"><a class="anchorlink" href="#configuring-active-model">3.6 Configuring Active Model</a></h4>
<ul>
<li>
<code>config.active_model.i18n_customize_full_message</code> is a boolean value which controls whether the <code>full_message</code> error format can be overridden at the attribute or model level in the locale files. This is <code>false</code> by default.</li>
</ul>
<h4 id="configuring-active-record"><a class="anchorlink" href="#configuring-active-record">3.7 Configuring Active Record</a></h4><p><code>config.active_record</code> includes a variety of configuration options:</p>
<ul>
<li><p><code>config.active_record.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then passed on to any new database connections made. You can retrieve this logger by calling <code>logger</code> on either an Active Record model class or an Active Record model instance. Set to <code>nil</code> to disable logging.</p></li>
<li>
<p><code>config.active_record.primary_key_prefix_type</code> lets you adjust the naming for primary key columns. By default, Rails assumes that primary key columns are named <code>id</code> (and this configuration option doesn't need to be set). There are two other choices:</p>
<ul>
<li>
<code>:table_name</code> would make the primary key for the Customer class <code>customerid</code>.</li>
<li>
<code>:table_name_with_underscore</code> would make the primary key for the Customer class <code>customer_id</code>.</li>
</ul>
</li>
<li><p><code>config.active_record.table_name_prefix</code> lets you set a global string to be prepended to table names. If you set this to <code>northwest_</code>, then the Customer class will look for <code>northwest_customers</code> as its table. The default is an empty string.</p></li>
<li><p><code>config.active_record.table_name_suffix</code> lets you set a global string to be appended to table names. If you set this to <code>_northwest</code>, then the Customer class will look for <code>customers_northwest</code> as its table. The default is an empty string.</p></li>
<li><p><code>config.active_record.schema_migrations_table_name</code> lets you set a string to be used as the name of the schema migrations table.</p></li>
<li><p><code>config.active_record.internal_metadata_table_name</code> lets you set a string to be used as the name of the internal metadata table.</p></li>
<li><p><code>config.active_record.protected_environments</code> lets you set an array of names of environments where destructive actions should be prohibited.</p></li>
<li><p><code>config.active_record.pluralize_table_names</code> specifies whether Rails will look for singular or plural table names in the database. If set to <code>true</code> (the default), then the Customer class will use the <code>customers</code> table. If set to false, then the Customer class will use the <code>customer</code> table.</p></li>
<li><p><code>config.active_record.default_timezone</code> determines whether to use <code>Time.local</code> (if set to <code>:local</code>) or <code>Time.utc</code> (if set to <code>:utc</code>) when pulling dates and times from the database. The default is <code>:utc</code>.</p></li>
<li><p><code>config.active_record.schema_format</code> controls the format for dumping the database schema to a file. The options are <code>:ruby</code> (the default) for a database-independent version that depends on migrations, or <code>:sql</code> for a set of (potentially database-dependent) SQL statements.</p></li>
<li><p><code>config.active_record.error_on_ignored_order</code> specifies if an error should be raised if the order of a query is ignored during a batch query. The options are <code>true</code> (raise error) or <code>false</code> (warn). Default is <code>false</code>.</p></li>
<li><p><code>config.active_record.timestamped_migrations</code> controls whether migrations are numbered with serial integers or with timestamps. The default is <code>true</code>, to use timestamps, which are preferred if there are multiple developers working on the same application.</p></li>
<li><p><code>config.active_record.lock_optimistically</code> controls whether Active Record will use optimistic locking and is <code>true</code> by default.</p></li>
<li><p><code>config.active_record.cache_timestamp_format</code> controls the format of the timestamp value in the cache key. Default is <code>:usec</code>.</p></li>
<li><p><code>config.active_record.record_timestamps</code> is a boolean value which controls whether or not timestamping of <code>create</code> and <code>update</code> operations on a model occur. The default value is <code>true</code>.</p></li>
<li><p><code>config.active_record.partial_writes</code> is a boolean value and controls whether or not partial writes are used (i.e. whether updates only set attributes that are dirty). Note that when using partial writes, you should also use optimistic locking <code>config.active_record.lock_optimistically</code> since concurrent updates may write attributes based on a possibly stale read state. The default value is <code>true</code>.</p></li>
<li><p><code>config.active_record.maintain_test_schema</code> is a boolean value which controls whether Active Record should try to keep your test database schema up-to-date with <code>db/schema.rb</code> (or <code>db/structure.sql</code>) when you run your tests. The default is <code>true</code>.</p></li>
<li><p><code>config.active_record.dump_schema_after_migration</code> is a flag which
controls whether or not schema dump should happen (<code>db/schema.rb</code> or
<code>db/structure.sql</code>) when you run migrations. This is set to <code>false</code> in
<code>config/environments/production.rb</code> which is generated by Rails. The
default value is <code>true</code> if this configuration is not set.</p></li>
<li><p><code>config.active_record.dump_schemas</code> controls which database schemas will be dumped when calling <code>db:schema:dump</code>.
The options are <code>:schema_search_path</code> (the default) which dumps any schemas listed in <code>schema_search_path</code>,
<code>:all</code> which always dumps all schemas regardless of the <code>schema_search_path</code>,
or a string of comma separated schemas.</p></li>
<li><p><code>config.active_record.belongs_to_required_by_default</code> is a boolean value and
controls whether a record fails validation if <code>belongs_to</code> association is not
present.</p></li>
<li><p><code>config.active_record.action_on_strict_loading_violation</code> enables raising or
logging an exception if strict_loading is set on an association. The default
value is <code>:raise</code> in all environments. It can be changed to <code>:log</code> to send
violations to the logger instead of raising.</p></li>
<li><p><code>config.active_record.strict_loading_by_default</code> is a boolean value
that either enables or disables strict_loading mode by default.
Defaults to <code>false</code>.</p></li>
<li><p><code>config.active_record.warn_on_records_fetched_greater_than</code> allows setting a
warning threshold for query result size. If the number of records returned
by a query exceeds the threshold, a warning is logged. This can be used to
identify queries which might be causing a memory bloat.</p></li>
<li><p><code>config.active_record.index_nested_attribute_errors</code> allows errors for nested
<code>has_many</code> relationships to be displayed with an index as well as the error.
Defaults to <code>false</code>.</p></li>
<li><p><code>config.active_record.use_schema_cache_dump</code> enables users to get schema cache information
from <code>db/schema_cache.yml</code> (generated by <code>bin/rails db:schema:cache:dump</code>), instead of
having to send a query to the database to get this information.
Defaults to <code>true</code>.</p></li>
<li><p><code>config.active_record.cache_versioning</code> indicates whether to use a stable <code>#cache_key</code>
method that is accompanied by a changing version in the <code>#cache_version</code> method.</p></li>
<li><p><code>config.active_record.collection_cache_versioning</code> enables the same cache key
to be reused when the object being cached of type <code>ActiveRecord::Relation</code>
changes by moving the volatile information (max updated at and count) of
the relation's cache key into the cache version to support recycling cache key.</p></li>
<li><p><code>config.active_record.has_many_inversing</code> enables setting the inverse record
when traversing <code>belongs_to</code> to <code>has_many</code> associations.</p></li>
<li><p><code>config.active_record.legacy_connection_handling</code> allows to enable new connection
handling API. For applications using multiple databases, this new API provides
support for granular connection swapping.</p></li>
<li><p><code>config.active_record.destroy_association_async_job</code> allows specifying the job that will be used to destroy the associated records in background. It defaults to <code>ActiveRecord::DestroyAssociationAsyncJob</code>.</p></li>
<li><p><code>config.active_record.queues.destroy</code> allows specifying the Active Job queue to use for destroy jobs. When this option is <code>nil</code>, purge jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>). It defaults to <code>nil</code>.</p></li>
</ul>
<p>The MySQL adapter adds one additional configuration option:</p>
<ul>
<li>
<code>ActiveRecord::ConnectionAdapters::Mysql2Adapter.emulate_booleans</code> controls whether Active Record will consider all <code>tinyint(1)</code> columns as booleans. Defaults to <code>true</code>.</li>
</ul>
<p>The PostgreSQL adapter adds one additional configuration option:</p>
<ul>
<li>
<code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter.create_unlogged_tables</code>
controls whether database tables created should be "unlogged," which can speed
up performance but adds a risk of data loss if the database crashes. It is
highly recommended that you do not enable this in a production environment.
Defaults to <code>false</code> in all environments.</li>
</ul>
<p>The schema dumper adds two additional configuration options:</p>
<ul>
<li><p><code>ActiveRecord::SchemaDumper.ignore_tables</code> accepts an array of tables that should <em>not</em> be included in any generated schema file.</p></li>
<li><p><code>ActiveRecord::SchemaDumper.fk_ignore_pattern</code> allows setting a different regular
expression that will be used to decide whether a foreign key's name should be
dumped to db/schema.rb or not. By default, foreign key names starting with
<code>fk_rails_</code> are not exported to the database schema dump.
Defaults to <code>/^fk_rails_[0-9a-f]{10}$/</code>.</p></li>
</ul>
<h4 id="configuring-action-controller"><a class="anchorlink" href="#configuring-action-controller">3.8 Configuring Action Controller</a></h4><p><code>config.action_controller</code> includes a number of configuration settings:</p>
<ul>
<li><p><code>config.action_controller.asset_host</code> sets the host for the assets. Useful when CDNs are used for hosting assets rather than the application server itself. You should only use this if you have a different configuration for Action Mailer, otherwise use <code>config.asset_host</code>.</p></li>
<li><p><code>config.action_controller.perform_caching</code> configures whether the application should perform the caching features provided by the Action Controller component or not. Set to <code>false</code> in the development environment, <code>true</code> in production. If it's not specified, the default will be <code>true</code>.</p></li>
<li><p><code>config.action_controller.default_static_extension</code> configures the extension used for cached pages. Defaults to <code>.html</code>.</p></li>
<li><p><code>config.action_controller.include_all_helpers</code> configures whether all view helpers are available everywhere or are scoped to the corresponding controller. If set to <code>false</code>, <code>UsersHelper</code> methods are only available for views rendered as part of <code>UsersController</code>. If <code>true</code>, <code>UsersHelper</code> methods are available everywhere. The default configuration behavior (when this option is not explicitly set to <code>true</code> or <code>false</code>) is that all view helpers are available to each controller.</p></li>
<li><p><code>config.action_controller.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action Controller. Set to <code>nil</code> to disable logging.</p></li>
<li><p><code>config.action_controller.request_forgery_protection_token</code> sets the token parameter name for RequestForgery. Calling <code>protect_from_forgery</code> sets it to <code>:authenticity_token</code> by default.</p></li>
<li><p><code>config.action_controller.allow_forgery_protection</code> enables or disables CSRF protection. By default this is <code>false</code> in the test environment and <code>true</code> in all other environments.</p></li>
<li><p><code>config.action_controller.forgery_protection_origin_check</code> configures whether the HTTP <code>Origin</code> header should be checked against the site's origin as an additional CSRF defense.</p></li>
<li><p><code>config.action_controller.per_form_csrf_tokens</code> configures whether CSRF tokens are only valid for the method/action they were generated for.</p></li>
<li><p><code>config.action_controller.default_protect_from_forgery</code> determines whether forgery protection is added on <code>ActionController::Base</code>.</p></li>
<li><p><code>config.action_controller.urlsafe_csrf_tokens</code> configures whether generated CSRF tokens are URL-safe.</p></li>
<li><p><code>config.action_controller.relative_url_root</code> can be used to tell Rails that you are <a href="configuring.html#deploy-to-a-subdirectory-relative-url-root">deploying to a subdirectory</a>. The default is <code>ENV['RAILS_RELATIVE_URL_ROOT']</code>.</p></li>
<li><p><code>config.action_controller.permit_all_parameters</code> sets all the parameters for mass assignment to be permitted by default. The default value is <code>false</code>.</p></li>
<li><p><code>config.action_controller.action_on_unpermitted_parameters</code> enables logging or raising an exception if parameters that are not explicitly permitted are found. Set to <code>:log</code> or <code>:raise</code> to enable. The default value is <code>:log</code> in development and test environments, and <code>false</code> in all other environments.</p></li>
<li><p><code>config.action_controller.always_permitted_parameters</code> sets a list of permitted parameters that are permitted by default. The default values are <code>['controller', 'action']</code>.</p></li>
<li>
<p><code>config.action_controller.enable_fragment_cache_logging</code> determines whether to log fragment cache reads and writes in verbose format as follows:</p>
<div class="code_container">
<pre><code class="highlight plaintext">Read fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/d0bdf2974e1ef6d31685c3b392ad0b74 (0.6ms)
Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Write fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/3b4e249ac9d168c617e32e84b99218b5 (1.1ms)
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</code></pre>
<textarea class="clipboard-content" id="clipboard-e9a8994b331e43c763c10de75fc6ccfc">Read fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/d0bdf2974e1ef6d31685c3b392ad0b74 (0.6ms)
Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Write fragment views/v1/2914079/v1/2914079/recordings/70182313-20160225015037000000/3b4e249ac9d168c617e32e84b99218b5 (1.1ms)
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e9a8994b331e43c763c10de75fc6ccfc">Copiar</button>
</div>
<p>By default it is set to <code>false</code> which results in following output:</p>
<div class="code_container">
<pre><code class="highlight plaintext">Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</code></pre>
<textarea class="clipboard-content" id="clipboard-c2ec623ddd94ff9ad0b160d08b69004b">Rendered messages/_message.html.erb in 1.2 ms [cache hit]
Rendered recordings/threads/_thread.html.erb in 1.5 ms [cache miss]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c2ec623ddd94ff9ad0b160d08b69004b">Copiar</button>
</div>
</li>
</ul>
<h4 id="configuring-action-dispatch"><a class="anchorlink" href="#configuring-action-dispatch">3.9 Configuring Action Dispatch</a></h4>
<ul>
<li><p><code>config.action_dispatch.session_store</code> sets the name of the store for session data. The default is <code>:cookie_store</code>; other valid options include <code>:active_record_store</code>, <code>:mem_cache_store</code> or the name of your own custom class.</p></li>
<li>
<p><code>config.action_dispatch.default_headers</code> is a hash with HTTP headers that are set by default in each response. By default, this is defined as:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">default_headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'X-Frame-Options'</span> <span class="o">=&gt;</span> <span class="s1">'SAMEORIGIN'</span><span class="p">,</span>
  <span class="s1">'X-XSS-Protection'</span> <span class="o">=&gt;</span> <span class="s1">'1; mode=block'</span><span class="p">,</span>
  <span class="s1">'X-Content-Type-Options'</span> <span class="o">=&gt;</span> <span class="s1">'nosniff'</span><span class="p">,</span>
  <span class="s1">'X-Download-Options'</span> <span class="o">=&gt;</span> <span class="s1">'noopen'</span><span class="p">,</span>
  <span class="s1">'X-Permitted-Cross-Domain-Policies'</span> <span class="o">=&gt;</span> <span class="s1">'none'</span><span class="p">,</span>
  <span class="s1">'Referrer-Policy'</span> <span class="o">=&gt;</span> <span class="s1">'strict-origin-when-cross-origin'</span>
<span class="p">}</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-2aad355ffab36d5e1b7c8f1d1093343a">config.action_dispatch.default_headers = {
  'X-Frame-Options' =&gt; 'SAMEORIGIN',
  'X-XSS-Protection' =&gt; '1; mode=block',
  'X-Content-Type-Options' =&gt; 'nosniff',
  'X-Download-Options' =&gt; 'noopen',
  'X-Permitted-Cross-Domain-Policies' =&gt; 'none',
  'Referrer-Policy' =&gt; 'strict-origin-when-cross-origin'
}
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-2aad355ffab36d5e1b7c8f1d1093343a">Copiar</button>
</div>
</li>
<li><p><code>config.action_dispatch.default_charset</code> specifies the default character set for all renders. Defaults to <code>nil</code>.</p></li>
<li><p><code>config.action_dispatch.tld_length</code> sets the TLD (top-level domain) length for the application. Defaults to <code>1</code>.</p></li>
<li><p><code>config.action_dispatch.ignore_accept_header</code> is used to determine whether to ignore accept headers from a request. Defaults to <code>false</code>.</p></li>
<li><p><code>config.action_dispatch.x_sendfile_header</code> specifies server specific X-Sendfile header. This is useful for accelerated file sending from server. For example it can be set to 'X-Sendfile' for Apache.</p></li>
<li><p><code>config.action_dispatch.http_auth_salt</code> sets the HTTP Auth salt value. Defaults
to <code>'http authentication'</code>.</p></li>
<li><p><code>config.action_dispatch.signed_cookie_salt</code> sets the signed cookies salt value.
Defaults to <code>'signed cookie'</code>.</p></li>
<li><p><code>config.action_dispatch.encrypted_cookie_salt</code> sets the encrypted cookies salt
value. Defaults to <code>'encrypted cookie'</code>.</p></li>
<li><p><code>config.action_dispatch.encrypted_signed_cookie_salt</code> sets the signed
encrypted cookies salt value. Defaults to <code>'signed encrypted cookie'</code>.</p></li>
<li><p><code>config.action_dispatch.authenticated_encrypted_cookie_salt</code> sets the
authenticated encrypted cookie salt. Defaults to <code>'authenticated encrypted
cookie'</code>.</p></li>
<li><p><code>config.action_dispatch.encrypted_cookie_cipher</code> sets the cipher to be
used for encrypted cookies. This defaults to <code>"aes-256-gcm"</code>.</p></li>
<li><p><code>config.action_dispatch.signed_cookie_digest</code> sets the digest to be
used for signed cookies. This defaults to <code>"SHA1"</code>.</p></li>
<li><p><code>config.action_dispatch.cookies_rotations</code> allows rotating
secrets, ciphers, and digests for encrypted and signed cookies.</p></li>
<li><p><code>config.action_dispatch.use_authenticated_cookie_encryption</code> controls whether
signed and encrypted cookies use the AES-256-GCM cipher or
the older AES-256-CBC cipher. It defaults to <code>true</code>.</p></li>
<li><p><code>config.action_dispatch.use_cookies_with_metadata</code> enables writing
cookies with the purpose and expiry metadata embedded. It defaults to <code>true</code>.</p></li>
<li><p><code>config.action_dispatch.perform_deep_munge</code> configures whether <code>deep_munge</code>
method should be performed on the parameters. See <a href="security.html#unsafe-query-generation">Security Guide</a>
for more information. It defaults to <code>true</code>.</p></li>
<li>
<p><code>config.action_dispatch.rescue_responses</code> configures what exceptions are assigned to an HTTP status. It accepts a hash and you can specify pairs of exception/status. By default, this is defined as:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">rescue_responses</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'ActionController::RoutingError'</span>
    <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s1">'AbstractController::ActionNotFound'</span>
    <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s1">'ActionController::MethodNotAllowed'</span>
    <span class="o">=&gt;</span> <span class="ss">:method_not_allowed</span><span class="p">,</span>
  <span class="s1">'ActionController::UnknownHttpMethod'</span>
    <span class="o">=&gt;</span> <span class="ss">:method_not_allowed</span><span class="p">,</span>
  <span class="s1">'ActionController::NotImplemented'</span>
    <span class="o">=&gt;</span> <span class="ss">:not_implemented</span><span class="p">,</span>
  <span class="s1">'ActionController::UnknownFormat'</span>
    <span class="o">=&gt;</span> <span class="ss">:not_acceptable</span><span class="p">,</span>
  <span class="s1">'ActionController::InvalidAuthenticityToken'</span>
    <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s1">'ActionController::InvalidCrossOriginRequest'</span>
    <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s1">'ActionDispatch::Http::Parameters::ParseError'</span>
    <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s1">'ActionController::BadRequest'</span>
    <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s1">'ActionController::ParameterMissing'</span>
    <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s1">'Rack::QueryParser::ParameterTypeError'</span>
    <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s1">'Rack::QueryParser::InvalidParameterError'</span>
    <span class="o">=&gt;</span> <span class="ss">:bad_request</span><span class="p">,</span>
  <span class="s1">'ActiveRecord::RecordNotFound'</span>
    <span class="o">=&gt;</span> <span class="ss">:not_found</span><span class="p">,</span>
  <span class="s1">'ActiveRecord::StaleObjectError'</span>
    <span class="o">=&gt;</span> <span class="ss">:conflict</span><span class="p">,</span>
  <span class="s1">'ActiveRecord::RecordInvalid'</span>
    <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span><span class="p">,</span>
  <span class="s1">'ActiveRecord::RecordNotSaved'</span>
    <span class="o">=&gt;</span> <span class="ss">:unprocessable_entity</span>
<span class="p">}</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a15c7d474412ad665fb1362c1e702249">config.action_dispatch.rescue_responses = {
  'ActionController::RoutingError'
    =&gt; :not_found,
  'AbstractController::ActionNotFound'
    =&gt; :not_found,
  'ActionController::MethodNotAllowed'
    =&gt; :method_not_allowed,
  'ActionController::UnknownHttpMethod'
    =&gt; :method_not_allowed,
  'ActionController::NotImplemented'
    =&gt; :not_implemented,
  'ActionController::UnknownFormat'
    =&gt; :not_acceptable,
  'ActionController::InvalidAuthenticityToken'
    =&gt; :unprocessable_entity,
  'ActionController::InvalidCrossOriginRequest'
    =&gt; :unprocessable_entity,
  'ActionDispatch::Http::Parameters::ParseError'
    =&gt; :bad_request,
  'ActionController::BadRequest'
    =&gt; :bad_request,
  'ActionController::ParameterMissing'
    =&gt; :bad_request,
  'Rack::QueryParser::ParameterTypeError'
    =&gt; :bad_request,
  'Rack::QueryParser::InvalidParameterError'
    =&gt; :bad_request,
  'ActiveRecord::RecordNotFound'
    =&gt; :not_found,
  'ActiveRecord::StaleObjectError'
    =&gt; :conflict,
  'ActiveRecord::RecordInvalid'
    =&gt; :unprocessable_entity,
  'ActiveRecord::RecordNotSaved'
    =&gt; :unprocessable_entity
}
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a15c7d474412ad665fb1362c1e702249">Copiar</button>
</div>
<p>Any exceptions that are not configured will be mapped to 500 Internal Server Error.</p>
</li>
<li>
<p><code>config.action_dispatch.cookies_same_site_protection</code> configures the default
value of the <code>SameSite</code> attribute when setting cookies. When set to <code>nil</code>, the
<code>SameSite</code> attribute is not added. To allow the value of the <code>SameSite</code> attribute
to be configured dynamically based on the request, a proc may be specified.
For example:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_dispatch</span><span class="p">.</span><span class="nf">cookies_same_site_protection</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="k">do</span>
  <span class="ss">:strict</span> <span class="k">unless</span> <span class="n">request</span><span class="p">.</span><span class="nf">user_agent</span> <span class="o">==</span> <span class="s2">"TestAgent"</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ce22129b3c4b6a92e583a2602ec170e9">config.action_dispatch.cookies_same_site_protection = -&gt;(request) do
  :strict unless request.user_agent == "TestAgent"
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ce22129b3c4b6a92e583a2602ec170e9">Copiar</button>
</div>
</li>
<li><p><code>config.action_dispatch.ssl_default_redirect_status</code> configures the default
HTTP status code used when redirecting non-GET/HEAD requests from HTTP to HTTPS
in the <code>ActionDispatch::SSL</code> middleware. Defaults to <code>308</code> as defined in
<a href="https://tools.ietf.org/html/rfc7538">https://tools.ietf.org/html/rfc7538</a>.</p></li>
<li><p><code>ActionDispatch::Callbacks.before</code> takes a block of code to run before the request.</p></li>
<li><p><code>ActionDispatch::Callbacks.after</code> takes a block of code to run after the request.</p></li>
</ul>
<h4 id="configuring-action-view"><a class="anchorlink" href="#configuring-action-view">3.10 Configuring Action View</a></h4><p><code>config.action_view</code> includes a small number of configuration settings:</p>
<ul>
<li><p><code>config.action_view.cache_template_loading</code> controls whether or not templates should be reloaded on each request. Defaults to whatever is set for <code>config.cache_classes</code>.</p></li>
<li>
<p><code>config.action_view.field_error_proc</code> provides an HTML generator for displaying errors that come from Active Model. The default is</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">html_tag</span><span class="p">,</span> <span class="n">instance</span><span class="o">|</span>
  <span class="sx">%Q(&lt;div class="field_with_errors"&gt;</span><span class="si">#{</span><span class="n">html_tag</span><span class="si">}</span><span class="sx">&lt;/div&gt;)</span><span class="p">.</span><span class="nf">html_safe</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ebb2aff0deea94276529416afec60758">Proc.new do |html_tag, instance|
  %Q(&lt;div class="field_with_errors"&gt;#{html_tag}&lt;/div&gt;).html_safe
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ebb2aff0deea94276529416afec60758">Copiar</button>
</div>
</li>
<li><p><code>config.action_view.default_form_builder</code> tells Rails which form builder to
use by default. The default is <code>ActionView::Helpers::FormBuilder</code>. If you
want your form builder class to be loaded after initialization (so it's
reloaded on each request in development), you can pass it as a <code>String</code>.</p></li>
<li><p><code>config.action_view.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action View. Set to <code>nil</code> to disable logging.</p></li>
<li><p><code>config.action_view.erb_trim_mode</code> gives the trim mode to be used by ERB. It defaults to <code>'-'</code>, which turns on trimming of tail spaces and newline when using <code>&lt;%= -%&gt;</code> or <code>&lt;%= =%&gt;</code>. See the <a href="http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces">Erubis documentation</a> for more information.</p></li>
<li><p><code>config.action_view.embed_authenticity_token_in_remote_forms</code> allows you to
set the default behavior for <code>authenticity_token</code> in forms with <code>remote:
true</code>. By default it's set to <code>false</code>, which means that remote forms will not
include <code>authenticity_token</code>, which is helpful when you're fragment-caching
the form. Remote forms get the authenticity from the <code>meta</code> tag, so embedding
is unnecessary unless you support browsers without JavaScript. In such case
you can either pass <code>authenticity_token: true</code> as a form option or set this
config setting to <code>true</code>.</p></li>
<li>
<p><code>config.action_view.prefix_partial_path_with_controller_namespace</code> determines whether or not partials are looked up from a subdirectory in templates rendered from namespaced controllers. For example, consider a controller named <code>Admin::ArticlesController</code> which renders this template:</p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@article</span> <span class="cp">%&gt;</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-6e5b27c24e259da979a3ef5ae9762ab4">&lt;%= render @article %&gt;
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-6e5b27c24e259da979a3ef5ae9762ab4">Copiar</button>
</div>
<p>The default setting is <code>true</code>, which uses the partial at <code>/admin/articles/_article.erb</code>. Setting the value to <code>false</code> would render <code>/articles/_article.erb</code>, which is the same behavior as rendering from a non-namespaced controller such as <code>ArticlesController</code>.</p>
</li>
<li><p><code>config.action_view.automatically_disable_submit_tag</code> determines whether
<code>submit_tag</code> should automatically disable on click, this defaults to <code>true</code>.</p></li>
<li><p><code>config.action_view.debug_missing_translation</code> determines whether to wrap the missing translations key in a <code>&lt;span&gt;</code> tag or not. This defaults to <code>true</code>.</p></li>
<li><p><code>config.action_view.form_with_generates_remote_forms</code> determines whether <code>form_with</code> generates remote forms or not.</p></li>
<li><p><code>config.action_view.form_with_generates_ids</code> determines whether <code>form_with</code> generates ids on inputs.</p></li>
<li><p><code>config.action_view.default_enforce_utf8</code> determines whether forms are generated with a hidden tag that forces older versions of Internet Explorer to submit forms encoded in UTF-8. This defaults to <code>false</code>.</p></li>
<li><p><code>config.action_view.annotate_rendered_view_with_filenames</code> determines whether to annotate rendered view with template file names. This defaults to <code>false</code>.</p></li>
<li><p><code>config.action_view.preload_links_header</code> determines whether <code>javascript_include_tag</code> and <code>stylesheet_link_tag</code> will generate a <code>Link</code> header that preload assets.</p></li>
</ul>
<h4 id="configuring-action-mailbox"><a class="anchorlink" href="#configuring-action-mailbox">3.11 Configuring Action Mailbox</a></h4><p><code>config.action_mailbox</code> provides the following configuration options:</p>
<ul>
<li>
<p><code>config.action_mailbox.logger</code> contains the logger used by Action Mailbox. It accepts a logger conforming to the interface of Log4r or the default Ruby Logger class. The default is <code>Rails.logger</code>.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailbox</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-3e04b1ec7c145aa10fe92bbb0fe24ac1">config.action_mailbox.logger = ActiveSupport::Logger.new(STDOUT)
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-3e04b1ec7c145aa10fe92bbb0fe24ac1">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailbox.incinerate_after</code> accepts an <code>ActiveSupport::Duration</code> indicating how long after processing <code>ActionMailbox::InboundEmail</code> records should be destroyed. It defaults to <code>30.days</code>.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># Incinerate inbound emails 14 days after processing.</span>
<span class="n">config</span><span class="p">.</span><span class="nf">action_mailbox</span><span class="p">.</span><span class="nf">incinerate_after</span> <span class="o">=</span> <span class="mi">14</span><span class="p">.</span><span class="nf">days</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a3a9917b1beafd764cf465b4df2fcaa4"># Incinerate inbound emails 14 days after processing.
config.action_mailbox.incinerate_after = 14.days
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a3a9917b1beafd764cf465b4df2fcaa4">Copiar</button>
</div>
</li>
<li><p><code>config.action_mailbox.queues.incineration</code> accepts a symbol indicating the Active Job queue to use for incineration jobs. When this option is <code>nil</code>, incineration jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>).</p></li>
<li><p><code>config.action_mailbox.queues.routing</code> accepts a symbol indicating the Active Job queue to use for routing jobs. When this option is <code>nil</code>, routing jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>).</p></li>
</ul>
<h4 id="configuring-action-mailer"><a class="anchorlink" href="#configuring-action-mailer">3.12 Configuring Action Mailer</a></h4><p>There are a number of settings available on <code>config.action_mailer</code>:</p>
<ul>
<li><p><code>config.action_mailer.asset_host</code> sets the host for the assets. Useful when CDNs are used for hosting assets rather than the application server itself. You should only use this if you have a different configuration for Action Controller, otherwise use <code>config.asset_host</code>.</p></li>
<li><p><code>config.action_mailer.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Action Mailer. Set to <code>nil</code> to disable logging.</p></li>
<li>
<p><code>config.action_mailer.smtp_settings</code> allows detailed configuration for the <code>:smtp</code> delivery method. It accepts a hash of options, which can include any of these options:</p>
<ul>
<li>
<code>:address</code> - Allows you to use a remote mail server. Just change it from its default "localhost" setting.</li>
<li>
<code>:port</code> - On the off chance that your mail server doesn't run on port 25, you can change it.</li>
<li>
<code>:domain</code> - If you need to specify a HELO domain, you can do it here.</li>
<li>
<code>:user_name</code> - If your mail server requires authentication, set the username in this setting.</li>
<li>
<code>:password</code> - If your mail server requires authentication, set the password in this setting.</li>
<li>
<code>:authentication</code> - If your mail server requires authentication, you need to specify the authentication type here. This is a symbol and one of <code>:plain</code>, <code>:login</code>, <code>:cram_md5</code>.</li>
<li>
<code>:enable_starttls_auto</code> - Detects if STARTTLS is enabled in your SMTP server and starts to use it. It defaults to <code>true</code>.</li>
<li>
<code>:openssl_verify_mode</code> - When using TLS, you can set how OpenSSL checks the certificate. This is useful if you need to validate a self-signed and/or a wildcard certificate. This can be one of the OpenSSL verify constants, <code>:none</code> or <code>:peer</code> -- or the constant directly <code>OpenSSL::SSL::VERIFY_NONE</code> or <code>OpenSSL::SSL::VERIFY_PEER</code>, respectively.</li>
<li>
<code>:ssl/:tls</code> - Enables the SMTP connection to use SMTP/TLS (SMTPS: SMTP over direct TLS connection).</li>
</ul>
</li>
<li>
<p><code>config.action_mailer.sendmail_settings</code> allows detailed configuration for the <code>sendmail</code> delivery method. It accepts a hash of options, which can include any of these options:</p>
<ul>
<li>
<code>:location</code> - The location of the sendmail executable. Defaults to <code>/usr/sbin/sendmail</code>.</li>
<li>
<code>:arguments</code> - The command line arguments. Defaults to <code>-i</code>.</li>
</ul>
</li>
<li><p><code>config.action_mailer.raise_delivery_errors</code> specifies whether to raise an error if email delivery cannot be completed. It defaults to <code>true</code>.</p></li>
<li><p><code>config.action_mailer.delivery_method</code> defines the delivery method and defaults to <code>:smtp</code>. See the <a href="action_mailer_basics.html#action-mailer-configuration">configuration section in the Action Mailer guide</a> for more info.</p></li>
<li><p><code>config.action_mailer.perform_deliveries</code> specifies whether mail will actually be delivered and is true by default. It can be convenient to set it to <code>false</code> for testing.</p></li>
<li>
<p><code>config.action_mailer.default_options</code> configures Action Mailer defaults. Use to set options like <code>from</code> or <code>reply_to</code> for every mailer. These default to:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="ss">mime_version:  </span><span class="s2">"1.0"</span><span class="p">,</span>
<span class="ss">charset:       </span><span class="s2">"UTF-8"</span><span class="p">,</span>
<span class="ss">content_type: </span><span class="s2">"text/plain"</span><span class="p">,</span>
<span class="ss">parts_order:  </span><span class="p">[</span><span class="s2">"text/plain"</span><span class="p">,</span> <span class="s2">"text/enriched"</span><span class="p">,</span> <span class="s2">"text/html"</span><span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-796be95da3e4224ea4b6e5165deac673">mime_version:  "1.0",
charset:       "UTF-8",
content_type: "text/plain",
parts_order:  ["text/plain", "text/enriched", "text/html"]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-796be95da3e4224ea4b6e5165deac673">Copiar</button>
</div>
<p>Assign a hash to set additional options:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">default_options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">from: </span><span class="s2">"noreply@example.com"</span>
<span class="p">}</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-d6ac788f122a9170a5aae4c90a114845">config.action_mailer.default_options = {
  from: "noreply@example.com"
}
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-d6ac788f122a9170a5aae4c90a114845">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailer.observers</code> registers observers which will be notified when mail is delivered.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">observers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MailObserver"</span><span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-932c5c2447f0b403acf9f8ee10ee59c1">config.action_mailer.observers = ["MailObserver"]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-932c5c2447f0b403acf9f8ee10ee59c1">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailer.interceptors</code> registers interceptors which will be called before mail is sent.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">interceptors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MailInterceptor"</span><span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-0ad4be4f121fa6c4f641eb51debbd7cd">config.action_mailer.interceptors = ["MailInterceptor"]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-0ad4be4f121fa6c4f641eb51debbd7cd">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailer.preview_interceptors</code> registers interceptors which will be called before mail is previewed.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">preview_interceptors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"MyPreviewMailInterceptor"</span><span class="p">]</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-02ea0df5f2334836e952f3adfb46978a">config.action_mailer.preview_interceptors = ["MyPreviewMailInterceptor"]
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-02ea0df5f2334836e952f3adfb46978a">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailer.preview_path</code> specifies the location of mailer previews.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">preview_path</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="si">}</span><span class="s2">/lib/mailer_previews"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c5db3a6e277138bb5d2045beeec6f35c">config.action_mailer.preview_path = "#{Rails.root}/lib/mailer_previews"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c5db3a6e277138bb5d2045beeec6f35c">Copiar</button>
</div>
</li>
<li>
<p><code>config.action_mailer.show_previews</code> enable or disable mailer previews. By default this is <code>true</code> in development.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">show_previews</span> <span class="o">=</span> <span class="kp">false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-51b66e2f67a027b6335a4216edf038df">config.action_mailer.show_previews = false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-51b66e2f67a027b6335a4216edf038df">Copiar</button>
</div>
</li>
<li><p><code>config.action_mailer.deliver_later_queue_name</code> specifies the Active Job queue to use for delivery jobs. When this option is set to <code>nil</code>, delivery jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>). Make sure that your Active Job adapter is also configured to process the specified queue, otherwise delivery jobs may be silently ignored.</p></li>
<li><p><code>config.action_mailer.perform_caching</code> specifies whether the mailer templates should perform fragment caching or not. If it's not specified, the default will be <code>true</code>.</p></li>
<li><p><code>config.action_mailer.delivery_job</code> specifies delivery job for mail.</p></li>
</ul>
<h4 id="configuring-active-support"><a class="anchorlink" href="#configuring-active-support">3.13 Configuring Active Support</a></h4><p>There are a few configuration options available in Active Support:</p>
<ul>
<li><p><code>config.active_support.bare</code> enables or disables the loading of <code>active_support/all</code> when booting Rails. Defaults to <code>nil</code>, which means <code>active_support/all</code> is loaded.</p></li>
<li><p><code>config.active_support.test_order</code> sets the order in which the test cases are executed. Possible values are <code>:random</code> and <code>:sorted</code>. Defaults to <code>:random</code>.</p></li>
<li><p><code>config.active_support.escape_html_entities_in_json</code> enables or disables the escaping of HTML entities in JSON serialization. Defaults to <code>true</code>.</p></li>
<li><p><code>config.active_support.use_standard_json_time_format</code> enables or disables serializing dates to ISO 8601 format. Defaults to <code>true</code>.</p></li>
<li><p><code>config.active_support.time_precision</code> sets the precision of JSON encoded time values. Defaults to <code>3</code>.</p></li>
<li><p><code>config.active_support.hash_digest_class</code> allows configuring the digest class to use to generate non-sensitive digests, such as the ETag header.</p></li>
<li><p><code>config.active_support.use_authenticated_message_encryption</code> specifies whether to use AES-256-GCM authenticated encryption as the default cipher for encrypting messages instead of AES-256-CBC.</p></li>
<li><p><code>ActiveSupport::Logger.silencer</code> is set to <code>false</code> to disable the ability to silence logging in a block. The default is <code>true</code>.</p></li>
<li><p><code>ActiveSupport::Cache::Store.logger</code> specifies the logger to use within cache store operations.</p></li>
<li><p><code>ActiveSupport::Deprecation.behavior</code> alternative setter to <code>config.active_support.deprecation</code> which configures the behavior of deprecation warnings for Rails.</p></li>
<li><p><code>ActiveSupport::Deprecation.disallowed_behavior</code> alternative setter to <code>config.active_support.disallowed_deprecation</code> which configures the behavior of disallowed deprecation warnings for Rails.</p></li>
<li><p><code>ActiveSupport::Deprecation.disallowed_warnings</code> alternative setter to <code>config.active_support.disallowed_deprecation_warnings</code> which configures deprecation warnings that the Application considers disallowed. This allows, for example, specific deprecations to be treated as hard failures.</p></li>
<li><p><code>ActiveSupport::Deprecation.silence</code> takes a block in which all deprecation warnings are silenced.</p></li>
<li><p><code>ActiveSupport::Deprecation.silenced</code> sets whether or not to display deprecation warnings. The default is <code>false</code>.</p></li>
<li><p><code>ActiveSupport.utc_to_local_returns_utc_offset_times</code> configures
<code>ActiveSupport::TimeZone.utc_to_local</code> to return a time with a UTC offset
instead of a UTC time incorporating that offset.</p></li>
</ul>
<h4 id="configuring-active-job"><a class="anchorlink" href="#configuring-active-job">3.14 Configuring Active Job</a></h4><p><code>config.active_job</code> provides the following configuration options:</p>
<ul>
<li>
<p><code>config.active_job.queue_adapter</code> sets the adapter for the queuing backend. The default adapter is <code>:async</code>. For an up-to-date list of built-in adapters see the <a href="https://api.rubyonrails.org/v6.1.4/classes/ActiveJob/QueueAdapters.html">ActiveJob::QueueAdapters API documentation</a>.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># Be sure to have the adapter's gem in your Gemfile</span>
<span class="c1"># and follow the adapter's specific installation</span>
<span class="c1"># and deployment instructions.</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_adapter</span> <span class="o">=</span> <span class="ss">:sidekiq</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a611d171ed4ff0da1b1f301e80ce07bf"># Be sure to have the adapter's gem in your Gemfile
# and follow the adapter's specific installation
# and deployment instructions.
config.active_job.queue_adapter = :sidekiq
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a611d171ed4ff0da1b1f301e80ce07bf">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_job.default_queue_name</code> can be used to change the default queue name. By default this is <code>"default"</code>.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">default_queue_name</span> <span class="o">=</span> <span class="ss">:medium_priority</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b63b05753438ca388d92adb4f0f4556e">config.active_job.default_queue_name = :medium_priority
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b63b05753438ca388d92adb4f0f4556e">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_job.queue_name_prefix</code> allows you to set an optional, non-blank, queue name prefix for all jobs. By default it is blank and not used.</p>
<p>The following configuration would queue the given job on the <code>production_high_priority</code> queue when run in production:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_prefix</span> <span class="o">=</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-00a763dd448cb254cdc75e0c7529882e">config.active_job.queue_name_prefix = Rails.env
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-00a763dd448cb254cdc75e0c7529882e">Copiar</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">GuestsCleanupJob</span> <span class="o">&lt;</span> <span class="no">ActiveJob</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">queue_as</span> <span class="ss">:high_priority</span>
  <span class="c1">#....</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ea62560d61bdb37045ffa7ebd7a7c1b0">class GuestsCleanupJob &lt; ActiveJob::Base
  queue_as :high_priority
  #....
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ea62560d61bdb37045ffa7ebd7a7c1b0">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_job.queue_name_delimiter</code> has a default value of <code>'_'</code>. If <code>queue_name_prefix</code> is set, then <code>queue_name_delimiter</code> joins the prefix and the non-prefixed queue name.</p>
<p>The following configuration would queue the provided job on the <code>video_server.low_priority</code> queue:</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># prefix must be set for delimiter to be used</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_prefix</span> <span class="o">=</span> <span class="s1">'video_server'</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_job</span><span class="p">.</span><span class="nf">queue_name_delimiter</span> <span class="o">=</span> <span class="s1">'.'</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8464bf4ed203680896199c6c5d165770"># prefix must be set for delimiter to be used
config.active_job.queue_name_prefix = 'video_server'
config.active_job.queue_name_delimiter = '.'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8464bf4ed203680896199c6c5d165770">Copiar</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">EncoderJob</span> <span class="o">&lt;</span> <span class="no">ActiveJob</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">queue_as</span> <span class="ss">:low_priority</span>
  <span class="c1">#....</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-2d3b8322d84cb56617e925391f50e706">class EncoderJob &lt; ActiveJob::Base
  queue_as :low_priority
  #....
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-2d3b8322d84cb56617e925391f50e706">Copiar</button>
</div>
</li>
<li><p><code>config.active_job.logger</code> accepts a logger conforming to the interface of Log4r or the default Ruby Logger class, which is then used to log information from Active Job. You can retrieve this logger by calling <code>logger</code> on either an Active Job class or an Active Job instance. Set to <code>nil</code> to disable logging.</p></li>
<li><p><code>config.active_job.custom_serializers</code> allows to set custom argument serializers. Defaults to <code>[]</code>.</p></li>
<li><p><code>config.active_job.log_arguments</code> controls if the arguments of a job are logged. Defaults to <code>true</code>.</p></li>
<li><p><code>config.active_job.retry_jitter</code> controls the amount of "jitter" (random variation) applied to the delay time calculated when retrying failed jobs.</p></li>
<li><p><code>config.active_job.skip_after_callbacks_if_terminated</code> controls whether
<code>after_enqueue</code> / <code>after_perform</code> callbacks run when a <code>before_enqueue</code> /
<code>before_perform</code> callback halts with <code>throw :abort</code>.</p></li>
</ul>
<h4 id="configuring-action-cable"><a class="anchorlink" href="#configuring-action-cable">3.15 Configuring Action Cable</a></h4>
<ul>
<li>
<code>config.action_cable.url</code> accepts a string for the URL for where
you are hosting your Action Cable server. You would use this option
if you are running Action Cable servers that are separated from your
main application.</li>
<li>
<code>config.action_cable.mount_path</code> accepts a string for where to mount Action
Cable, as part of the main server process. Defaults to <code>/cable</code>.
You can set this as nil to not mount Action Cable as part of your
normal Rails server.</li>
</ul>
<p>You can find more detailed configuration options in the
<a href="action_cable_overview.html#configuration">Action Cable Overview</a>.</p><h4 id="configuring-active-storage"><a class="anchorlink" href="#configuring-active-storage">3.16 Configuring Active Storage</a></h4><p><code>config.active_storage</code> provides the following configuration options:</p>
<ul>
<li><p><code>config.active_storage.variant_processor</code> accepts a symbol <code>:mini_magick</code> or <code>:vips</code>, specifying whether variant transformations will be performed with MiniMagick or ruby-vips. The default is <code>:mini_magick</code>.</p></li>
<li><p><code>config.active_storage.analyzers</code> accepts an array of classes indicating the analyzers available for Active Storage blobs. The default is <code>[ActiveStorage::Analyzer::ImageAnalyzer, ActiveStorage::Analyzer::VideoAnalyzer]</code>. The former can extract width and height of an image blob; the latter can extract width, height, duration, angle, and aspect ratio of a video blob.</p></li>
<li><p><code>config.active_storage.previewers</code> accepts an array of classes indicating the image previewers available in Active Storage blobs. The default is <code>[ActiveStorage::Previewer::PopplerPDFPreviewer, ActiveStorage::Previewer::MuPDFPreviewer, ActiveStorage::Previewer::VideoPreviewer]</code>. <code>PopplerPDFPreviewer</code> and <code>MuPDFPreviewer</code> can generate a thumbnail from the first page of a PDF blob; <code>VideoPreviewer</code> from the relevant frame of a video blob.</p></li>
<li>
<p><code>config.active_storage.paths</code> accepts a hash of options indicating the locations of previewer/analyzer commands. The default is <code>{}</code>, meaning the commands will be looked for in the default path. Can include any of these options:</p>
<ul>
<li>
<code>:ffprobe</code> - The location of the ffprobe executable.</li>
<li>
<code>:mutool</code> - The location of the mutool executable.</li>
<li>
<code>:ffmpeg</code> - The location of the ffmpeg executable.</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">paths</span><span class="p">[</span><span class="ss">:ffprobe</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'/usr/local/bin/ffprobe'</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9a1495e9a1abc4e687ca0055ada278fb">config.active_storage.paths[:ffprobe] = '/usr/local/bin/ffprobe'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9a1495e9a1abc4e687ca0055ada278fb">Copiar</button>
</div>
</li>
<li><p><code>config.active_storage.variable_content_types</code> accepts an array of strings indicating the content types that Active Storage can transform through ImageMagick. The default is <code>%w(image/png image/gif image/jpg image/jpeg image/pjpeg image/tiff image/bmp image/vnd.adobe.photoshop image/vnd.microsoft.icon image/webp)</code>.</p></li>
<li><p><code>config.active_storage.web_image_content_types</code> accepts an array of strings regarded as web image content types in which variants can be processed without being converted to the fallback PNG format. If you want to use <code>WebP</code> variants in your application you can add <code>image/webp</code> to this array. The default is <code>%w(image/png image/jpeg image/jpg image/gif)</code>.</p></li>
<li><p><code>config.active_storage.content_types_to_serve_as_binary</code> accepts an array of strings indicating the content types that Active Storage will always serve as an attachment, rather than inline. The default is <code>%w(text/html
text/javascript image/svg+xml application/postscript application/x-shockwave-flash text/xml application/xml application/xhtml+xml application/mathml+xml text/cache-manifest)</code>.</p></li>
<li><p><code>config.active_storage.content_types_allowed_inline</code> accepts an array of strings indicating the content types that Active Storage allows to serve as inline. The default is <code>%w(image/png image/gif image/jpg image/jpeg image/tiff image/bmp image/vnd.adobe.photoshop image/vnd.microsoft.icon application/pdf)</code>.</p></li>
<li>
<p><code>config.active_storage.queues.analysis</code> accepts a symbol indicating the Active Job queue to use for analysis jobs. When this option is <code>nil</code>, analysis jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>).</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">queues</span><span class="p">.</span><span class="nf">analysis</span> <span class="o">=</span> <span class="ss">:low_priority</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-30ab0f10a09df16991c8969155dbc146">config.active_storage.queues.analysis = :low_priority
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-30ab0f10a09df16991c8969155dbc146">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_storage.queues.purge</code> accepts a symbol indicating the Active Job queue to use for purge jobs. When this option is <code>nil</code>, purge jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>).</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">queues</span><span class="p">.</span><span class="nf">purge</span> <span class="o">=</span> <span class="ss">:low_priority</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-a51dd7f090c75df51b744d0f738a71b8">config.active_storage.queues.purge = :low_priority
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a51dd7f090c75df51b744d0f738a71b8">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_storage.queues.mirror</code> accepts a symbol indicating the Active Job queue to use for direct upload mirroring jobs. When this option is <code>nil</code>, mirroring jobs are sent to the default Active Job queue (see <code>config.active_job.default_queue_name</code>). The default is <code>nil</code>.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">queues</span><span class="p">.</span><span class="nf">mirror</span> <span class="o">=</span> <span class="ss">:low_priority</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-225e49a7a67821b5653dec18f706b446">config.active_storage.queues.mirror = :low_priority
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-225e49a7a67821b5653dec18f706b446">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_storage.logger</code> can be used to set the logger used by Active Storage. Accepts a logger conforming to the interface of Log4r or the default Ruby Logger class.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-46288c52a452f46a53852bdd1bf5f568">config.active_storage.logger = ActiveSupport::Logger.new(STDOUT)
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-46288c52a452f46a53852bdd1bf5f568">Copiar</button>
</div>
</li>
<li>
<p><code>config.active_storage.service_urls_expire_in</code> determines the default expiry of URLs generated by:</p>
<ul>
<li><code>ActiveStorage::Blob#url</code></li>
<li><code>ActiveStorage::Blob#service_url_for_direct_upload</code></li>
<li><code>ActiveStorage::Variant#url</code></li>
</ul>
<p>The default is 5 minutes.</p>
</li>
<li>
<p><code>config.active_storage.routes_prefix</code> can be used to set the route prefix for the routes served by Active Storage. Accepts a string that will be prepended to the generated routes.</p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">active_storage</span><span class="p">.</span><span class="nf">routes_prefix</span> <span class="o">=</span> <span class="s1">'/files'</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ed0180f95f152286cb6d99042ab274cc">config.active_storage.routes_prefix = '/files'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ed0180f95f152286cb6d99042ab274cc">Copiar</button>
</div>
<p>The default is <code>/rails/active_storage</code>.</p>
</li>
<li><p><code>config.active_storage.replace_on_assign_to_many</code> determines whether assigning to a collection of attachments declared with <code>has_many_attached</code> replaces any existing attachments or appends to them. The default is <code>true</code>.</p></li>
<li><p><code>config.active_storage.track_variants</code> determines whether variants are recorded in the database. The default is <code>true</code>.</p></li>
<li><p><code>config.active_storage.draw_routes</code> can be used to toggle Active Storage route generation. The default is <code>true</code>.</p></li>
<li>
<p><code>config.active_storage.resolve_model_to_route</code> can be used to globally change how Active Storage files are delivered.</p>
<p>Allowed values are:</p>
<ul>
<li>
<code>:rails_storage_redirect</code>: Redirect to signed, short-lived service URLs.</li>
<li>
<code>:rails_storage_proxy</code>: Proxy files by downloading them.</li>
</ul>
<p>The default is <code>:rails_storage_redirect</code>.</p>
</li>
<li>
<p><code>config.active_storage.video_preview_arguments</code> can be used to alter the way ffmpeg generates video preview images.</p>
<p>The default is <code>"-y -vframes 1 -f image2"</code></p>
</li>
</ul>
<h4 id="results-of-config-load-defaults"><a class="anchorlink" href="#results-of-config-load-defaults">3.17 Results of <code>config.load_defaults</code></a></h4><p><code>config.load_defaults</code> sets new defaults up to and including the version passed. Such that passing, say, <code>6.0</code> also gets the new defaults from every version before it.</p><h5 id="for-6-1-defaults-from-previous-versions-below-and"><a class="anchorlink" href="#for-6-1-defaults-from-previous-versions-below-and">3.17.1 For '6.1', defaults from previous versions below and:</a></h5>
<ul>
<li>
<code>config.active_record.has_many_inversing</code>: <code>true</code>
</li>
<li>
<code>config.active_record.legacy_connection_handling</code>: <code>false</code>
</li>
<li>
<code>config.active_storage.track_variants</code>: <code>true</code>
</li>
<li>
<code>config.active_storage.queues.analysis</code>: <code>nil</code>
</li>
<li>
<code>config.active_storage.queues.purge</code>: <code>nil</code>
</li>
<li>
<code>config.action_mailbox.queues.incineration</code>: <code>nil</code>
</li>
<li>
<code>config.action_mailbox.queues.routing</code>: <code>nil</code>
</li>
<li>
<code>config.action_mailer.deliver_later_queue_name</code>: <code>nil</code>
</li>
<li>
<code>config.active_job.retry_jitter</code>: <code>0.15</code>
</li>
<li>
<code>config.active_job.skip_after_callbacks_if_terminated</code>: <code>true</code>
</li>
<li>
<code>config.action_dispatch.cookies_same_site_protection</code>: <code>:lax</code>
</li>
<li>
<code>config.action_dispatch.ssl_default_redirect_status</code> = <code>308</code>
</li>
<li>
<code>ActiveSupport.utc_to_local_returns_utc_offset_times</code>: <code>true</code>
</li>
<li>
<code>config.action_controller.urlsafe_csrf_tokens</code>: <code>true</code>
</li>
<li>
<code>config.action_view.form_with_generates_remote_forms</code>: <code>false</code>
</li>
<li>
<code>config.action_view.preload_links_header</code>: <code>true</code>
</li>
</ul>
<h5 id="for-6-0-defaults-from-previous-versions-below-and"><a class="anchorlink" href="#for-6-0-defaults-from-previous-versions-below-and">3.17.2 For '6.0', defaults from previous versions below and:</a></h5>
<ul>
<li>
<code>config.autoloader</code>: <code>:zeitwerk</code>
</li>
<li>
<code>config.action_view.default_enforce_utf8</code>: <code>false</code>
</li>
<li>
<code>config.action_dispatch.use_cookies_with_metadata</code>: <code>true</code>
</li>
<li>
<code>config.action_mailer.delivery_job</code>: <code>"ActionMailer::MailDeliveryJob"</code>
</li>
<li>
<code>config.active_storage.queues.analysis</code>: <code>:active_storage_analysis</code>
</li>
<li>
<code>config.active_storage.queues.purge</code>: <code>:active_storage_purge</code>
</li>
<li>
<code>config.active_storage.replace_on_assign_to_many</code>: <code>true</code>
</li>
<li>
<code>config.active_record.collection_cache_versioning</code>: <code>true</code>
</li>
</ul>
<h5 id="for-5-2-defaults-from-previous-versions-below-and"><a class="anchorlink" href="#for-5-2-defaults-from-previous-versions-below-and">3.17.3 For '5.2', defaults from previous versions below and:</a></h5>
<ul>
<li>
<code>config.active_record.cache_versioning</code>: <code>true</code>
</li>
<li>
<code>config.action_dispatch.use_authenticated_cookie_encryption</code>: <code>true</code>
</li>
<li>
<code>config.active_support.use_authenticated_message_encryption</code>: <code>true</code>
</li>
<li>
<code>config.active_support.hash_digest_class</code>: <code>::Digest::SHA1</code>
</li>
<li>
<code>config.action_controller.default_protect_from_forgery</code>: <code>true</code>
</li>
<li>
<code>config.action_view.form_with_generates_ids</code>: <code>true</code>
</li>
</ul>
<h5 id="for-5-1-defaults-from-previous-versions-below-and"><a class="anchorlink" href="#for-5-1-defaults-from-previous-versions-below-and">3.17.4 For '5.1', defaults from previous versions below and:</a></h5>
<ul>
<li>
<code>config.assets.unknown_asset_fallback</code>: <code>false</code>
</li>
<li>
<code>config.action_view.form_with_generates_remote_forms</code>: <code>true</code>
</li>
</ul>
<h5 id="for-5-0-baseline-defaults-from-below-and"><a class="anchorlink" href="#for-5-0-baseline-defaults-from-below-and">3.17.5 For '5.0', baseline defaults from below and:</a></h5>
<ul>
<li>
<code>config.action_controller.per_form_csrf_tokens</code>: <code>true</code>
</li>
<li>
<code>config.action_controller.forgery_protection_origin_check</code>: <code>true</code>
</li>
<li>
<code>ActiveSupport.to_time_preserves_timezone</code>: <code>true</code>
</li>
<li>
<code>config.active_record.belongs_to_required_by_default</code>: <code>true</code>
</li>
<li>
<code>config.ssl_options</code>: <code>{ hsts: { subdomains: true } }</code>
</li>
</ul>
<h5 id="baseline-defaults"><a class="anchorlink" href="#baseline-defaults">3.17.6 Baseline defaults:</a></h5>
<ul>
<li>
<code>config.action_controller.default_protect_from_forgery</code>: <code>false</code>
</li>
<li>
<code>config.action_controller.urlsafe_csrf_tokens</code>: <code>false</code>
</li>
<li>
<code>config.action_dispatch.cookies_same_site_protection</code>: <code>nil</code>
</li>
<li>
<code>config.action_mailer.delivery_job</code>: <code>ActionMailer::DeliveryJob</code>
</li>
<li>
<code>config.action_view.form_with_generates_ids</code>: <code>false</code>
</li>
<li>
<code>config.action_view.preload_links_header</code>: <code>nil</code>
</li>
<li>
<code>config.active_job.retry_jitter</code>: <code>0.0</code>
</li>
<li>
<code>config.active_job.skip_after_callbacks_if_terminated</code>: <code>false</code>
</li>
<li>
<code>config.action_mailbox.queues.incineration</code>: <code>:action_mailbox_incineration</code>
</li>
<li>
<code>config.action_mailbox.queues.routing</code>: <code>:action_mailbox_routing</code>
</li>
<li>
<code>config.action_mailer.deliver_later_queue_name</code>: <code>:mailers</code>
</li>
<li>
<code>config.active_record.collection_cache_versioning</code>: <code>false</code>
</li>
<li>
<code>config.active_record.cache_versioning</code>: <code>false</code>
</li>
<li>
<code>config.active_record.has_many_inversing</code>: <code>false</code>
</li>
<li>
<code>config.active_record.legacy_connection_handling</code>: <code>true</code>
</li>
<li>
<code>config.active_support.use_authenticated_message_encryption</code>: <code>false</code>
</li>
<li>
<code>config.active_support.hash_digest_class</code>: <code>::Digest::MD5</code>
</li>
<li>
<code>ActiveSupport.utc_to_local_returns_utc_offset_times</code>: <code>false</code>
</li>
<li>
<code>config.active_storage.video_preview_arguments</code>: <code>"-y -vframes 1 -f image2"</code>
</li>
</ul>
<h4 id="configuring-a-database"><a class="anchorlink" href="#configuring-a-database">3.18 Configuring a Database</a></h4><p>Just about every Rails application will interact with a database. You can connect to the database by setting an environment variable <code>ENV['DATABASE_URL']</code> or by using a configuration file called <code>config/database.yml</code>.</p><p>Using the <code>config/database.yml</code> file you can specify all the information needed to access your database:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b18b43265fa9a196412e760feb2c641b">development:
  adapter: postgresql
  database: blog_development
  pool: 5
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b18b43265fa9a196412e760feb2c641b">Copiar</button>
</div>
<p>This will connect to the database named <code>blog_development</code> using the <code>postgresql</code> adapter. This same information can be stored in a URL and provided via an environment variable like this:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ENV</span><span class="p">[</span><span class="s1">'DATABASE_URL'</span><span class="p">]</span> <span class="c1"># =&gt; "postgresql://localhost/blog_development?pool=5"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-457b5c9cae8539c98d1ce98768e2b6c2">ENV['DATABASE_URL'] # =&gt; "postgresql://localhost/blog_development?pool=5"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-457b5c9cae8539c98d1ce98768e2b6c2">Copiar</button>
</div>
<p>The <code>config/database.yml</code> file contains sections for three different environments in which Rails can run by default:</p>
<ul>
<li>The <code>development</code> environment is used on your development/local computer as you interact manually with the application.</li>
<li>The <code>test</code> environment is used when running automated tests.</li>
<li>The <code>production</code> environment is used when you deploy your application for the world to use.</li>
</ul>
<p>If you wish, you can manually specify a URL inside of your <code>config/database.yml</code></p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">postgresql://localhost/blog_development?pool=5</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f46b18c5e1cac487e9912f60eb6f8d6e">development:
  url: postgresql://localhost/blog_development?pool=5
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f46b18c5e1cac487e9912f60eb6f8d6e">Copiar</button>
</div>
<p>The <code>config/database.yml</code> file can contain ERB tags <code>&lt;%= %&gt;</code>. Anything in the tags will be evaluated as Ruby code. You can use this to pull out data from an environment variable or to perform calculations to generate the needed connection information.</p><div class="info"><p>You don't have to update the database configurations manually. If you look at the options of the application generator, you will see that one of the options is named <code>--database</code>. This option allows you to choose an adapter from a list of the most used relational databases. You can even run the generator repeatedly: <code>cd .. &amp;&amp; rails new blog --database=mysql</code>. When you confirm the overwriting of the <code>config/database.yml</code> file, your application will be configured for MySQL instead of SQLite. Detailed examples of the common database connections are below.</p></div><h4 id="connection-preference"><a class="anchorlink" href="#connection-preference">3.19 Connection Preference</a></h4><p>Since there are two ways to configure your connection (using <code>config/database.yml</code> or using an environment variable) it is important to understand how they can interact.</p><p>If you have an empty <code>config/database.yml</code> file but your <code>ENV['DATABASE_URL']</code> is present, then Rails will connect to the database via your environment variable:</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
<span class="go">postgresql://localhost/my_database
</span></code></pre>
<textarea class="clipboard-content" id="clipboard-9c8746a0548820e3b212687276898a9a">cat config/database.yml
echo $DATABASE_URL
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9c8746a0548820e3b212687276898a9a">Copiar</button>
</div>
<p>If you have a <code>config/database.yml</code> but no <code>ENV['DATABASE_URL']</code> then this file will be used to connect to your database:</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">development:
  adapter: postgresql
  database: my_database
  host: localhost

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e57c73a0b1d474e55ac028f782a6f334">cat config/database.yml
echo $DATABASE_URL
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e57c73a0b1d474e55ac028f782a6f334">Copiar</button>
</div>
<p>If you have both <code>config/database.yml</code> and <code>ENV['DATABASE_URL']</code> set then Rails will merge the configuration together. To better understand this we must see some examples.</p><p>When duplicate connection information is provided the environment variable will take precedence:</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">development:
  adapter: sqlite3
  database: NOT_my_database
  host: localhost

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
<span class="go">postgresql://localhost/my_database

</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fd50e209a28&gt;
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations<span class="o">=[</span>
<span class="gp">  #</span>&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0
<span class="go">    @env_name="development", @spec_name="primary",
</span><span class="gp">    @config={"adapter"=&gt;</span><span class="s2">"postgresql"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"my_database"</span>, <span class="s2">"host"</span><span class="o">=&gt;</span><span class="s2">"localhost"</span><span class="o">}</span>
<span class="gp">    @url="postgresql://localhost/my_database"&gt;</span><span class="w">
</span><span class="go">  ]
</span></code></pre>
<textarea class="clipboard-content" id="clipboard-d686ab748298a8fbe3d70c0c22176dcd">cat config/database.yml
echo $DATABASE_URL
bin/rails runner 'puts ActiveRecord::Base.configurations'
bin/rails runner 'puts ActiveRecord::Base.configurations.inspect'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-d686ab748298a8fbe3d70c0c22176dcd">Copiar</button>
</div>
<p>Here the adapter, host, and database match the information in <code>ENV['DATABASE_URL']</code>.</p><p>If non-duplicate information is provided you will get all unique values, environment variable still takes precedence in cases of any conflicts.</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">development:
  adapter: sqlite3
  pool: 5

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
<span class="go">postgresql://localhost/my_database

</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fd50e209a28&gt;
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations<span class="o">=[</span>
<span class="gp">  #</span>&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0
<span class="go">    @env_name="development", @spec_name="primary",
</span><span class="gp">    @config={"adapter"=&gt;</span><span class="s2">"postgresql"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"my_database"</span>, <span class="s2">"host"</span><span class="o">=&gt;</span><span class="s2">"localhost"</span>, <span class="s2">"pool"</span><span class="o">=&gt;</span>5<span class="o">}</span>
<span class="gp">    @url="postgresql://localhost/my_database"&gt;</span><span class="w">
</span><span class="go">  ]
</span></code></pre>
<textarea class="clipboard-content" id="clipboard-69d85e80dada417eedf6d15857426da1">cat config/database.yml
echo $DATABASE_URL
bin/rails runner 'puts ActiveRecord::Base.configurations'
bin/rails runner 'puts ActiveRecord::Base.configurations.inspect'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-69d85e80dada417eedf6d15857426da1">Copiar</button>
</div>
<p>Since pool is not in the <code>ENV['DATABASE_URL']</code> provided connection information its information is merged in. Since <code>adapter</code> is duplicate, the <code>ENV['DATABASE_URL']</code> connection information wins.</p><p>The only way to explicitly not use the connection information in <code>ENV['DATABASE_URL']</code> is to specify an explicit URL connection using the <code>"url"</code> sub key:</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">development:
  url: sqlite3:NOT_my_database

</span><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="nv">$DATABASE_URL</span>
<span class="go">postgresql://localhost/my_database

</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fd50e209a28&gt;
<span class="go">
</span><span class="gp">$</span><span class="w"> </span><span class="nb">bin/rails </span>runner <span class="s1">'puts ActiveRecord::Base.configurations.inspect'</span>
<span class="gp">#</span>&lt;ActiveRecord::DatabaseConfigurations:0x00007fc8eab02880 @configurations<span class="o">=[</span>
<span class="gp">  #</span>&lt;ActiveRecord::DatabaseConfigurations::UrlConfig:0x00007fc8eab020b0
<span class="go">    @env_name="development", @spec_name="primary",
</span><span class="gp">    @config={"adapter"=&gt;</span><span class="s2">"sqlite3"</span>, <span class="s2">"database"</span><span class="o">=&gt;</span><span class="s2">"NOT_my_database"</span><span class="o">}</span>
<span class="gp">    @url="sqlite3:NOT_my_database"&gt;</span><span class="w">
</span><span class="go">  ]
</span></code></pre>
<textarea class="clipboard-content" id="clipboard-a8fba7f29a2f6ed2e53575f17ca689b8">cat config/database.yml
echo $DATABASE_URL
bin/rails runner 'puts ActiveRecord::Base.configurations'
bin/rails runner 'puts ActiveRecord::Base.configurations.inspect'
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-a8fba7f29a2f6ed2e53575f17ca689b8">Copiar</button>
</div>
<p>Here the connection information in <code>ENV['DATABASE_URL']</code> is ignored, note the different adapter and database name.</p><p>Since it is possible to embed ERB in your <code>config/database.yml</code> it is best practice to explicitly show you are using the <code>ENV['DATABASE_URL']</code> to connect to your database. This is especially useful in production since you should not commit secrets like your database password into your source control (such as Git).</p><div class="code_container">
<pre><code class="highlight console"><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>config/database.yml
<span class="go">production:
</span><span class="gp">  url: &lt;%= ENV['DATABASE_URL'] %&gt;</span><span class="w">
</span></code></pre>
<textarea class="clipboard-content" id="clipboard-b650617e8e5aa9227cfba875b4bb21ee">cat config/database.yml
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b650617e8e5aa9227cfba875b4bb21ee">Copiar</button>
</div>
<p>Now the behavior is clear, that we are only using the connection information in <code>ENV['DATABASE_URL']</code>.</p><h5 id="configuring-an-sqlite3-database"><a class="anchorlink" href="#configuring-an-sqlite3-database">3.19.1 Configuring an SQLite3 Database</a></h5><p>Rails comes with built-in support for <a href="http://www.sqlite.org">SQLite3</a>, which is a lightweight serverless database application. While a busy production environment may overload SQLite, it works well for development and testing. Rails defaults to using an SQLite database when creating a new project, but you can always change it later.</p><p>Here's the section of the default configuration file (<code>config/database.yml</code>) with connection information for the development environment:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">sqlite3</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">db/development.sqlite3</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">timeout</span><span class="pi">:</span> <span class="m">5000</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-6449da77c1480cd99fbde37a58b74ec2">development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-6449da77c1480cd99fbde37a58b74ec2">Copiar</button>
</div>
<div class="note"><p>Rails uses an SQLite3 database for data storage by default because it is a zero configuration database that just works. Rails also supports MySQL (including MariaDB) and PostgreSQL "out of the box", and has plugins for many database systems. If you are using a database in a production environment Rails most likely has an adapter for it.</p></div><h5 id="configuring-a-mysql-or-mariadb-database"><a class="anchorlink" href="#configuring-a-mysql-or-mariadb-database">3.19.2 Configuring a MySQL or MariaDB Database</a></h5><p>If you choose to use MySQL or MariaDB instead of the shipped SQLite3 database, your <code>config/database.yml</code> will look a little different. Here's the development section:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">utf8mb4</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">root</span>
  <span class="na">password</span><span class="pi">:</span>
  <span class="na">socket</span><span class="pi">:</span> <span class="s">/tmp/mysql.sock</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-30a73c184c6fc765d0f59b076673a5ae">development:
  adapter: mysql2
  encoding: utf8mb4
  database: blog_development
  pool: 5
  username: root
  password:
  socket: /tmp/mysql.sock
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-30a73c184c6fc765d0f59b076673a5ae">Copiar</button>
</div>
<p>If your development database has a root user with an empty password, this configuration should work for you. Otherwise, change the username and password in the <code>development</code> section as appropriate.</p><div class="note"><p>If your MySQL version is 5.5 or 5.6 and want to use the <code>utf8mb4</code> character set by default, please configure your MySQL server to support the longer key prefix by enabling <code>innodb_large_prefix</code> system variable.</p></div><p>Advisory Locks are enabled by default on MySQL and are used to make database migrations concurrent safe. You can disable advisory locks by setting <code>advisory_locks</code> to <code>false</code>:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">mysql2</span>
  <span class="na">advisory_locks</span><span class="pi">:</span> <span class="no">false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-e4e7e48d1a17e127407d4a231d396f1a">production:
  adapter: mysql2
  advisory_locks: false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-e4e7e48d1a17e127407d4a231d396f1a">Copiar</button>
</div>
<h5 id="configuring-a-postgresql-database"><a class="anchorlink" href="#configuring-a-postgresql-database">3.19.3 Configuring a PostgreSQL Database</a></h5><p>If you choose to use PostgreSQL, your <code>config/database.yml</code> will be customized to use PostgreSQL databases:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">unicode</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">pool</span><span class="pi">:</span> <span class="m">5</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-ce05137a13383c4ccc423495270b7ef0">development:
  adapter: postgresql
  encoding: unicode
  database: blog_development
  pool: 5
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-ce05137a13383c4ccc423495270b7ef0">Copiar</button>
</div>
<p>By default Active Record uses database features like prepared statements and advisory locks. You might need to disable those features if you're using an external connection pooler like PgBouncer:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">prepared_statements</span><span class="pi">:</span> <span class="no">false</span>
  <span class="na">advisory_locks</span><span class="pi">:</span> <span class="no">false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-1d2848a94fb631c605f3264e50e0a9f7">production:
  adapter: postgresql
  prepared_statements: false
  advisory_locks: false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-1d2848a94fb631c605f3264e50e0a9f7">Copiar</button>
</div>
<p>If enabled, Active Record will create up to <code>1000</code> prepared statements per database connection by default. To modify this behavior you can set <code>statement_limit</code> to a different value:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">production</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">statement_limit</span><span class="pi">:</span> <span class="m">200</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-9eaf4045a85843568de3734705e95ff6">production:
  adapter: postgresql
  statement_limit: 200
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-9eaf4045a85843568de3734705e95ff6">Copiar</button>
</div>
<p>The more prepared statements in use: the more memory your database will require. If your PostgreSQL database is hitting memory limits, try lowering <code>statement_limit</code> or disabling prepared statements.</p><h5 id="configuring-an-sqlite3-database-for-jruby-platform"><a class="anchorlink" href="#configuring-an-sqlite3-database-for-jruby-platform">3.19.4 Configuring an SQLite3 Database for JRuby Platform</a></h5><p>If you choose to use SQLite3 and are using JRuby, your <code>config/database.yml</code> will look a little different. Here's the development section:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcsqlite3</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">db/development.sqlite3</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-8fc64bcaaf3d64a7bcf4a57139315b6f">development:
  adapter: jdbcsqlite3
  database: db/development.sqlite3
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-8fc64bcaaf3d64a7bcf4a57139315b6f">Copiar</button>
</div>
<h5 id="configuring-a-mysql-or-mariadb-database-for-jruby-platform"><a class="anchorlink" href="#configuring-a-mysql-or-mariadb-database-for-jruby-platform">3.19.5 Configuring a MySQL or MariaDB Database for JRuby Platform</a></h5><p>If you choose to use MySQL or MariaDB and are using JRuby, your <code>config/database.yml</code> will look a little different. Here's the development section:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcmysql</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">root</span>
  <span class="na">password</span><span class="pi">:</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-0375bee432ad99b1905a783655f5c0a1">development:
  adapter: jdbcmysql
  database: blog_development
  username: root
  password:
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-0375bee432ad99b1905a783655f5c0a1">Copiar</button>
</div>
<h5 id="configuring-a-postgresql-database-for-jruby-platform"><a class="anchorlink" href="#configuring-a-postgresql-database-for-jruby-platform">3.19.6 Configuring a PostgreSQL Database for JRuby Platform</a></h5><p>If you choose to use PostgreSQL and are using JRuby, your <code>config/database.yml</code> will look a little different. Here's the development section:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">jdbcpostgresql</span>
  <span class="na">encoding</span><span class="pi">:</span> <span class="s">unicode</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">blog_development</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">blog</span>
  <span class="na">password</span><span class="pi">:</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-c80585f9e19587444ab348ec2adb8b64">development:
  adapter: jdbcpostgresql
  encoding: unicode
  database: blog_development
  username: blog
  password:
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-c80585f9e19587444ab348ec2adb8b64">Copiar</button>
</div>
<p>Change the username and password in the <code>development</code> section as appropriate.</p><h5 id="configuring-metadata-storage"><a class="anchorlink" href="#configuring-metadata-storage">3.19.7 Configuring Metadata Storage</a></h5><p>By default Rails will store information about your Rails environment and schema
in an internal table named <code>ar_internal_metadata</code>.</p><p>To turn this off per connection, set <code>use_metadata_table</code> in your database
configuration. This is useful when working with a shared database and/or
database user that cannot create tables.</p><div class="code_container">
<pre><code class="highlight yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">adapter</span><span class="pi">:</span> <span class="s">postgresql</span>
  <span class="na">use_metadata_table</span><span class="pi">:</span> <span class="no">false</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b20050f35aba272c1f0cfe584b0279b5">development:
  adapter: postgresql
  use_metadata_table: false
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b20050f35aba272c1f0cfe584b0279b5">Copiar</button>
</div>
<h4 id="creating-rails-environments"><a class="anchorlink" href="#creating-rails-environments">3.20 Creating Rails Environments</a></h4><p>By default Rails ships with three environments: "development", "test", and "production". While these are sufficient for most use cases, there are circumstances when you want more environments.</p><p>Imagine you have a server which mirrors the production environment but is only used for testing. Such a server is commonly called a "staging server". To define an environment called "staging" for this server, just create a file called <code>config/environments/staging.rb</code>. Please use the contents of any existing file in <code>config/environments</code> as a starting point and make the necessary changes from there.</p><p>That environment is no different than the default ones, start a server with <code>bin/rails server -e staging</code>, a console with <code>bin/rails console -e staging</code>, <code>Rails.env.staging?</code> works, etc.</p><h4 id="deploy-to-a-subdirectory-relative-url-root"><a class="anchorlink" href="#deploy-to-a-subdirectory-relative-url-root">3.21 Deploy to a Subdirectory (relative URL root)</a></h4><p>By default Rails expects that your application is running at the root
(e.g. <code>/</code>). This section explains how to run your application inside a directory.</p><p>Let's assume we want to deploy our application to "/app1". Rails needs to know
this directory to generate the appropriate routes:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">relative_url_root</span> <span class="o">=</span> <span class="s2">"/app1"</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-04a6754fa655b290e58fa509f7fb4dbf">config.relative_url_root = "/app1"
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-04a6754fa655b290e58fa509f7fb4dbf">Copiar</button>
</div>
<p>alternatively you can set the <code>RAILS_RELATIVE_URL_ROOT</code> environment
variable.</p><p>Rails will now prepend "/app1" when generating links.</p><h5 id="using-passenger"><a class="anchorlink" href="#using-passenger">3.21.1 Using Passenger</a></h5><p>Passenger makes it easy to run your application in a subdirectory. You can find the relevant configuration in the <a href="https://www.phusionpassenger.com/library/deploy/apache/deploy/ruby/#deploying-an-app-to-a-sub-uri-or-subdirectory">Passenger manual</a>.</p><h5 id="using-a-reverse-proxy"><a class="anchorlink" href="#using-a-reverse-proxy">3.21.2 Using a Reverse Proxy</a></h5><p>Deploying your application using a reverse proxy has definite advantages over traditional deploys. They allow you to have more control over your server by layering the components required by your application.</p><p>Many modern web servers can be used as a proxy server to balance third-party elements such as caching servers or application servers.</p><p>One such application server you can use is <a href="https://bogomips.org/unicorn/">Unicorn</a> to run behind a reverse proxy.</p><p>In this case, you would need to configure the proxy server (NGINX, Apache, etc) to accept connections from your application server (Unicorn). By default Unicorn will listen for TCP connections on port 8080, but you can change the port or configure it to use sockets instead.</p><p>You can find more information in the <a href="https://bogomips.org/unicorn/README.html">Unicorn readme</a> and understand the <a href="https://bogomips.org/unicorn/PHILOSOPHY.html">philosophy</a> behind it.</p><p>Once you've configured the application server, you must proxy requests to it by configuring your web server appropriately. For example your NGINX config may include:</p><div class="code_container">
<pre><code class="highlight nginx"><span class="k">upstream</span> <span class="s">application_server</span> <span class="p">{</span>
  <span class="kn">server</span> <span class="nf">0.0.0.0</span><span class="p">:</span><span class="mi">8080</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
  <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
  <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span>

  <span class="kn">root</span> <span class="n">/root/path/to/your_app/public</span><span class="p">;</span>

  <span class="kn">try_files</span> <span class="nv">$uri</span><span class="n">/index.html</span> <span class="nv">$uri</span><span class="s">.html</span> <span class="s">@app</span><span class="p">;</span>

  <span class="kn">location</span> <span class="s">@app</span> <span class="p">{</span>
    <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
    <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
    <span class="kn">proxy_redirect</span> <span class="no">off</span><span class="p">;</span>
    <span class="kn">proxy_pass</span> <span class="s">http://application_server</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1"># some other configuration</span>
<span class="p">}</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-fe3f9dcbc79703706c9a2f9743d4a3cb">upstream application_server {
  server 0.0.0.0:8080;
}

server {
  listen 80;
  server_name localhost;

  root /root/path/to/your_app/public;

  try_files $uri/index.html $uri.html @app;

  location @app {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://application_server;
  }

  # some other configuration
}
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-fe3f9dcbc79703706c9a2f9743d4a3cb">Copiar</button>
</div>
<p>Be sure to read the <a href="https://nginx.org/en/docs/">NGINX documentation</a> for the most up-to-date information.</p><h3 id="rails-environment-settings"><a class="anchorlink" href="#rails-environment-settings">4 Rails Environment Settings</a></h3><p>Some parts of Rails can also be configured externally by supplying environment variables. The following environment variables are recognized by various parts of Rails:</p>
<ul>
<li><p><code>ENV["RAILS_ENV"]</code> defines the Rails environment (production, development, test, and so on) that Rails will run under.</p></li>
<li><p><code>ENV["RAILS_RELATIVE_URL_ROOT"]</code> is used by the routing code to recognize URLs when you <a href="configuring.html#deploy-to-a-subdirectory-relative-url-root">deploy your application to a subdirectory</a>.</p></li>
<li><p><code>ENV["RAILS_CACHE_ID"]</code> and <code>ENV["RAILS_APP_VERSION"]</code> are used to generate expanded cache keys in Rails' caching code. This allows you to have multiple separate caches from the same application.</p></li>
</ul>
<h3 id="using-initializer-files"><a class="anchorlink" href="#using-initializer-files">5 Using Initializer Files</a></h3><p>After loading the framework and any gems in your application, Rails turns to
loading initializers. An initializer is any Ruby file stored under
<code>config/initializers</code> in your application. You can use initializers to hold
configuration settings that should be made after all of the frameworks and gems
are loaded, such as options to configure settings for these parts.</p><p>The files in <code>config/initializers</code> (and any subdirectories of
<code>config/initializers</code>) are sorted and loaded one by one as part of
the <code>load_config_initializers</code> initializer.</p><p>If an initializer has code that relies on code in another initializer, you can
combine them into a single initializer instead. This makes the dependencies more
explicit, and can help surface new concepts within your application. Rails also
supports numbering of initializer file names, but this can lead to file name
churn. Explicitly loading initializers with <code>require</code> is not recommended, since
it will cause the initializer to get loaded twice.</p><div class="note"><p>There is no guarantee that your initializers will run after all the gem
initializers, so any initialization code that depends on a given gem having been
initialized should go into a <code>config.after_initialize</code> block.</p></div><h3 id="initialization-events"><a class="anchorlink" href="#initialization-events">6 Initialization events</a></h3><p>Rails has 5 initialization events which can be hooked into (listed in the order that they are run):</p>
<ul>
<li><p><code>before_configuration</code>: This is run as soon as the application constant inherits from <code>Rails::Application</code>. The <code>config</code> calls are evaluated before this happens.</p></li>
<li><p><code>before_initialize</code>: This is run directly before the initialization process of the application occurs with the <code>:bootstrap_hook</code> initializer near the beginning of the Rails initialization process.</p></li>
<li><p><code>to_prepare</code>: Run after the initializers are run for all Railties (including the application itself), but before eager loading and the middleware stack is built. More importantly, will run upon every code reload in <code>development</code>, but only once (during boot-up) in <code>production</code> and <code>test</code>.</p></li>
<li><p><code>before_eager_load</code>: This is run directly before eager loading occurs, which is the default behavior for the <code>production</code> environment and not for the <code>development</code> environment.</p></li>
<li><p><code>after_initialize</code>: Run directly after the initialization of the application, after the application initializers in <code>config/initializers</code> are run.</p></li>
</ul>
<p>To define an event for these hooks, use the block syntax within a <code>Rails::Application</code>, <code>Rails::Railtie</code> or <code>Rails::Engine</code> subclass:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">module</span> <span class="nn">YourApp</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">before_initialize</span> <span class="k">do</span>
      <span class="c1"># initialization code goes here</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-635c939cb5f08397e7aa63a253d61cba">module YourApp
  class Application &lt; Rails::Application
    config.before_initialize do
      # initialization code goes here
    end
  end
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-635c939cb5f08397e7aa63a253d61cba">Copiar</button>
</div>
<p>Alternatively, you can also do it through the <code>config</code> method on the <code>Rails.application</code> object:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">before_initialize</span> <span class="k">do</span>
  <span class="c1"># initialization code goes here</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f7c720ff55d44688282adc7056d9d44d">Rails.application.config.before_initialize do
  # initialization code goes here
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f7c720ff55d44688282adc7056d9d44d">Copiar</button>
</div>
<div class="warning"><p>Some parts of your application, notably routing, are not yet set up at the point where the <code>after_initialize</code> block is called.</p></div><h4 id="rails-railtie-initializer"><a class="anchorlink" href="#rails-railtie-initializer">6.1 <code>Rails::Railtie#initializer</code></a></h4><p>Rails has several initializers that run on startup that are all defined by using the <code>initializer</code> method from <code>Rails::Railtie</code>. Here's an example of the <code>set_helpers_path</code> initializer from Action Controller:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">initializer</span> <span class="s2">"action_controller.set_helpers_path"</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="no">ActionController</span><span class="o">::</span><span class="no">Helpers</span><span class="p">.</span><span class="nf">helpers_path</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="nf">helpers_paths</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-f7fc0f6d4060ed2cf8aa982850eb3a5f">initializer "action_controller.set_helpers_path" do |app|
  ActionController::Helpers.helpers_path = app.helpers_paths
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-f7fc0f6d4060ed2cf8aa982850eb3a5f">Copiar</button>
</div>
<p>The <code>initializer</code> method takes three arguments with the first being the name for the initializer and the second being an options hash (not shown here) and the third being a block. The <code>:before</code> key in the options hash can be specified to specify which initializer this new initializer must run before, and the <code>:after</code> key will specify which initializer to run this initializer <em>after</em>.</p><p>Initializers defined using the <code>initializer</code> method will be run in the order they are defined in, with the exception of ones that use the <code>:before</code> or <code>:after</code> methods.</p><div class="warning"><p>You may put your initializer before or after any other initializer in the chain, as long as it is logical. Say you have 4 initializers called "one" through "four" (defined in that order) and you define "four" to go <em>before</em> "four" but <em>after</em> "three", that just isn't logical and Rails will not be able to determine your initializer order.</p></div><p>The block argument of the <code>initializer</code> method is the instance of the application itself, and so we can access the configuration on it by using the <code>config</code> method as done in the example.</p><p>Because <code>Rails::Application</code> inherits from <code>Rails::Railtie</code> (indirectly), you can use the <code>initializer</code> method in <code>config/application.rb</code> to define initializers for the application.</p><h4 id="initializers"><a class="anchorlink" href="#initializers">6.2 Initializers</a></h4><p>Below is a comprehensive list of all the initializers found in Rails in the order that they are defined (and therefore run in, unless otherwise stated).</p>
<ul>
<li><p><code>load_environment_hook</code>: Serves as a placeholder so that <code>:load_environment_config</code> can be defined to run before it.</p></li>
<li><p><code>load_active_support</code>: Requires <code>active_support/dependencies</code> which sets up the basis for Active Support. Optionally requires <code>active_support/all</code> if <code>config.active_support.bare</code> is un-truthful, which is the default.</p></li>
<li><p><code>initialize_logger</code>: Initializes the logger (an <code>ActiveSupport::Logger</code> object) for the application and makes it accessible at <code>Rails.logger</code>, provided that no initializer inserted before this point has defined <code>Rails.logger</code>.</p></li>
<li><p><code>initialize_cache</code>: If <code>Rails.cache</code> isn't set yet, initializes the cache by referencing the value in <code>config.cache_store</code> and stores the outcome as <code>Rails.cache</code>. If this object responds to the <code>middleware</code> method, its middleware is inserted before <code>Rack::Runtime</code> in the middleware stack.</p></li>
<li><p><code>set_clear_dependencies_hook</code>: This initializer - which runs only if <code>cache_classes</code> is set to <code>false</code> - uses <code>ActionDispatch::Callbacks.after</code> to remove the constants which have been referenced during the request from the object space so that they will be reloaded during the following request.</p></li>
<li><p><code>initialize_dependency_mechanism</code>: If <code>config.cache_classes</code> is true, configures <code>ActiveSupport::Dependencies.mechanism</code> to <code>require</code> dependencies rather than <code>load</code> them.</p></li>
<li><p><code>bootstrap_hook</code>: Runs all configured <code>before_initialize</code> blocks.</p></li>
<li><p><code>i18n.callbacks</code>: In the development environment, sets up a <code>to_prepare</code> callback which will call <code>I18n.reload!</code> if any of the locales have changed since the last request. In production this callback will only run on the first request.</p></li>
<li><p><code>active_support.deprecation_behavior</code>: Sets up deprecation reporting for environments, defaulting to <code>:log</code> for development, <code>:notify</code> for production, and <code>:stderr</code> for test. If a value isn't set for <code>config.active_support.deprecation</code> then this initializer will prompt the user to configure this line in the current environment's <code>config/environments</code> file. Can be set to an array of values. This initializer also sets up behaviors for disallowed deprecations, defaulting to <code>:raise</code> for development and test and <code>:log</code> for production. Disallowed deprecation warnings default to an empty array.</p></li>
<li><p><code>active_support.initialize_time_zone</code>: Sets the default time zone for the application based on the <code>config.time_zone</code> setting, which defaults to "UTC".</p></li>
<li><p><code>active_support.initialize_beginning_of_week</code>: Sets the default beginning of week for the application based on <code>config.beginning_of_week</code> setting, which defaults to <code>:monday</code>.</p></li>
<li><p><code>active_support.set_configs</code>: Sets up Active Support by using the settings in <code>config.active_support</code> by <code>send</code>'ing the method names as setters to <code>ActiveSupport</code> and passing the values through.</p></li>
<li><p><code>action_dispatch.configure</code>: Configures the <code>ActionDispatch::Http::URL.tld_length</code> to be set to the value of <code>config.action_dispatch.tld_length</code>.</p></li>
<li><p><code>action_view.set_configs</code>: Sets up Action View by using the settings in <code>config.action_view</code> by <code>send</code>'ing the method names as setters to <code>ActionView::Base</code> and passing the values through.</p></li>
<li><p><code>action_controller.assets_config</code>: Initializes the <code>config.actions_controller.assets_dir</code> to the app's public directory if not explicitly configured.</p></li>
<li><p><code>action_controller.set_helpers_path</code>: Sets Action Controller's <code>helpers_path</code> to the application's <code>helpers_path</code>.</p></li>
<li><p><code>action_controller.parameters_config</code>: Configures strong parameters options for <code>ActionController::Parameters</code>.</p></li>
<li><p><code>action_controller.set_configs</code>: Sets up Action Controller by using the settings in <code>config.action_controller</code> by <code>send</code>'ing the method names as setters to <code>ActionController::Base</code> and passing the values through.</p></li>
<li><p><code>action_controller.compile_config_methods</code>: Initializes methods for the config settings specified so that they are quicker to access.</p></li>
<li><p><code>active_record.initialize_timezone</code>: Sets <code>ActiveRecord::Base.time_zone_aware_attributes</code> to <code>true</code>, as well as setting <code>ActiveRecord::Base.default_timezone</code> to UTC. When attributes are read from the database, they will be converted into the time zone specified by <code>Time.zone</code>.</p></li>
<li><p><code>active_record.logger</code>: Sets <code>ActiveRecord::Base.logger</code> - if it's not already set - to <code>Rails.logger</code>.</p></li>
<li><p><code>active_record.migration_error</code>: Configures middleware to check for pending migrations.</p></li>
<li><p><code>active_record.check_schema_cache_dump</code>: Loads the schema cache dump if configured and available.</p></li>
<li><p><code>active_record.warn_on_records_fetched_greater_than</code>: Enables warnings when queries return large numbers of records.</p></li>
<li><p><code>active_record.set_configs</code>: Sets up Active Record by using the settings in <code>config.active_record</code> by <code>send</code>'ing the method names as setters to <code>ActiveRecord::Base</code> and passing the values through.</p></li>
<li><p><code>active_record.initialize_database</code>: Loads the database configuration (by default) from <code>config/database.yml</code> and establishes a connection for the current environment.</p></li>
<li><p><code>active_record.log_runtime</code>: Includes <code>ActiveRecord::Railties::ControllerRuntime</code> which is responsible for reporting the time taken by Active Record calls for the request back to the logger.</p></li>
<li><p><code>active_record.set_reloader_hooks</code>: Resets all reloadable connections to the database if <code>config.cache_classes</code> is set to <code>false</code>.</p></li>
<li><p><code>active_record.add_watchable_files</code>: Adds <code>schema.rb</code> and <code>structure.sql</code> files to watchable files.</p></li>
<li><p><code>active_job.logger</code>: Sets <code>ActiveJob::Base.logger</code> - if it's not already set -
to <code>Rails.logger</code>.</p></li>
<li><p><code>active_job.set_configs</code>: Sets up Active Job by using the settings in <code>config.active_job</code> by <code>send</code>'ing the method names as setters to <code>ActiveJob::Base</code> and passing the values through.</p></li>
<li><p><code>action_mailer.logger</code>: Sets <code>ActionMailer::Base.logger</code> - if it's not already set - to <code>Rails.logger</code>.</p></li>
<li><p><code>action_mailer.set_configs</code>: Sets up Action Mailer by using the settings in <code>config.action_mailer</code> by <code>send</code>'ing the method names as setters to <code>ActionMailer::Base</code> and passing the values through.</p></li>
<li><p><code>action_mailer.compile_config_methods</code>: Initializes methods for the config settings specified so that they are quicker to access.</p></li>
<li><p><code>set_load_path</code>: This initializer runs before <code>bootstrap_hook</code>. Adds paths specified by <code>config.load_paths</code> and all autoload paths to <code>$LOAD_PATH</code>.</p></li>
<li><p><code>set_autoload_paths</code>: This initializer runs before <code>bootstrap_hook</code>. Adds all sub-directories of <code>app</code> and paths specified by <code>config.autoload_paths</code>, <code>config.eager_load_paths</code> and <code>config.autoload_once_paths</code> to <code>ActiveSupport::Dependencies.autoload_paths</code>.</p></li>
<li><p><code>add_routing_paths</code>: Loads (by default) all <code>config/routes.rb</code> files (in the application and railties, including engines) and sets up the routes for the application.</p></li>
<li><p><code>add_locales</code>: Adds the files in <code>config/locales</code> (from the application, railties, and engines) to <code>I18n.load_path</code>, making available the translations in these files.</p></li>
<li><p><code>add_view_paths</code>: Adds the directory <code>app/views</code> from the application, railties, and engines to the lookup path for view files for the application.</p></li>
<li><p><code>load_environment_config</code>: Loads the <code>config/environments</code> file for the current environment.</p></li>
<li><p><code>prepend_helpers_path</code>: Adds the directory <code>app/helpers</code> from the application, railties, and engines to the lookup path for helpers for the application.</p></li>
<li><p><code>load_config_initializers</code>: Loads all Ruby files from <code>config/initializers</code> in the application, railties, and engines. The files in this directory can be used to hold configuration settings that should be made after all of the frameworks are loaded.</p></li>
<li><p><code>engines_blank_point</code>: Provides a point-in-initialization to hook into if you wish to do anything before engines are loaded. After this point, all railtie and engine initializers are run.</p></li>
<li><p><code>add_generator_templates</code>: Finds templates for generators at <code>lib/templates</code> for the application, railties, and engines and adds these to the <code>config.generators.templates</code> setting, which will make the templates available for all generators to reference.</p></li>
<li><p><code>ensure_autoload_once_paths_as_subset</code>: Ensures that the <code>config.autoload_once_paths</code> only contains paths from <code>config.autoload_paths</code>. If it contains extra paths, then an exception will be raised.</p></li>
<li><p><code>add_to_prepare_blocks</code>: The block for every <code>config.to_prepare</code> call in the application, a railtie, or engine is added to the <code>to_prepare</code> callbacks for Action Dispatch which will be run per request in development, or before the first request in production.</p></li>
<li><p><code>add_builtin_route</code>: If the application is running under the development environment then this will append the route for <code>rails/info/properties</code> to the application routes. This route provides the detailed information such as Rails and Ruby version for <code>public/index.html</code> in a default Rails application.</p></li>
<li><p><code>build_middleware_stack</code>: Builds the middleware stack for the application, returning an object which has a <code>call</code> method which takes a Rack environment object for the request.</p></li>
<li><p><code>eager_load!</code>: If <code>config.eager_load</code> is <code>true</code>, runs the <code>config.before_eager_load</code> hooks and then calls <code>eager_load!</code> which will load all <code>config.eager_load_namespaces</code>.</p></li>
<li><p><code>finisher_hook</code>: Provides a hook for after the initialization of process of the application is complete, as well as running all the <code>config.after_initialize</code> blocks for the application, railties, and engines.</p></li>
<li><p><code>set_routes_reloader_hook</code>: Configures Action Dispatch to reload the routes file using <code>ActiveSupport::Callbacks.to_run</code>.</p></li>
<li><p><code>disable_dependency_loading</code>: Disables the automatic dependency loading if the <code>config.eager_load</code> is set to <code>true</code>.</p></li>
</ul>
<h3 id="database-pooling"><a class="anchorlink" href="#database-pooling">7 Database pooling</a></h3><p>Active Record database connections are managed by <code>ActiveRecord::ConnectionAdapters::ConnectionPool</code> which ensures that a connection pool synchronizes the amount of thread access to a limited number of database connections. This limit defaults to 5 and can be configured in <code>database.yml</code>.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="ss">development:
  adapter: </span><span class="n">sqlite3</span>
  <span class="ss">database: </span><span class="n">db</span><span class="o">/</span><span class="n">development</span><span class="p">.</span><span class="nf">sqlite3</span>
  <span class="ss">pool: </span><span class="mi">5</span>
  <span class="ss">timeout: </span><span class="mi">5000</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-cb69f697eaad12924d3044348f11c920">development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-cb69f697eaad12924d3044348f11c920">Copiar</button>
</div>
<p>Since the connection pooling is handled inside of Active Record by default, all application servers (Thin, Puma, Unicorn, etc.) should behave the same. The database connection pool is initially empty. As demand for connections increases it will create them until it reaches the connection pool limit.</p><p>Any one request will check out a connection the first time it requires access to the database. At the end of the request it will check the connection back in. This means that the additional connection slot will be available again for the next request in the queue.</p><p>If you try to use more connections than are available, Active Record will block
you and wait for a connection from the pool. If it cannot get a connection, a
timeout error similar to that given below will be thrown.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">ConnectionTimeoutError</span> <span class="o">-</span> <span class="n">could</span> <span class="n">not</span> <span class="n">obtain</span> <span class="n">a</span> <span class="n">database</span> <span class="n">connection</span> <span class="n">within</span> <span class="mf">5.000</span> <span class="n">seconds</span> <span class="p">(</span><span class="n">waited</span> <span class="mf">5.000</span> <span class="n">seconds</span><span class="p">)</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-4c08bd13339c948e11973039e19290f2">ActiveRecord::ConnectionTimeoutError - could not obtain a database connection within 5.000 seconds (waited 5.000 seconds)
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-4c08bd13339c948e11973039e19290f2">Copiar</button>
</div>
<p>If you get the above error, you might want to increase the size of the
connection pool by incrementing the <code>pool</code> option in <code>database.yml</code></p><div class="note"><p>If you are running in a multi-threaded environment, there could be a chance that several threads may be accessing multiple connections simultaneously. So depending on your current request load, you could very well have multiple threads contending for a limited number of connections.</p></div><h3 id="custom-configuration"><a class="anchorlink" href="#custom-configuration">8 Custom configuration</a></h3><p>You can configure your own code through the Rails configuration object with
custom configuration under either the <code>config.x</code> namespace, or <code>config</code> directly.
The key difference between these two is that you should be using <code>config.x</code> if you
are defining <em>nested</em> configuration (ex: <code>config.x.nested.hi</code>), and just
<code>config</code> for <em>single level</em> configuration (ex: <code>config.hello</code>).</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">config</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="o">=</span> <span class="ss">:daily</span>
<span class="n">config</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">retries</span>  <span class="o">=</span> <span class="mi">3</span>
<span class="n">config</span><span class="p">.</span><span class="nf">super_debugger</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-b0bbf4325db74216a647ed7156327680">config.x.payment_processing.schedule = :daily
config.x.payment_processing.retries  = 3
config.super_debugger = true
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-b0bbf4325db74216a647ed7156327680">Copiar</button>
</div>
<p>These configuration points are then available through the configuration object:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">schedule</span> <span class="c1"># =&gt; :daily</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">retries</span>  <span class="c1"># =&gt; 3</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span><span class="nf">payment_processing</span><span class="p">.</span><span class="nf">not_set</span>  <span class="c1"># =&gt; nil</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">super_debugger</span>                <span class="c1"># =&gt; true</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-99dedac7484f37e7e19c356236fd2c80">Rails.configuration.x.payment_processing.schedule # =&gt; :daily
Rails.configuration.x.payment_processing.retries  # =&gt; 3
Rails.configuration.x.payment_processing.not_set  # =&gt; nil
Rails.configuration.super_debugger                # =&gt; true
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-99dedac7484f37e7e19c356236fd2c80">Copiar</button>
</div>
<p>You can also use <code>Rails::Application.config_for</code> to load whole configuration files:</p><div class="code_container">
<pre><code class="highlight yaml"><span class="c1"># config/payment.yml:</span>
<span class="na">production</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">production</span>
  <span class="na">merchant_id</span><span class="pi">:</span> <span class="s">production_merchant_id</span>
  <span class="na">public_key</span><span class="pi">:</span>  <span class="s">production_public_key</span>
  <span class="na">private_key</span><span class="pi">:</span> <span class="s">production_private_key</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">sandbox</span>
  <span class="na">merchant_id</span><span class="pi">:</span> <span class="s">development_merchant_id</span>
  <span class="na">public_key</span><span class="pi">:</span>  <span class="s">development_public_key</span>
  <span class="na">private_key</span><span class="pi">:</span> <span class="s">development_private_key</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-14a620ef324ba95b0160da77a2a6af25"># config/payment.yml:
production:
  environment: production
  merchant_id: production_merchant_id
  public_key:  production_public_key
  private_key: production_private_key

development:
  environment: sandbox
  merchant_id: development_merchant_id
  public_key:  development_public_key
  private_key: development_private_key
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-14a620ef324ba95b0160da77a2a6af25">Copiar</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># config/application.rb</span>
<span class="k">module</span> <span class="nn">MyApp</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">payment</span> <span class="o">=</span> <span class="n">config_for</span><span class="p">(</span><span class="ss">:payment</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-03dbf06029ab6c59efa0180cbbcbe112"># config/application.rb
module MyApp
  class Application &lt; Rails::Application
    config.payment = config_for(:payment)
  end
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-03dbf06029ab6c59efa0180cbbcbe112">Copiar</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">Rails</span><span class="p">.</span><span class="nf">configuration</span><span class="p">.</span><span class="nf">payment</span><span class="p">[</span><span class="s1">'merchant_id'</span><span class="p">]</span> <span class="c1"># =&gt; production_merchant_id or development_merchant_id</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-15047c7e817ebd23dc2dbaac0e598b8f">Rails.configuration.payment['merchant_id'] # =&gt; production_merchant_id or development_merchant_id
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-15047c7e817ebd23dc2dbaac0e598b8f">Copiar</button>
</div>
<p><code>Rails::Application.config_for</code> supports a <code>shared</code> configuration to group common
configurations. The shared configuration will be merged into the environment
configuration.</p><div class="code_container">
<pre><code class="highlight yaml"><span class="c1"># config/example.yml</span>
<span class="na">shared</span><span class="pi">:</span>
  <span class="na">foo</span><span class="pi">:</span>
    <span class="na">bar</span><span class="pi">:</span>
      <span class="na">baz</span><span class="pi">:</span> <span class="m">1</span>

<span class="na">development</span><span class="pi">:</span>
  <span class="na">foo</span><span class="pi">:</span>
    <span class="na">bar</span><span class="pi">:</span>
      <span class="na">qux</span><span class="pi">:</span> <span class="m">2</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-386dee1b3986ffe140adda26004f86aa"># config/example.yml
shared:
  foo:
    bar:
      baz: 1

development:
  foo:
    bar:
      qux: 2
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-386dee1b3986ffe140adda26004f86aa">Copiar</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># development environment</span>
<span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config_for</span><span class="p">(</span><span class="ss">:example</span><span class="p">)[</span><span class="ss">:foo</span><span class="p">][</span><span class="ss">:bar</span><span class="p">]</span> <span class="c1">#=&gt; { baz: 1, qux: 2 }</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-70710d2b76f28de3e24fba724e3612d1"># development environment
Rails.application.config_for(:example)[:foo][:bar] #=&gt; { baz: 1, qux: 2 }
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-70710d2b76f28de3e24fba724e3612d1">Copiar</button>
</div>
<h3 id="search-engines-indexing"><a class="anchorlink" href="#search-engines-indexing">9 Search Engines Indexing</a></h3><p>Sometimes, you may want to prevent some pages of your application to be visible
on search sites like Google, Bing, Yahoo, or Duck Duck Go. The robots that index
these sites will first analyze the <code>http://your-site.com/robots.txt</code> file to
know which pages it is allowed to index.</p><p>Rails creates this file for you inside the <code>/public</code> folder. By default, it allows
search engines to index all pages of your application. If you want to block
indexing on all pages of your application, use this:</p><div class="code_container">
<pre><code class="highlight plaintext">User-agent: *
Disallow: /
</code></pre>
<textarea class="clipboard-content" id="clipboard-791be0d634c76c15b7af4528dcfc6f30">User-agent: *
Disallow: /
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-791be0d634c76c15b7af4528dcfc6f30">Copiar</button>
</div>
<p>To block just specific pages, it's necessary to use a more complex syntax. Learn
it on the <a href="https://www.robotstxt.org/robotstxt.html">official documentation</a>.</p><h3 id="evented-file-system-monitor"><a class="anchorlink" href="#evented-file-system-monitor">10 Evented File System Monitor</a></h3><p>If the <a href="https://github.com/guard/listen">listen gem</a> is loaded Rails uses an
evented file system monitor to detect changes when <code>config.cache_classes</code> is
<code>false</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'listen'</span><span class="p">,</span> <span class="s1">'~&gt; 3.3'</span>
<span class="k">end</span>
</code></pre>
<textarea class="clipboard-content" id="clipboard-384673370a124fffa144b5879208aa57">group :development do
  gem 'listen', '~&gt; 3.3'
end
</textarea>
<button class="clipboard-button" data-clipboard-target="#clipboard-384673370a124fffa144b5879208aa57">Copiar</button>
</div>
<p>Otherwise, in every request Rails walks the application tree to check if
anything has changed.</p><p>On Linux and macOS no additional gems are needed, but some are required
<a href="https://github.com/guard/listen#on-bsd">for *BSD</a> and
<a href="https://github.com/guard/listen#on-windows">for Windows</a>.</p><p>Note that <a href="https://github.com/guard/listen#issues--limitations">some setups are unsupported</a>.</p>

        <h3>Feedback</h3>
        <p>
          Você é incentivado a ajudar a melhorar a qualidade deste guia.
        </p>
        <p>
          Por favor, contribua se vir qualquer erros, inclusive erros de digitação.
          Para começar, você pode ler nossa sessão de <a href="https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">contribuindo com a documentação</a>.
        </p>
        <p>
          Você também pode encontrar conteúdo incompleto ou coisas que não estão atualizadas.
          Por favor, adicione qualquer documentação em falta na main do Rails. Certifique-se de checar o
          <a href="http://edgeguides.rubyonrails.org">Edge Guides (en-US)</a> primeiro para verificar
          se o problema já foi resolvido ou não no branch main.
          Verifique as <a href="ruby_on_rails_guides_guidelines.html">Diretrizes do Guia Ruby on Rails</a>
          para estilo e convenções.
        </p>
        <p>
          Se, por qualquer motivo, você encontrar algo para consertar, mas não conseguir consertá-lo, por favor
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">abra uma issue no nosso Guia</a>.
        </p>
        <p>
          E por último, mas não menos importante, qualquer tipo de discussão sobre a documentação do Ruby on Rails
          é muito bem vinda na <a href="https://discuss.rubyonrails.org/c/rubyonrails-docs">lista de discussão rubyonrails-docs</a> e nas
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">issues do Guia em português</a>.
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p> Este projeto está licenciado sob uma licença <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
<p>"Rails", "Ruby on Rails", e o logotipo Rails são marcas comerciais de David Heinemeier Hansson. Todos os direitos reservados.</p>

    </div>
  </div>
  <div id="toggle">
    <img alt="dark theme icon" class="icon">
  </div>
</body>
</html>
