<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Instrumentação do Active Support — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/highlight.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/search.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="icon" type="image/x-icon" />
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/clipboard.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/search.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr-documents.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/toggle-theme.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Instrumentação do Active Support — Ruby on Rails Guides" />
  <meta name="description" content="Instrumentação do Active SupportO Active Support é parte do núcleo do Rails, e provê extensões, utilidades e outros itens à linguagem Ruby. Uma das coisas fornecidas é uma API para instrumentação, que pode ser usada em uma aplicação para medir certas ações internas do código Ruby, como por exemplo, ações da sua aplicação Rails ou do framework em si. A instrumentação não é limitada somente ao Rails, podendo também ser usada de forma independente em outros scripts Ruby.Neste guia, você aprenderá como usar a API de instrumentação do Active Support, para medir eventos internos da sua aplicação Rails e de outros códigos Ruby.Ao terminar de ler este guia, você saberá: O que a instrumentação fornece. Como adicionar um subscriber (ou observador) à um hook. Os hooks internos do Rails, próprios para instrumentação. Como criar sua própria implementação de instrumentação." />
  <meta property="og:description" content="Instrumentação do Active SupportO Active Support é parte do núcleo do Rails, e provê extensões, utilidades e outros itens à linguagem Ruby. Uma das coisas fornecidas é uma API para instrumentação, que pode ser usada em uma aplicação para medir certas ações internas do código Ruby, como por exemplo, ações da sua aplicação Rails ou do framework em si. A instrumentação não é limitada somente ao Rails, podendo também ser usada de forma independente em outros scripts Ruby.Neste guia, você aprenderá como usar a API de instrumentação do Active Support, para medir eventos internos da sua aplicação Rails e de outros códigos Ruby.Ao terminar de ler este guia, você saberá: O que a instrumentação fornece. Como adicionar um subscriber (ou observador) à um hook. Os hooks internos do Rails, próprios para instrumentação. Como criar sua própria implementação de instrumentação." />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:site_name" content="Guia Ruby on Rails" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
    <div id="version-badge">v7.0.8</div>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Veja mais em <a href="https://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        Mais Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://rubyonrails.org/blog">Blog</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Guia oficial</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://discuss.rubyonrails.org/">Forum</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Contribua no GitHub</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Voltar para a página principal">Guiarails.com.br</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Home</a></li>
        <li class="guides-search guides-search-large">
          <input class="search-box search-box-large nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">Guias</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>Comece aqui</dt>
                  <dd><a href="getting_started.html">Começando com Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Models</dt>
                  <dd><a href="active_record_basics.html">Active Record Basics</a></dd>
                  <dd><a href="active_record_migrations.html">Active Record Migrations</a></dd>
                  <dd><a href="active_record_validations.html">Active Record Validations</a></dd>
                  <dd><a href="active_record_callbacks.html">Active Record Callbacks</a></dd>
                  <dd><a href="association_basics.html">Active Record Associations</a></dd>
                  <dd><a href="active_record_querying.html">Active Record Query Interface</a></dd>
                  <dd><a href="active_model_basics.html">Active Model Basics</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Views</dt>
                  <dd><a href="action_view_overview.html">Action View Overview</a></dd>
                  <dd><a href="layouts_and_rendering.html">Layouts and Rendering in Rails</a></dd>
                  <dd><a href="action_view_helpers.html">Action View Helpers</a></dd>
                  <dd><a href="form_helpers.html">Action View Form Helpers</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controllers</dt>
                  <dd><a href="action_controller_overview.html">Action Controller Overview</a></dd>
                  <dd><a href="routing.html">Rails Routing from the Outside In</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Outros componentes</dt>
                  <dd><a href="active_support_core_extensions.html">Active Support Core Extensions</a></dd>
                  <dd><a href="action_mailer_basics.html">Action Mailer Basics</a></dd>
                  <dd><a href="action_mailbox_basics.html">Action Mailbox Basics</a></dd>
                  <dd><a href="action_text_overview.html">Action Text Overview</a></dd>
                  <dd><a href="active_job_basics.html">Active Job Basics</a></dd>
                  <dd><a href="active_storage_overview.html">Active Storage Overview</a></dd>
                  <dd><a href="action_cable_overview.html">Action Cable Overview</a></dd>
                  <dd><a href="webpacker.html">Webpacker</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Indo mais fundo</dt>
                  <dd><a href="i18n.html">Rails Internationalization (I18n) API</a></dd>
                  <dd><a href="testing.html">Testing Rails Applications</a></dd>
                  <dd><a href="security.html">Securing Rails Applications</a></dd>
                  <dd><a href="debugging_rails_applications.html">Debugging Rails Applications</a></dd>
                  <dd><a href="configuring.html">Configuring Rails Applications</a></dd>
                  <dd><a href="command_line.html">The Rails Command Line</a></dd>
                  <dd><a href="asset_pipeline.html">The Asset Pipeline</a></dd>
                  <dd><a href="working_with_javascript_in_rails.html">Working with JavaScript in Rails</a></dd>
                  <dd><a href="initialization.html">The Rails Initialization Process</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</a></dd>
                  <dd><a href="classic_to_zeitwerk_howto.html">Classic para Zeitwerk - Como Fazer</a></dd>
                  <dd><a href="caching_with_rails.html">Caching with Rails: An Overview</a></dd>
                  <dd><a href="active_support_instrumentation.html">Active Support Instrumentation</a></dd>
                  <dd><a href="api_app.html">Using Rails for API-only Applications</a></dd>
                  <dd><a href="active_record_postgresql.html">Active Record and PostgreSQL</a></dd>
                  <dd><a href="active_record_multiple_databases.html">Multiple Databases with Active Record</a></dd>
                  <dd><a href="active_record_encryption.html">Active Record Encryption</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Estendendo o Rails</dt>
                  <dd><a href="plugins.html">The Basics of Creating Rails Plugins</a></dd>
                  <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                  <dd><a href="generators.html">Creating and Customizing Rails Generators &amp; Templates</a></dd>
                  <dd><a href="engines.html">Getting Started with Engines</a></dd>
                  <dd><a href="threading_and_code_execution.html">Threading and Code Execution in Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Contribuições</dt>
                  <dd><a href="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</a></dd>
                  <dd><a href="api_documentation_guidelines.html">API Documentation Guidelines</a></dd>
                  <dd><a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Políticas</dt>
                  <dd><a href="maintenance_policy.html">Maintenance Policy for Ruby on Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Release Notes</dt>
                  <dd><a href="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</a></dd>
                  <dd><a href="7_0_release_notes.html">Version 7.0 - Dezembro 2021</a></dd>
                  <dd><a href="6_1_release_notes.html">Version 6.1 - Dezembro 2020</a></dd>
                  <dd><a href="6_0_release_notes.html">Version 6.0 - Agosto 2019</a></dd>
                  <dd><a href="5_2_release_notes.html">Version 5.2 - April 2018</a></dd>
                  <dd><a href="5_1_release_notes.html">Version 5.1 - April 2017</a></dd>
                  <dd><a href="5_0_release_notes.html">Version 5.0 - June 2016</a></dd>
                  <dd><a href="4_2_release_notes.html">Version 4.2 - December 2014</a></dd>
                  <dd><a href="4_1_release_notes.html">Version 4.1 - April 2014</a></dd>
                  <dd><a href="4_0_release_notes.html">Version 4.0 - June 2013</a></dd>
                  <dd><a href="3_2_release_notes.html">Version 3.2 - January 2012</a></dd>
                  <dd><a href="3_1_release_notes.html">Version 3.1 - August 2011</a></dd>
                  <dd><a href="3_0_release_notes.html">Version 3.0 - August 2010</a></dd>
                  <dd><a href="2_3_release_notes.html">Version 2.3 - March 2009</a></dd>
                  <dd><a href="2_2_release_notes.html">Version 2.2 - November 2008</a></dd>
                </div>
            </div>
          </dl>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">Contribua</a></li>
        <li class="guides-search guides-search-small">
          <input class="search-box search-box-small nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guias</option>
              <optgroup label="Comece aqui">
                  <option value="getting_started.html">Começando com Rails</option>
              </optgroup>
              <optgroup label="Models">
                  <option value="active_record_basics.html">Active Record Basics</option>
                  <option value="active_record_migrations.html">Active Record Migrations</option>
                  <option value="active_record_validations.html">Active Record Validations</option>
                  <option value="active_record_callbacks.html">Active Record Callbacks</option>
                  <option value="association_basics.html">Active Record Associations</option>
                  <option value="active_record_querying.html">Active Record Query Interface</option>
                  <option value="active_model_basics.html">Active Model Basics</option>
              </optgroup>
              <optgroup label="Views">
                  <option value="action_view_overview.html">Action View Overview</option>
                  <option value="layouts_and_rendering.html">Layouts and Rendering in Rails</option>
                  <option value="action_view_helpers.html">Action View Helpers</option>
                  <option value="form_helpers.html">Action View Form Helpers</option>
              </optgroup>
              <optgroup label="Controllers">
                  <option value="action_controller_overview.html">Action Controller Overview</option>
                  <option value="routing.html">Rails Routing from the Outside In</option>
              </optgroup>
              <optgroup label="Outros componentes">
                  <option value="active_support_core_extensions.html">Active Support Core Extensions</option>
                  <option value="action_mailer_basics.html">Action Mailer Basics</option>
                  <option value="action_mailbox_basics.html">Action Mailbox Basics</option>
                  <option value="action_text_overview.html">Action Text Overview</option>
                  <option value="active_job_basics.html">Active Job Basics</option>
                  <option value="active_storage_overview.html">Active Storage Overview</option>
                  <option value="action_cable_overview.html">Action Cable Overview</option>
                  <option value="webpacker.html">Webpacker</option>
              </optgroup>
              <optgroup label="Indo mais fundo">
                  <option value="i18n.html">Rails Internationalization (I18n) API</option>
                  <option value="testing.html">Testing Rails Applications</option>
                  <option value="security.html">Securing Rails Applications</option>
                  <option value="debugging_rails_applications.html">Debugging Rails Applications</option>
                  <option value="configuring.html">Configuring Rails Applications</option>
                  <option value="command_line.html">The Rails Command Line</option>
                  <option value="asset_pipeline.html">The Asset Pipeline</option>
                  <option value="working_with_javascript_in_rails.html">Working with JavaScript in Rails</option>
                  <option value="initialization.html">The Rails Initialization Process</option>
                  <option value="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</option>
                  <option value="classic_to_zeitwerk_howto.html">Classic para Zeitwerk - Como Fazer</option>
                  <option value="caching_with_rails.html">Caching with Rails: An Overview</option>
                  <option value="active_support_instrumentation.html">Active Support Instrumentation</option>
                  <option value="api_app.html">Using Rails for API-only Applications</option>
                  <option value="active_record_postgresql.html">Active Record and PostgreSQL</option>
                  <option value="active_record_multiple_databases.html">Multiple Databases with Active Record</option>
                  <option value="active_record_encryption.html">Active Record Encryption</option>
              </optgroup>
              <optgroup label="Estendendo o Rails">
                  <option value="plugins.html">The Basics of Creating Rails Plugins</option>
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators &amp; Templates</option>
                  <option value="engines.html">Getting Started with Engines</option>
                  <option value="threading_and_code_execution.html">Threading and Code Execution in Rails</option>
              </optgroup>
              <optgroup label="Contribuições">
                  <option value="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</option>
                  <option value="api_documentation_guidelines.html">API Documentation Guidelines</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</option>
              </optgroup>
              <optgroup label="Políticas">
                  <option value="maintenance_policy.html">Maintenance Policy for Ruby on Rails</option>
              </optgroup>
              <optgroup label="Release Notes">
                  <option value="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</option>
                  <option value="7_0_release_notes.html">Version 7.0 - Dezembro 2021</option>
                  <option value="6_1_release_notes.html">Version 6.1 - Dezembro 2020</option>
                  <option value="6_0_release_notes.html">Version 6.0 - Agosto 2019</option>
                  <option value="5_2_release_notes.html">Version 5.2 - April 2018</option>
                  <option value="5_1_release_notes.html">Version 5.1 - April 2017</option>
                  <option value="5_0_release_notes.html">Version 5.0 - June 2016</option>
                  <option value="4_2_release_notes.html">Version 4.2 - December 2014</option>
                  <option value="4_1_release_notes.html">Version 4.1 - April 2014</option>
                  <option value="4_0_release_notes.html">Version 4.0 - June 2013</option>
                  <option value="3_2_release_notes.html">Version 3.2 - January 2012</option>
                  <option value="3_1_release_notes.html">Version 3.1 - August 2011</option>
                  <option value="3_0_release_notes.html">Version 3.0 - August 2010</option>
                  <option value="2_3_release_notes.html">Version 2.3 - March 2009</option>
                  <option value="2_2_release_notes.html">Version 2.2 - November 2008</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Instrumentação do <em>Active Support</em></h2><p>O <em>Active Support</em> é parte do núcleo do Rails, e provê extensões, utilidades e outros itens à linguagem Ruby. Uma das coisas fornecidas é uma API para instrumentação, que pode ser usada em uma aplicação para medir certas ações internas do código Ruby, como por exemplo, ações da sua aplicação Rails ou do <em>framework</em> em si. A instrumentação não é limitada somente ao Rails, podendo também ser usada de forma independente em outros <em>scripts</em> Ruby.</p><p>Neste guia, você aprenderá como usar a API de instrumentação do <em>Active Support</em>, para medir eventos internos da sua aplicação Rails e de outros códigos Ruby.</p><p>Ao terminar de ler este guia, você saberá:</p>
<ul>
<li>O que a instrumentação fornece.</li>
<li>Como adicionar um <em>subscriber</em> (ou observador) à um <em>hook</em>.</li>
<li>Os <em>hooks</em> internos do Rails, próprios para instrumentação.</li>
<li>Como criar sua própria implementação de instrumentação.</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#introduction-to-instrumentation">Introduction to Instrumentation</a></li>
<li><a href="#subscribing-to-an-event">Subscribing to an Event</a></li>
<li>
<a href="#rails-framework-hooks">Rails Framework Hooks</a>

<ul>
<li><a href="#action-controller">Action Controller</a></li>
<li><a href="#action-controller-%E2%80%94-caching">Action Controller — Caching</a></li>
<li><a href="#action-dispatch">Action Dispatch</a></li>
<li><a href="#action-view">Action View</a></li>
<li><a href="#active-record">Active Record</a></li>
<li><a href="#action-mailer">Action Mailer</a></li>
<li><a href="#active-support-%E2%80%94-caching">Active Support — Caching</a></li>
<li><a href="#active-job">Active Job</a></li>
<li><a href="#action-cable">Action Cable</a></li>
<li><a href="#active-storage">Active Storage</a></li>
<li><a href="#active-storage-%E2%80%94-storage-service">Active Storage — Storage Service</a></li>
<li><a href="#railties">Railties</a></li>
<li><a href="#rails">Rails</a></li>
</ul>
</li>
<li><a href="#exceptions">Exceptions</a></li>
<li><a href="#creating-custom-events">Creating Custom Events</a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="introduction-to-instrumentation"><a class="anchorlink" href="#introduction-to-instrumentation">1 Introduction to Instrumentation</a></h3><p>The instrumentation API provided by Active Support allows developers to provide hooks which other developers may hook into. There are <a href="#rails-framework-hooks">several of these</a> within the Rails framework. With this API, developers can choose to be notified when certain events occur inside their application or another piece of Ruby code.</p><p>For example, there is <a href="#sql-active-record">a hook</a> provided within Active Record that is called every time Active Record uses an SQL query on a database. This hook could be <strong>subscribed</strong> to, and used to track the number of queries during a certain action. There's <a href="#process-action-action-controller">another hook</a> around the processing of an action of a controller. This could be used, for instance, to track how long a specific action has taken.</p><p>You are even able to <a href="#creating-custom-events">create your own events</a> inside your application which you can later subscribe to.</p><h3 id="subscribing-to-an-event"><a class="anchorlink" href="#subscribing-to-an-event">2 Subscribing to an Event</a></h3><p>Subscribing to an event is easy. Use <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Notifications.html#method-c-subscribe"><code>ActiveSupport::Notifications.subscribe</code></a> with a block to
listen to any notification.</p><p>The block receives the following arguments:</p>
<ul>
<li>Name of the event</li>
<li>Time when it started</li>
<li>Time when it finished</li>
<li>A unique ID for the instrumenter that fired the event</li>
<li>The payload for the event</li>
</ul>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="c1"># your own custom stuff</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> Received! (started: </span><span class="si">#{</span><span class="n">started</span><span class="si">}</span><span class="s2">, finished: </span><span class="si">#{</span><span class="n">finished</span><span class="si">}</span><span class="s2">)"</span> <span class="c1"># process_action.action_controller Received (started: 2019-05-05 13:43:57 -0800, finished: 2019-05-05 13:43:58 -0800)</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.subscribe "process_action.action_controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  Rails.logger.info "#{name} Received! (started: #{started}, finished: #{finished})" # process_action.action_controller Received (started: 2019-05-05 13:43:57 -0800, finished: 2019-05-05 13:43:58 -0800)
end
'>Copy</button>
</div>
<p>If you are concerned about the accuracy of <code>started</code> and <code>finished</code> to compute a precise elapsed time, then use <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Notifications.html#method-c-monotonic_subscribe"><code>ActiveSupport::Notifications.monotonic_subscribe</code></a>. The given block would receive the same arguments as above, but the <code>started</code> and <code>finished</code> will have values with an accurate monotonic time instead of wall-clock time.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">monotonic_subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="c1"># your own custom stuff</span>
  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> Received! (started: </span><span class="si">#{</span><span class="n">started</span><span class="si">}</span><span class="s2">, finished: </span><span class="si">#{</span><span class="n">finished</span><span class="si">}</span><span class="s2">)"</span> <span class="c1"># process_action.action_controller Received (started: 1560978.425334, finished: 1560979.429234)</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.monotonic_subscribe "process_action.action_controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  Rails.logger.info "#{name} Received! (started: #{started}, finished: #{finished})" # process_action.action_controller Received (started: 1560978.425334, finished: 1560979.429234)
end
'>Copy</button>
</div>
<p>Defining all those block arguments each time can be tedious. You can easily create an <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Notifications/Event.html"><code>ActiveSupport::Notifications::Event</code></a>
from block arguments like this:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|*</span><span class="n">args</span><span class="o">|</span>
  <span class="n">event</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="o">::</span><span class="no">Event</span><span class="p">.</span><span class="nf">new</span> <span class="o">*</span><span class="n">args</span>

  <span class="n">event</span><span class="p">.</span><span class="nf">name</span>      <span class="c1"># =&gt; "process_action.action_controller"</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">duration</span>  <span class="c1"># =&gt; 10 (in milliseconds)</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">payload</span>   <span class="c1"># =&gt; {:extra=&gt;information}</span>

  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="n">event</span><span class="si">}</span><span class="s2"> Received!"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.subscribe "process_action.action_controller" do |*args|
  event = ActiveSupport::Notifications::Event.new *args

  event.name      # =&gt; "process_action.action_controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
'>Copy</button>
</div>
<p>You may also pass a block that accepts only one argument, and it will receive an event object:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"process_action.action_controller"</span> <span class="k">do</span> <span class="o">|</span><span class="n">event</span><span class="o">|</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">name</span>      <span class="c1"># =&gt; "process_action.action_controller"</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">duration</span>  <span class="c1"># =&gt; 10 (in milliseconds)</span>
  <span class="n">event</span><span class="p">.</span><span class="nf">payload</span>   <span class="c1"># =&gt; {:extra=&gt;information}</span>

  <span class="no">Rails</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span> <span class="s2">"</span><span class="si">#{</span><span class="n">event</span><span class="si">}</span><span class="s2"> Received!"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.subscribe "process_action.action_controller" do |event|
  event.name      # =&gt; "process_action.action_controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
'>Copy</button>
</div>
<p>You may also subscribe to events matching a regular expression. This enables you to subscribe to
multiple events at once. Here's how to subscribe to everything from <code>ActionController</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="sr">/action_controller/</span> <span class="k">do</span> <span class="o">|*</span><span class="n">args</span><span class="o">|</span>
  <span class="c1"># inspect all ActionController events</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="ActiveSupport::Notifications.subscribe /action_controller/ do |*args|
  # inspect all ActionController events
end
">Copy</button>
</div>
<h3 id="rails-framework-hooks"><a class="anchorlink" href="#rails-framework-hooks">3 Rails Framework Hooks</a></h3><p>Within the Ruby on Rails framework, there are a number of hooks provided for common events. These events and their payloads are detailed below.</p><h4 id="action-controller"><a class="anchorlink" href="#action-controller">3.1 Action Controller</a></h4><h5 id="start-processing-action-controller"><a class="anchorlink" href="#start-processing-action-controller">3.1.1 <code>start_processing.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:controller</code></td>
<td>The controller name</td>
</tr>
<tr>
<td><code>:action</code></td>
<td>The action</td>
</tr>
<tr>
<td><code>:params</code></td>
<td>Hash of request parameters without any filtered parameter</td>
</tr>
<tr>
<td><code>:headers</code></td>
<td>Request headers</td>
</tr>
<tr>
<td><code>:format</code></td>
<td>html/js/json/xml etc</td>
</tr>
<tr>
<td><code>:method</code></td>
<td>HTTP request verb</td>
</tr>
<tr>
<td><code>:path</code></td>
<td>Request path</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">controller: </span><span class="s2">"PostsController"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"new"</span><span class="p">,</span>
  <span class="ss">params: </span><span class="p">{</span> <span class="s2">"action"</span> <span class="o">=&gt;</span> <span class="s2">"new"</span><span class="p">,</span> <span class="s2">"controller"</span> <span class="o">=&gt;</span> <span class="s2">"posts"</span> <span class="p">},</span>
  <span class="ss">headers: </span><span class="c1">#&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,</span>
  <span class="ss">format: :html</span><span class="p">,</span>
  <span class="ss">method: </span><span class="s2">"GET"</span><span class="p">,</span>
  <span class="ss">path: </span><span class="s2">"/posts/new"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  controller: "PostsController",
  action: "new",
  params: { "action" =&gt; "new", "controller" =&gt; "posts" },
  headers: #&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts/new"
}
'>Copy</button>
</div>
<h5 id="process-action-action-controller"><a class="anchorlink" href="#process-action-action-controller">3.1.2 <code>process_action.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:controller</code></td>
<td>The controller name</td>
</tr>
<tr>
<td><code>:action</code></td>
<td>The action</td>
</tr>
<tr>
<td><code>:params</code></td>
<td>Hash of request parameters without any filtered parameter</td>
</tr>
<tr>
<td><code>:headers</code></td>
<td>Request headers</td>
</tr>
<tr>
<td><code>:format</code></td>
<td>html/js/json/xml etc</td>
</tr>
<tr>
<td><code>:method</code></td>
<td>HTTP request verb</td>
</tr>
<tr>
<td><code>:path</code></td>
<td>Request path</td>
</tr>
<tr>
<td><code>:request</code></td>
<td>The <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionDispatch/Request.html"><code>ActionDispatch::Request</code></a> object</td>
</tr>
<tr>
<td><code>:response</code></td>
<td>The <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionDispatch/Response.html"><code>ActionDispatch::Response</code></a> object</td>
</tr>
<tr>
<td><code>:status</code></td>
<td>HTTP status code</td>
</tr>
<tr>
<td><code>:view_runtime</code></td>
<td>Amount spent in view in ms</td>
</tr>
<tr>
<td><code>:db_runtime</code></td>
<td>Amount spent executing database queries in ms</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">controller: </span><span class="s2">"PostsController"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"index"</span><span class="p">,</span>
  <span class="ss">params: </span><span class="p">{</span><span class="s2">"action"</span> <span class="o">=&gt;</span> <span class="s2">"index"</span><span class="p">,</span> <span class="s2">"controller"</span> <span class="o">=&gt;</span> <span class="s2">"posts"</span><span class="p">},</span>
  <span class="ss">headers: </span><span class="c1">#&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,</span>
  <span class="ss">format: :html</span><span class="p">,</span>
  <span class="ss">method: </span><span class="s2">"GET"</span><span class="p">,</span>
  <span class="ss">path: </span><span class="s2">"/posts"</span><span class="p">,</span>
  <span class="ss">request: </span><span class="c1">#&lt;ActionDispatch::Request:0x00007ff1cb9bd7b8&gt;,</span>
  <span class="ss">response: </span><span class="c1">#&lt;ActionDispatch::Response:0x00007f8521841ec8&gt;,</span>
  <span class="ss">status: </span><span class="mi">200</span><span class="p">,</span>
  <span class="ss">view_runtime: </span><span class="mf">46.848</span><span class="p">,</span>
  <span class="ss">db_runtime: </span><span class="mf">0.157</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  controller: "PostsController",
  action: "index",
  params: {"action" =&gt; "index", "controller" =&gt; "posts"},
  headers: #&lt;ActionDispatch::Http::Headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts",
  request: #&lt;ActionDispatch::Request:0x00007ff1cb9bd7b8&gt;,
  response: #&lt;ActionDispatch::Response:0x00007f8521841ec8&gt;,
  status: 200,
  view_runtime: 46.848,
  db_runtime: 0.157
}
'>Copy</button>
</div>
<h5 id="send-file-action-controller"><a class="anchorlink" href="#send-file-action-controller">3.1.3 <code>send_file.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:path</code></td>
<td>Complete path to the file</td>
</tr>
</tbody>
</table>
<p>Additional keys may be added by the caller.</p><h5 id="send-data-action-controller"><a class="anchorlink" href="#send-data-action-controller">3.1.4 <code>send_data.action_controller</code></a></h5><p><code>ActionController</code> does not add any specific information to the payload. All options are passed through to the payload.</p><h5 id="redirect-to-action-controller"><a class="anchorlink" href="#redirect-to-action-controller">3.1.5 <code>redirect_to.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:status</code></td>
<td>HTTP response code</td>
</tr>
<tr>
<td><code>:location</code></td>
<td>URL to redirect to</td>
</tr>
<tr>
<td><code>:request</code></td>
<td>The <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionDispatch/Request.html"><code>ActionDispatch::Request</code></a> object</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">status: </span><span class="mi">302</span><span class="p">,</span>
  <span class="ss">location: </span><span class="s2">"http://localhost:3000/posts/new"</span><span class="p">,</span>
  <span class="ss">request: </span><span class="c1">#&lt;ActionDispatch::Request:0x00007ff1cb9bd7b8&gt;</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  status: 302,
  location: "http://localhost:3000/posts/new",
  request: #&lt;ActionDispatch::Request:0x00007ff1cb9bd7b8&gt;
}
'>Copy</button>
</div>
<h5 id="halted-callback-action-controller"><a class="anchorlink" href="#halted-callback-action-controller">3.1.6 <code>halted_callback.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:filter</code></td>
<td>Filter that halted the action</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">filter: </span><span class="s2">":halting_filter"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  filter: ":halting_filter"
}
'>Copy</button>
</div>
<h5 id="unpermitted-parameters-action-controller"><a class="anchorlink" href="#unpermitted-parameters-action-controller">3.1.7 <code>unpermitted_parameters.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:keys</code></td>
<td>The unpermitted keys</td>
</tr>
<tr>
<td><code>:context</code></td>
<td>Hash with the following keys: <code>:controller</code>, <code>:action</code>, <code>:params</code>, <code>:request</code>
</td>
</tr>
</tbody>
</table>
<h4 id="action-controller-—-caching"><a class="anchorlink" href="#action-controller-%E2%80%94-caching">3.2 Action Controller — Caching</a></h4><h5 id="write-fragment-action-controller"><a class="anchorlink" href="#write-fragment-action-controller">3.2.1 <code>write_fragment.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>The complete key</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-view'
}
">Copy</button>
</div>
<h5 id="read-fragment-action-controller"><a class="anchorlink" href="#read-fragment-action-controller">3.2.2 <code>read_fragment.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>The complete key</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-view'
}
">Copy</button>
</div>
<h5 id="expire-fragment-action-controller"><a class="anchorlink" href="#expire-fragment-action-controller">3.2.3 <code>expire_fragment.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>The complete key</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-view'
}
">Copy</button>
</div>
<h5 id="exist-fragment-questionmark-action-controller"><a class="anchorlink" href="#exist-fragment-questionmark-action-controller">3.2.4 <code>exist_fragment?.action_controller</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>The complete key</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s1">'posts/1-dashboard-view'</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-view'
}
">Copy</button>
</div>
<h4 id="action-dispatch"><a class="anchorlink" href="#action-dispatch">3.3 Action Dispatch</a></h4><h5 id="process-middleware-action-dispatch"><a class="anchorlink" href="#process-middleware-action-dispatch">3.3.1 <code>process_middleware.action_dispatch</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:middleware</code></td>
<td>Name of the middleware</td>
</tr>
</tbody>
</table>
<h4 id="action-view"><a class="anchorlink" href="#action-view">3.4 Action View</a></h4><h5 id="render-template-action-view"><a class="anchorlink" href="#render-template-action-view">3.4.1 <code>render_template.action_view</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:identifier</code></td>
<td>Full path to template</td>
</tr>
<tr>
<td><code>:layout</code></td>
<td>Applicable layout</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/index.html.erb"</span><span class="p">,</span>
  <span class="ss">layout: </span><span class="s2">"layouts/application"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/Users/adam/projects/notifications/app/views/posts/index.html.erb",
  layout: "layouts/application"
}
'>Copy</button>
</div>
<h5 id="render-partial-action-view"><a class="anchorlink" href="#render-partial-action-view">3.4.2 <code>render_partial.action_view</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:identifier</code></td>
<td>Full path to template</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/_form.html.erb"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/Users/adam/projects/notifications/app/views/posts/_form.html.erb"
}
'>Copy</button>
</div>
<h5 id="render-collection-action-view"><a class="anchorlink" href="#render-collection-action-view">3.4.3 <code>render_collection.action_view</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:identifier</code></td>
<td>Full path to template</td>
</tr>
<tr>
<td><code>:count</code></td>
<td>Size of collection</td>
</tr>
<tr>
<td><code>:cache_hits</code></td>
<td>Number of partials fetched from cache</td>
</tr>
</tbody>
</table>
<p>The <code>:cache_hits</code> key is only included if the collection is rendered with <code>cached: true</code>.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/posts/_post.html.erb"</span><span class="p">,</span>
  <span class="ss">count: </span><span class="mi">3</span><span class="p">,</span>
  <span class="ss">cache_hits: </span><span class="mi">0</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/Users/adam/projects/notifications/app/views/posts/_post.html.erb",
  count: 3,
  cache_hits: 0
}
'>Copy</button>
</div>
<h5 id="render-layout-action-view"><a class="anchorlink" href="#render-layout-action-view">3.4.4 <code>render_layout.action_view</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:identifier</code></td>
<td>Full path to template</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">identifier: </span><span class="s2">"/Users/adam/projects/notifications/app/views/layouts/application.html.erb"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/Users/adam/projects/notifications/app/views/layouts/application.html.erb"
}
'>Copy</button>
</div>
<h4 id="active-record"><a class="anchorlink" href="#active-record">3.5 Active Record</a></h4><h5 id="sql-active-record"><a class="anchorlink" href="#sql-active-record">3.5.1 <code>sql.active_record</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:sql</code></td>
<td>SQL statement</td>
</tr>
<tr>
<td><code>:name</code></td>
<td>Name of the operation</td>
</tr>
<tr>
<td><code>:connection</code></td>
<td>Connection object</td>
</tr>
<tr>
<td><code>:binds</code></td>
<td>Bind parameters</td>
</tr>
<tr>
<td><code>:type_casted_binds</code></td>
<td>Typecasted bind parameters</td>
</tr>
<tr>
<td><code>:statement_name</code></td>
<td>SQL Statement name</td>
</tr>
<tr>
<td><code>:cached</code></td>
<td>
<code>true</code> is added when cached queries used</td>
</tr>
</tbody>
</table>
<p>Adapters may add their own data as well.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">sql: </span><span class="s2">"SELECT </span><span class="se">\"</span><span class="s2">posts</span><span class="se">\"</span><span class="s2">.* FROM </span><span class="se">\"</span><span class="s2">posts</span><span class="se">\"</span><span class="s2"> "</span><span class="p">,</span>
  <span class="ss">name: </span><span class="s2">"Post Load"</span><span class="p">,</span>
  <span class="ss">connection: </span><span class="c1">#&lt;ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x00007f9f7a838850&gt;,</span>
  <span class="ss">binds: </span><span class="p">[</span><span class="c1">#&lt;ActiveModel::Attribute::WithCastValue:0x00007fe19d15dc00&gt;],</span>
  <span class="ss">type_casted_binds: </span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
  <span class="ss">statement_name: </span><span class="kp">nil</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  sql: "SELECT \"posts\".* FROM \"posts\" ",
  name: "Post Load",
  connection: #&lt;ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x00007f9f7a838850&gt;,
  binds: [#&lt;ActiveModel::Attribute::WithCastValue:0x00007fe19d15dc00&gt;],
  type_casted_binds: [11],
  statement_name: nil
}
'>Copy</button>
</div>
<h5 id="instantiation-active-record"><a class="anchorlink" href="#instantiation-active-record">3.5.2 <code>instantiation.active_record</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:record_count</code></td>
<td>Number of records that instantiated</td>
</tr>
<tr>
<td><code>:class_name</code></td>
<td>Record's class</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">record_count: </span><span class="mi">1</span><span class="p">,</span>
  <span class="ss">class_name: </span><span class="s2">"User"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  record_count: 1,
  class_name: "User"
}
'>Copy</button>
</div>
<h4 id="action-mailer"><a class="anchorlink" href="#action-mailer">3.6 Action Mailer</a></h4><h5 id="deliver-action-mailer"><a class="anchorlink" href="#deliver-action-mailer">3.6.1 <code>deliver.action_mailer</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:mailer</code></td>
<td>Name of the mailer class</td>
</tr>
<tr>
<td><code>:message_id</code></td>
<td>ID of the message, generated by the Mail gem</td>
</tr>
<tr>
<td><code>:subject</code></td>
<td>Subject of the mail</td>
</tr>
<tr>
<td><code>:to</code></td>
<td>To address(es) of the mail</td>
</tr>
<tr>
<td><code>:from</code></td>
<td>From address of the mail</td>
</tr>
<tr>
<td><code>:bcc</code></td>
<td>BCC addresses of the mail</td>
</tr>
<tr>
<td><code>:cc</code></td>
<td>CC addresses of the mail</td>
</tr>
<tr>
<td><code>:date</code></td>
<td>Date of the mail</td>
</tr>
<tr>
<td><code>:mail</code></td>
<td>The encoded form of the mail</td>
</tr>
<tr>
<td><code>:perform_deliveries</code></td>
<td>Whether delivery of this message is performed or not</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">mailer: </span><span class="s2">"Notification"</span><span class="p">,</span>
  <span class="ss">message_id: </span><span class="s2">"4f5b5491f1774_181b23fc3d4434d38138e5@mba.local.mail"</span><span class="p">,</span>
  <span class="ss">subject: </span><span class="s2">"Rails Guides"</span><span class="p">,</span>
  <span class="ss">to: </span><span class="p">[</span><span class="s2">"users@rails.com"</span><span class="p">,</span> <span class="s2">"dhh@rails.com"</span><span class="p">],</span>
  <span class="ss">from: </span><span class="p">[</span><span class="s2">"me@rails.com"</span><span class="p">],</span>
  <span class="ss">date: </span><span class="no">Sat</span><span class="p">,</span> <span class="mi">10</span> <span class="no">Mar</span> <span class="mi">2012</span> <span class="mi">14</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">09</span> <span class="o">+</span><span class="mo">0100</span><span class="p">,</span>
  <span class="ss">mail: </span><span class="s2">"..."</span><span class="p">,</span> <span class="c1"># omitted for brevity</span>
  <span class="ss">perform_deliveries: </span><span class="kp">true</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  mailer: "Notification",
  message_id: "4f5b5491f1774_181b23fc3d4434d38138e5@mba.local.mail",
  subject: "Rails Guides",
  to: ["users@rails.com", "dhh@rails.com"],
  from: ["me@rails.com"],
  date: Sat, 10 Mar 2012 14:18:09 +0100,
  mail: "...", # omitted for brevity
  perform_deliveries: true
}
'>Copy</button>
</div>
<h5 id="process-action-mailer"><a class="anchorlink" href="#process-action-mailer">3.6.2 <code>process.action_mailer</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:mailer</code></td>
<td>Name of the mailer class</td>
</tr>
<tr>
<td><code>:action</code></td>
<td>The action</td>
</tr>
<tr>
<td><code>:args</code></td>
<td>The arguments</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">mailer: </span><span class="s2">"Notification"</span><span class="p">,</span>
  <span class="ss">action: </span><span class="s2">"welcome_email"</span><span class="p">,</span>
  <span class="ss">args: </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  mailer: "Notification",
  action: "welcome_email",
  args: []
}
'>Copy</button>
</div>
<h4 id="active-support-—-caching"><a class="anchorlink" href="#active-support-%E2%80%94-caching">3.7 Active Support — Caching</a></h4><h5 id="cache-read-active-support"><a class="anchorlink" href="#cache-read-active-support">3.7.1 <code>cache_read.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:hit</code></td>
<td>If this read is a hit</td>
</tr>
<tr>
<td><code>:super_operation</code></td>
<td>
<code>:fetch</code> if a read is done with <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code>fetch</code></a>
</td>
</tr>
</tbody>
</table>
<h5 id="cache-read-multi-active-support"><a class="anchorlink" href="#cache-read-multi-active-support">3.7.2 <code>cache_read_multi.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Keys used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:hits</code></td>
<td>Keys of cache hits</td>
</tr>
<tr>
<td><code>:super_operation</code></td>
<td>
<code>:fetch_multi</code> if a read is done with <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/Store.html#method-i-fetch_multi"><code>fetch_multi</code></a>
</td>
</tr>
</tbody>
</table>
<h5 id="cache-generate-active-support"><a class="anchorlink" href="#cache-generate-active-support">3.7.3 <code>cache_generate.active_support</code></a></h5><p>This event is only emitted when <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code>fetch</code></a> is called with a block.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<p>Options passed to <code>fetch</code> will be merged with the payload when writing to the store.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-fetch-hit-active-support"><a class="anchorlink" href="#cache-fetch-hit-active-support">3.7.4 <code>cache_fetch_hit.active_support</code></a></h5><p>This event is only emitted when <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/Store.html#method-i-fetch"><code>fetch</code></a> is called with a block.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<p>Options passed to <code>fetch</code> will be merged with the payload.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-write-active-support"><a class="anchorlink" href="#cache-write-active-support">3.7.5 <code>cache_write.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<p>Cache stores may add their own data as well.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-write-multi-active-support"><a class="anchorlink" href="#cache-write-multi-active-support">3.7.6 <code>cache_write_multi.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Keys and values written to the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<h5 id="cache-increment-active-support"><a class="anchorlink" href="#cache-increment-active-support">3.7.7 <code>cache_increment.active_support</code></a></h5><p>This event is only emitted when using <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/MemCacheStore.html"><code>MemCacheStore</code></a>
or <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/RedisCacheStore.html"><code>RedisCacheStore</code></a>.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:amount</code></td>
<td>Increment amount</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"bottles-of-beer"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span><span class="p">,</span>
  <span class="ss">amount: </span><span class="mi">99</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "bottles-of-beer",
  store: "ActiveSupport::Cache::RedisCacheStore",
  amount: 99
}
'>Copy</button>
</div>
<h5 id="cache-decrement-active-support"><a class="anchorlink" href="#cache-decrement-active-support">3.7.8 <code>cache_decrement.active_support</code></a></h5><p>This event is only emitted when using the Memcached or Redis cache stores.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:amount</code></td>
<td>Decrement amount</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"bottles-of-beer"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span><span class="p">,</span>
  <span class="ss">amount: </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "bottles-of-beer",
  store: "ActiveSupport::Cache::RedisCacheStore",
  amount: 1
}
'>Copy</button>
</div>
<h5 id="cache-delete-active-support"><a class="anchorlink" href="#cache-delete-active-support">3.7.9 <code>cache_delete.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-delete-multi-active-support"><a class="anchorlink" href="#cache-delete-multi-active-support">3.7.10 <code>cache_delete_multi.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Keys used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<h5 id="cache-delete-matched-active-support"><a class="anchorlink" href="#cache-delete-matched-active-support">3.7.11 <code>cache_delete_matched.active_support</code></a></h5><p>This event is only emitted when using <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/RedisCacheStore.html"><code>RedisCacheStore</code></a>,
<a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/FileStore.html"><code>FileStore</code></a>, or <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/MemoryStore.html"><code>MemoryStore</code></a>.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key pattern used</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"posts/*"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::RedisCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "posts/*",
  store: "ActiveSupport::Cache::RedisCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-cleanup-active-support"><a class="anchorlink" href="#cache-cleanup-active-support">3.7.12 <code>cache_cleanup.active_support</code></a></h5><p>This event is only emitted when using <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/MemoryStore.html"><code>MemoryStore</code></a>.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:size</code></td>
<td>Number of entries in the cache before cleanup</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemoryStore"</span><span class="p">,</span>
  <span class="ss">size: </span><span class="mi">9001</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  store: "ActiveSupport::Cache::MemoryStore",
  size: 9001
}
'>Copy</button>
</div>
<h5 id="cache-prune-active-support"><a class="anchorlink" href="#cache-prune-active-support">3.7.13 <code>cache_prune.active_support</code></a></h5><p>This event is only emitted when using <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Cache/MemoryStore.html"><code>MemoryStore</code></a>.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
<tr>
<td><code>:key</code></td>
<td>Target size (in bytes) for the cache</td>
</tr>
<tr>
<td><code>:from</code></td>
<td>Size (in bytes) of the cache before prune</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemoryStore"</span><span class="p">,</span>
  <span class="ss">key: </span><span class="mi">5000</span><span class="p">,</span>
  <span class="ss">from: </span><span class="mi">9001</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  store: "ActiveSupport::Cache::MemoryStore",
  key: 5000,
  from: 9001
}
'>Copy</button>
</div>
<h5 id="cache-exist-questionmark-active-support"><a class="anchorlink" href="#cache-exist-questionmark-active-support">3.7.14 <code>cache_exist?.active_support</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Key used in the store</td>
</tr>
<tr>
<td><code>:store</code></td>
<td>Name of the store class</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="ss">key: </span><span class="s2">"name-of-complicated-computation"</span><span class="p">,</span>
  <span class="ss">store: </span><span class="s2">"ActiveSupport::Cache::MemCacheStore"</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h4 id="active-job"><a class="anchorlink" href="#active-job">3.8 Active Job</a></h4><h5 id="enqueue-at-active-job"><a class="anchorlink" href="#enqueue-at-active-job">3.8.1 <code>enqueue_at.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
</tbody>
</table>
<h5 id="enqueue-active-job"><a class="anchorlink" href="#enqueue-active-job">3.8.2 <code>enqueue.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
</tbody>
</table>
<h5 id="enqueue-retry-active-job"><a class="anchorlink" href="#enqueue-retry-active-job">3.8.3 <code>enqueue_retry.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:error</code></td>
<td>The error that caused the retry</td>
</tr>
<tr>
<td><code>:wait</code></td>
<td>The delay of the retry</td>
</tr>
</tbody>
</table>
<h5 id="perform-start-active-job"><a class="anchorlink" href="#perform-start-active-job">3.8.4 <code>perform_start.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
</tbody>
</table>
<h5 id="perform-active-job"><a class="anchorlink" href="#perform-active-job">3.8.5 <code>perform.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
</tbody>
</table>
<h5 id="retry-stopped-active-job"><a class="anchorlink" href="#retry-stopped-active-job">3.8.6 <code>retry_stopped.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
<tr>
<td><code>:error</code></td>
<td>The error that caused the retry</td>
</tr>
</tbody>
</table>
<h5 id="discard-active-job"><a class="anchorlink" href="#discard-active-job">3.8.7 <code>discard.active_job</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:adapter</code></td>
<td>QueueAdapter object processing the job</td>
</tr>
<tr>
<td><code>:job</code></td>
<td>Job object</td>
</tr>
<tr>
<td><code>:error</code></td>
<td>The error that caused the discard</td>
</tr>
</tbody>
</table>
<h4 id="action-cable"><a class="anchorlink" href="#action-cable">3.9 Action Cable</a></h4><h5 id="perform-action-action-cable"><a class="anchorlink" href="#perform-action-action-cable">3.9.1 <code>perform_action.action_cable</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>Name of the channel class</td>
</tr>
<tr>
<td><code>:action</code></td>
<td>The action</td>
</tr>
<tr>
<td><code>:data</code></td>
<td>A hash of data</td>
</tr>
</tbody>
</table>
<h5 id="transmit-action-cable"><a class="anchorlink" href="#transmit-action-cable">3.9.2 <code>transmit.action_cable</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>Name of the channel class</td>
</tr>
<tr>
<td><code>:data</code></td>
<td>A hash of data</td>
</tr>
<tr>
<td><code>:via</code></td>
<td>Via</td>
</tr>
</tbody>
</table>
<h5 id="transmit-subscription-confirmation-action-cable"><a class="anchorlink" href="#transmit-subscription-confirmation-action-cable">3.9.3 <code>transmit_subscription_confirmation.action_cable</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>Name of the channel class</td>
</tr>
</tbody>
</table>
<h5 id="transmit-subscription-rejection-action-cable"><a class="anchorlink" href="#transmit-subscription-rejection-action-cable">3.9.4 <code>transmit_subscription_rejection.action_cable</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>Name of the channel class</td>
</tr>
</tbody>
</table>
<h5 id="broadcast-action-cable"><a class="anchorlink" href="#broadcast-action-cable">3.9.5 <code>broadcast.action_cable</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:broadcasting</code></td>
<td>A named broadcasting</td>
</tr>
<tr>
<td><code>:message</code></td>
<td>A hash of message</td>
</tr>
<tr>
<td><code>:coder</code></td>
<td>The coder</td>
</tr>
</tbody>
</table>
<h4 id="active-storage"><a class="anchorlink" href="#active-storage">3.10 Active Storage</a></h4><h5 id="preview-active-storage"><a class="anchorlink" href="#preview-active-storage">3.10.1 <code>preview.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
</tbody>
</table>
<h5 id="transform-active-storage"><a class="anchorlink" href="#transform-active-storage">3.10.2 <code>transform.active_storage</code></a></h5><h5 id="analyze-active-storage"><a class="anchorlink" href="#analyze-active-storage">3.10.3 <code>analyze.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:analyzer</code></td>
<td>Name of analyzer e.g., ffprobe</td>
</tr>
</tbody>
</table>
<h4 id="active-storage-—-storage-service"><a class="anchorlink" href="#active-storage-%E2%80%94-storage-service">3.11 Active Storage — Storage Service</a></h4><h5 id="service-upload-active-storage"><a class="anchorlink" href="#service-upload-active-storage">3.11.1 <code>service_upload.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
<tr>
<td><code>:checksum</code></td>
<td>Checksum to ensure integrity</td>
</tr>
</tbody>
</table>
<h5 id="service-streaming-download-active-storage"><a class="anchorlink" href="#service-streaming-download-active-storage">3.11.2 <code>service_streaming_download.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
</tbody>
</table>
<h5 id="service-download-chunk-active-storage"><a class="anchorlink" href="#service-download-chunk-active-storage">3.11.3 <code>service_download_chunk.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
<tr>
<td><code>:range</code></td>
<td>Byte range attempted to be read</td>
</tr>
</tbody>
</table>
<h5 id="service-download-active-storage"><a class="anchorlink" href="#service-download-active-storage">3.11.4 <code>service_download.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
</tbody>
</table>
<h5 id="service-delete-active-storage"><a class="anchorlink" href="#service-delete-active-storage">3.11.5 <code>service_delete.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
</tbody>
</table>
<h5 id="service-delete-prefixed-active-storage"><a class="anchorlink" href="#service-delete-prefixed-active-storage">3.11.6 <code>service_delete_prefixed.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:prefix</code></td>
<td>Key prefix</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
</tbody>
</table>
<h5 id="service-exist-active-storage"><a class="anchorlink" href="#service-exist-active-storage">3.11.7 <code>service_exist.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
<tr>
<td><code>:exist</code></td>
<td>File or blob exists or not</td>
</tr>
</tbody>
</table>
<h5 id="service-url-active-storage"><a class="anchorlink" href="#service-url-active-storage">3.11.8 <code>service_url.active_storage</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
<tr>
<td><code>:url</code></td>
<td>Generated URL</td>
</tr>
</tbody>
</table>
<h5 id="service-update-metadata-active-storage"><a class="anchorlink" href="#service-update-metadata-active-storage">3.11.9 <code>service_update_metadata.active_storage</code></a></h5><p>This event is only emitted when using the Google Cloud Storage service.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>Secure token</td>
</tr>
<tr>
<td><code>:service</code></td>
<td>Name of the service</td>
</tr>
<tr>
<td><code>:content_type</code></td>
<td>HTTP <code>Content-Type</code> field</td>
</tr>
<tr>
<td><code>:disposition</code></td>
<td>HTTP <code>Content-Disposition</code> field</td>
</tr>
</tbody>
</table>
<h4 id="railties"><a class="anchorlink" href="#railties">3.12 Railties</a></h4><h5 id="load-config-initializer-railties"><a class="anchorlink" href="#load-config-initializer-railties">3.12.1 <code>load_config_initializer.railties</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:initializer</code></td>
<td>Path of loaded initializer in <code>config/initializers</code>
</td>
</tr>
</tbody>
</table>
<h4 id="rails"><a class="anchorlink" href="#rails">3.13 Rails</a></h4><h5 id="deprecation-rails"><a class="anchorlink" href="#deprecation-rails">3.13.1 <code>deprecation.rails</code></a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:message</code></td>
<td>The deprecation warning</td>
</tr>
<tr>
<td><code>:callstack</code></td>
<td>Where the deprecation came from</td>
</tr>
</tbody>
</table>
<h3 id="exceptions"><a class="anchorlink" href="#exceptions">4 Exceptions</a></h3><p>If an exception happens during any instrumentation the payload will include
information about it.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:exception</code></td>
<td>An array of two elements. Exception class name and the message</td>
</tr>
<tr>
<td><code>:exception_object</code></td>
<td>The exception object</td>
</tr>
</tbody>
</table>
<h3 id="creating-custom-events"><a class="anchorlink" href="#creating-custom-events">5 Creating Custom Events</a></h3><p>Adding your own events is easy as well. Active Support will take care of
all the heavy lifting for you. Simply call <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/Notifications.html#method-c-instrument"><code>ActiveSupport::Notifications.instrument</code></a> with a <code>name</code>, <code>payload</code>, and a block.
The notification will be sent after the block returns. Active Support will generate the start and end times,
and add the instrumenter's unique ID. All data passed into the <code>instrument</code> call will make
it into the payload.</p><p>Here's an example:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">instrument</span> <span class="s2">"my.custom.event"</span><span class="p">,</span> <span class="ss">this: :data</span> <span class="k">do</span>
  <span class="c1"># do your custom stuff here</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.instrument "my.custom.event", this: :data do
  # do your custom stuff here
end
'>Copy</button>
</div>
<p>Now you can listen to this event with:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"my.custom.event"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">inspect</span> <span class="c1"># {:this=&gt;:data}</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
'>Copy</button>
</div>
<p>You may also call <code>instrument</code> without passing a block. This lets you leverage the
instrumentation infrastructure for other messaging uses.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">instrument</span> <span class="s2">"my.custom.event"</span><span class="p">,</span> <span class="ss">this: :data</span>

<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Notifications</span><span class="p">.</span><span class="nf">subscribe</span> <span class="s2">"my.custom.event"</span> <span class="k">do</span> <span class="o">|</span><span class="nb">name</span><span class="p">,</span> <span class="n">started</span><span class="p">,</span> <span class="n">finished</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">inspect</span> <span class="c1"># {:this=&gt;:data}</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.instrument "my.custom.event", this: :data

ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
'>Copy</button>
</div>
<p>You should follow Rails conventions when defining your own events. The format is: <code>event.library</code>.
If your application is sending Tweets, you should create an event named <code>tweet.twitter</code>.</p>

        <h3>Feedback</h3>
        <p>
          Você é incentivado a ajudar a melhorar a qualidade deste guia.
        </p>
        <p>
          Por favor, contribua caso veja quaisquer erros, inclusive erros de digitação.
          Para começar, você pode ler nossa sessão de <a href="https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">contribuindo com a documentação</a>.
        </p>
        <p>
          Você também pode encontrar conteúdo incompleto ou coisas que não estão atualizadas.
          Por favor, adicione qualquer documentação em falta na main do Rails. Certifique-se de checar o
          <a href="http://edgeguides.rubyonrails.org">Edge Guides (en-US)</a> primeiro para verificar
          se o problema já foi resolvido ou não no branch main.
          Verifique as <a href="ruby_on_rails_guides_guidelines.html">Diretrizes do Guia Ruby on Rails</a>
          para estilo e convenções.
        </p>
        <p>
          Se, por qualquer motivo, você encontrar algo para consertar, mas não conseguir consertá-lo, por favor
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">abra uma issue no nosso Guia</a>.
        </p>
        <p>
          E por último, mas não menos importante, qualquer tipo de discussão sobre a documentação do Ruby on Rails
          é muito bem vinda na <a href="https://discuss.rubyonrails.org/c/rubyonrails-docs">forum oficial do Ruby on Rails</a> e nas
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">issues do Guia em português</a>.
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p> Este projeto está licenciado sob uma licença <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
<p>"Rails", "Ruby on Rails", e o logotipo Rails são marcas comerciais de David Heinemeier Hansson. Todos os direitos reservados.</p>

    </div>
  </div>
  <div id="toggle">
    <img alt="dark theme icon" class="icon">
  </div>
</body>
</html>
