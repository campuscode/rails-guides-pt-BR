<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Action View Form Helpers — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/highlight.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/search.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="icon" type="image/x-icon" />
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/clipboard.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/search.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr-documents.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/lunr.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/toggle-theme.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Action View Form Helpers — Ruby on Rails Guides" />
  <meta name="description" content="Action View Form HelpersFormulários em uma aplicação web são uma interface essencial para interação do usuário com o sistema. No entanto, pode-se tornar entendiante manter este tipo de marcação devido à necessidade de lidar com a nomenclatura e controles de formulários e seus inúmeros atributos. O Rails acaba com essa complexidade pois há um assistente de exibição que gera uma marcação de formulário. Mas para um uso correto, como há casos de uso diferentes, é necessário que os desenvolvedores conheçam as diferenças entre os métodos auxiliares antes de usá-los.Depois de ler este guia, você vai saber: Como criar formulários de pesquisa e tipos de semelhantes de formulários genéricos que não representam model específico da sua aplicação. Como criar formulários centrados em models pra criar e editar registros específicos no banco de dados. Como gerar select boxes (caixas de seleção) de vários tipos de dados. Que helpers de data e hora do Rails fornecem. O que torna um formulário de upload de arquivo diferente. Como publicar formulários para recursos externos e especificar a configuração de um token de autenticidade (authentic_token). Como criar formulários complexos." />
  <meta property="og:description" content="Action View Form HelpersFormulários em uma aplicação web são uma interface essencial para interação do usuário com o sistema. No entanto, pode-se tornar entendiante manter este tipo de marcação devido à necessidade de lidar com a nomenclatura e controles de formulários e seus inúmeros atributos. O Rails acaba com essa complexidade pois há um assistente de exibição que gera uma marcação de formulário. Mas para um uso correto, como há casos de uso diferentes, é necessário que os desenvolvedores conheçam as diferenças entre os métodos auxiliares antes de usá-los.Depois de ler este guia, você vai saber: Como criar formulários de pesquisa e tipos de semelhantes de formulários genéricos que não representam model específico da sua aplicação. Como criar formulários centrados em models pra criar e editar registros específicos no banco de dados. Como gerar select boxes (caixas de seleção) de vários tipos de dados. Que helpers de data e hora do Rails fornecem. O que torna um formulário de upload de arquivo diferente. Como publicar formulários para recursos externos e especificar a configuração de um token de autenticidade (authentic_token). Como criar formulários complexos." />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:site_name" content="Guia Ruby on Rails" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
    <div id="version-badge">v7.0.8</div>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Veja mais em <a href="https://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        Mais Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://rubyonrails.org/blog">Blog</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Guia oficial</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://discuss.rubyonrails.org/">Forum</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Contribua no GitHub</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Voltar para a página principal">Guiarails.com.br</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Home</a></li>
        <li class="guides-search guides-search-large">
          <input class="search-box search-box-large nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">Guias</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>Comece aqui</dt>
                  <dd><a href="getting_started.html">Começando com Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Models</dt>
                  <dd><a href="active_record_basics.html">Active Record Basics</a></dd>
                  <dd><a href="active_record_migrations.html">Active Record Migrations</a></dd>
                  <dd><a href="active_record_validations.html">Active Record Validations</a></dd>
                  <dd><a href="active_record_callbacks.html">Active Record Callbacks</a></dd>
                  <dd><a href="association_basics.html">Active Record Associations</a></dd>
                  <dd><a href="active_record_querying.html">Active Record Query Interface</a></dd>
                  <dd><a href="active_model_basics.html">Active Model Basics</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Views</dt>
                  <dd><a href="action_view_overview.html">Action View Overview</a></dd>
                  <dd><a href="layouts_and_rendering.html">Layouts and Rendering in Rails</a></dd>
                  <dd><a href="action_view_helpers.html">Action View Helpers</a></dd>
                  <dd><a href="form_helpers.html">Action View Form Helpers</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controllers</dt>
                  <dd><a href="action_controller_overview.html">Action Controller Overview</a></dd>
                  <dd><a href="routing.html">Rails Routing from the Outside In</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Outros componentes</dt>
                  <dd><a href="active_support_core_extensions.html">Active Support Core Extensions</a></dd>
                  <dd><a href="action_mailer_basics.html">Action Mailer Basics</a></dd>
                  <dd><a href="action_mailbox_basics.html">Action Mailbox Basics</a></dd>
                  <dd><a href="action_text_overview.html">Action Text Overview</a></dd>
                  <dd><a href="active_job_basics.html">Active Job Basics</a></dd>
                  <dd><a href="active_storage_overview.html">Active Storage Overview</a></dd>
                  <dd><a href="action_cable_overview.html">Action Cable Overview</a></dd>
                  <dd><a href="webpacker.html">Webpacker</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Indo mais fundo</dt>
                  <dd><a href="i18n.html">Rails Internationalization (I18n) API</a></dd>
                  <dd><a href="testing.html">Testing Rails Applications</a></dd>
                  <dd><a href="security.html">Securing Rails Applications</a></dd>
                  <dd><a href="debugging_rails_applications.html">Debugging Rails Applications</a></dd>
                  <dd><a href="configuring.html">Configuring Rails Applications</a></dd>
                  <dd><a href="command_line.html">The Rails Command Line</a></dd>
                  <dd><a href="asset_pipeline.html">The Asset Pipeline</a></dd>
                  <dd><a href="working_with_javascript_in_rails.html">Working with JavaScript in Rails</a></dd>
                  <dd><a href="initialization.html">The Rails Initialization Process</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</a></dd>
                  <dd><a href="classic_to_zeitwerk_howto.html">Classic para Zeitwerk - Como Fazer</a></dd>
                  <dd><a href="caching_with_rails.html">Caching with Rails: An Overview</a></dd>
                  <dd><a href="active_support_instrumentation.html">Active Support Instrumentation</a></dd>
                  <dd><a href="api_app.html">Using Rails for API-only Applications</a></dd>
                  <dd><a href="active_record_postgresql.html">Active Record and PostgreSQL</a></dd>
                  <dd><a href="active_record_multiple_databases.html">Multiple Databases with Active Record</a></dd>
                  <dd><a href="active_record_encryption.html">Active Record Encryption</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Estendendo o Rails</dt>
                  <dd><a href="plugins.html">The Basics of Creating Rails Plugins</a></dd>
                  <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                  <dd><a href="generators.html">Creating and Customizing Rails Generators &amp; Templates</a></dd>
                  <dd><a href="engines.html">Getting Started with Engines</a></dd>
                  <dd><a href="threading_and_code_execution.html">Threading and Code Execution in Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Contribuições</dt>
                  <dd><a href="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</a></dd>
                  <dd><a href="api_documentation_guidelines.html">API Documentation Guidelines</a></dd>
                  <dd><a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Políticas</dt>
                  <dd><a href="maintenance_policy.html">Maintenance Policy for Ruby on Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Release Notes</dt>
                  <dd><a href="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</a></dd>
                  <dd><a href="7_0_release_notes.html">Version 7.0 - Dezembro 2021</a></dd>
                  <dd><a href="6_1_release_notes.html">Version 6.1 - Dezembro 2020</a></dd>
                  <dd><a href="6_0_release_notes.html">Version 6.0 - Agosto 2019</a></dd>
                  <dd><a href="5_2_release_notes.html">Version 5.2 - April 2018</a></dd>
                  <dd><a href="5_1_release_notes.html">Version 5.1 - April 2017</a></dd>
                  <dd><a href="5_0_release_notes.html">Version 5.0 - June 2016</a></dd>
                  <dd><a href="4_2_release_notes.html">Version 4.2 - December 2014</a></dd>
                  <dd><a href="4_1_release_notes.html">Version 4.1 - April 2014</a></dd>
                  <dd><a href="4_0_release_notes.html">Version 4.0 - June 2013</a></dd>
                  <dd><a href="3_2_release_notes.html">Version 3.2 - January 2012</a></dd>
                  <dd><a href="3_1_release_notes.html">Version 3.1 - August 2011</a></dd>
                  <dd><a href="3_0_release_notes.html">Version 3.0 - August 2010</a></dd>
                  <dd><a href="2_3_release_notes.html">Version 2.3 - March 2009</a></dd>
                  <dd><a href="2_2_release_notes.html">Version 2.2 - November 2008</a></dd>
                </div>
            </div>
          </dl>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">Contribua</a></li>
        <li class="guides-search guides-search-small">
          <input class="search-box search-box-small nav-item" type="text" placeholder="Digite o termo...">
          <div class="search-results"></div>
          <div class="search-spinner">Aguarde...</div>
        </li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guias</option>
              <optgroup label="Comece aqui">
                  <option value="getting_started.html">Começando com Rails</option>
              </optgroup>
              <optgroup label="Models">
                  <option value="active_record_basics.html">Active Record Basics</option>
                  <option value="active_record_migrations.html">Active Record Migrations</option>
                  <option value="active_record_validations.html">Active Record Validations</option>
                  <option value="active_record_callbacks.html">Active Record Callbacks</option>
                  <option value="association_basics.html">Active Record Associations</option>
                  <option value="active_record_querying.html">Active Record Query Interface</option>
                  <option value="active_model_basics.html">Active Model Basics</option>
              </optgroup>
              <optgroup label="Views">
                  <option value="action_view_overview.html">Action View Overview</option>
                  <option value="layouts_and_rendering.html">Layouts and Rendering in Rails</option>
                  <option value="action_view_helpers.html">Action View Helpers</option>
                  <option value="form_helpers.html">Action View Form Helpers</option>
              </optgroup>
              <optgroup label="Controllers">
                  <option value="action_controller_overview.html">Action Controller Overview</option>
                  <option value="routing.html">Rails Routing from the Outside In</option>
              </optgroup>
              <optgroup label="Outros componentes">
                  <option value="active_support_core_extensions.html">Active Support Core Extensions</option>
                  <option value="action_mailer_basics.html">Action Mailer Basics</option>
                  <option value="action_mailbox_basics.html">Action Mailbox Basics</option>
                  <option value="action_text_overview.html">Action Text Overview</option>
                  <option value="active_job_basics.html">Active Job Basics</option>
                  <option value="active_storage_overview.html">Active Storage Overview</option>
                  <option value="action_cable_overview.html">Action Cable Overview</option>
                  <option value="webpacker.html">Webpacker</option>
              </optgroup>
              <optgroup label="Indo mais fundo">
                  <option value="i18n.html">Rails Internationalization (I18n) API</option>
                  <option value="testing.html">Testing Rails Applications</option>
                  <option value="security.html">Securing Rails Applications</option>
                  <option value="debugging_rails_applications.html">Debugging Rails Applications</option>
                  <option value="configuring.html">Configuring Rails Applications</option>
                  <option value="command_line.html">The Rails Command Line</option>
                  <option value="asset_pipeline.html">The Asset Pipeline</option>
                  <option value="working_with_javascript_in_rails.html">Working with JavaScript in Rails</option>
                  <option value="initialization.html">The Rails Initialization Process</option>
                  <option value="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</option>
                  <option value="classic_to_zeitwerk_howto.html">Classic para Zeitwerk - Como Fazer</option>
                  <option value="caching_with_rails.html">Caching with Rails: An Overview</option>
                  <option value="active_support_instrumentation.html">Active Support Instrumentation</option>
                  <option value="api_app.html">Using Rails for API-only Applications</option>
                  <option value="active_record_postgresql.html">Active Record and PostgreSQL</option>
                  <option value="active_record_multiple_databases.html">Multiple Databases with Active Record</option>
                  <option value="active_record_encryption.html">Active Record Encryption</option>
              </optgroup>
              <optgroup label="Estendendo o Rails">
                  <option value="plugins.html">The Basics of Creating Rails Plugins</option>
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators &amp; Templates</option>
                  <option value="engines.html">Getting Started with Engines</option>
                  <option value="threading_and_code_execution.html">Threading and Code Execution in Rails</option>
              </optgroup>
              <optgroup label="Contribuições">
                  <option value="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</option>
                  <option value="api_documentation_guidelines.html">API Documentation Guidelines</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</option>
              </optgroup>
              <optgroup label="Políticas">
                  <option value="maintenance_policy.html">Maintenance Policy for Ruby on Rails</option>
              </optgroup>
              <optgroup label="Release Notes">
                  <option value="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</option>
                  <option value="7_0_release_notes.html">Version 7.0 - Dezembro 2021</option>
                  <option value="6_1_release_notes.html">Version 6.1 - Dezembro 2020</option>
                  <option value="6_0_release_notes.html">Version 6.0 - Agosto 2019</option>
                  <option value="5_2_release_notes.html">Version 5.2 - April 2018</option>
                  <option value="5_1_release_notes.html">Version 5.1 - April 2017</option>
                  <option value="5_0_release_notes.html">Version 5.0 - June 2016</option>
                  <option value="4_2_release_notes.html">Version 4.2 - December 2014</option>
                  <option value="4_1_release_notes.html">Version 4.1 - April 2014</option>
                  <option value="4_0_release_notes.html">Version 4.0 - June 2013</option>
                  <option value="3_2_release_notes.html">Version 3.2 - January 2012</option>
                  <option value="3_1_release_notes.html">Version 3.1 - August 2011</option>
                  <option value="3_0_release_notes.html">Version 3.0 - August 2010</option>
                  <option value="2_3_release_notes.html">Version 2.3 - March 2009</option>
                  <option value="2_2_release_notes.html">Version 2.2 - November 2008</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Action View Form Helpers</h2><p>Formulários em uma aplicação web são uma interface essencial para interação do usuário com o sistema. No entanto, pode-se tornar entendiante manter este tipo de marcação devido à necessidade de lidar com a nomenclatura e controles de formulários e seus inúmeros atributos. O Rails acaba com essa complexidade pois há um assistente de exibição que gera uma marcação de formulário. Mas para um uso correto, como há casos de uso diferentes, é necessário que os desenvolvedores conheçam as diferenças entre os métodos auxiliares antes de usá-los.</p><p>Depois de ler este guia, você vai saber:</p>
<ul>
<li>Como criar formulários de pesquisa e tipos de semelhantes de formulários genéricos que não representam <em>model</em> específico da sua aplicação.</li>
<li>Como criar formulários centrados em <em>models</em> pra criar e editar registros específicos no banco de dados.</li>
<li>Como gerar <em>select boxes</em> (caixas de seleção) de vários tipos de dados.</li>
<li>Que  helpers de data e hora do Rails fornecem.</li>
<li>O que torna um formulário de upload de arquivo diferente.</li>
<li>Como publicar formulários para recursos externos e especificar a configuração de um token de autenticidade (<code>authentic_token</code>).</li>
<li>Como criar formulários complexos.</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li>
<a href="#trabalhando-com-formul%C3%A1rios-b%C3%A1sicos">Trabalhando com formulários básicos.</a>

<ul>
<li><a href="#formul%C3%A1rio-de-pesquisa-gen%C3%A9rica">Formulário de pesquisa genérica</a></li>
<li><a href="#helpers-para-gerar-elementos-de-formul%C3%A1rio">Helpers para gerar elementos de formulário</a></li>
<li><a href="#outros-auxiliares-interessantes">Outros auxiliares interessantes</a></li>
</ul>
</li>
<li>
<a href="#trabalhando-com-objetos-model">Trabalhando com Objetos <em>Model</em></a>

<ul>
<li><a href="#vinculando-um-formul%C3%A1rio-a-um-objeto">Vinculando um Formulário a um Objeto</a></li>
<li><a href="#confiando-na-identifica%C3%A7%C3%A3o-de-registro">Confiando na Identificação de Registro</a></li>
<li><a href="#como-os-formul%C3%A1rios-funcionam-com-os-m%C3%A9todos-patch-put-ou-delete-questionmark">Como os formulários funcionam com os métodos <em>PATCH</em>, <em>PUT</em>, ou <em>DELETE</em>?</a></li>
</ul>
</li>
<li>
<a href="#criando-caixas-de-sele%C3%A7%C3%A3o-select-boxes-com-facilidade">Criando Caixas de Seleção (<em>Select Boxes</em>) com Facilidade</a>

<ul>
<li><a href="#grupos-de-op%C3%A7%C3%A3o">Grupos de Opção</a></li>
<li><a href="#caixas-de-sele%C3%A7%C3%A3o-select-boxes-com-objetos-model">Caixas de Seleção (<em>Select Boxes</em>) com Objetos <em>Model</em></a></li>
<li><a href="#fuso-hor%C3%A1rio-e-sele%C3%A7%C3%A3o-de-pa%C3%ADs">Fuso horário e Seleção de País</a></li>
</ul>
</li>
<li>
<a href="#usando-form-helpers-para-data-e-hora">Usando <em>Form Helpers</em> para Data e Hora</a>

<ul>
<li><a href="#caixas-de-sele%C3%A7%C3%A3o-select-boxes-para-componentes-individuais-de-tempo">Caixas de Seleção (<em>Select Boxes</em>) para Componentes Individuais de Tempo</a></li>
</ul>
</li>
<li>
<a href="#escolhas-a-partir-de-uma-cole%C3%A7%C3%A3o-de-objetos-arbitr%C3%A1rios">Escolhas a partir de uma Coleção de Objetos Arbitrários</a>

<ul>
<li><a href="#o-auxiliar-collection-select">O auxiliar <code>collection_select</code></a></li>
<li><a href="#o-auxiliar-collection-radio-buttons">O auxiliar <code>collection_radio_buttons</code></a></li>
<li><a href="#o-auxiliar-collection-check-boxes">O auxiliar <code>collection_check_boxes</code></a></li>
</ul>
</li>
<li>
<a href="#enviando-arquivos">Enviando Arquivos</a>

<ul>
<li><a href="#o-que-%C3%A9-enviado">O que é enviado</a></li>
</ul>
</li>
<li><a href="#customizando-os-construtores-de-formul%C3%A1rios">Customizando os Construtores de Formulários</a></li>
<li>
<a href="#entendendo-conven%C3%A7%C3%B5es-de-nomea%C3%A7%C3%A3o-de-par%C3%A2metros">Entendendo Convenções de Nomeação de Parâmetros</a>

<ul>
<li><a href="#estruturas-b%C3%A1sicas">Estruturas Básicas</a></li>
<li><a href="#combinando-os-conceitos">Combinando os Conceitos</a></li>
<li><a href="#utilizando-o-auxiliar-fields-for-com-a-op%C3%A7%C3%A3o-index">Utilizando o auxiliar <code>fields_for</code> com a opção <code>:index</code></a></li>
</ul>
</li>
<li><a href="#formul%C3%A1rios-para-recursos-externos">Formulários para Recursos Externos</a></li>
<li>
<a href="#trabalhando-com-formul%C3%A1rios-complexos">Trabalhando com Formulários Complexos</a>

<ul>
<li><a href="#configurando-o-model">Configurando o <em>Model</em></a></li>
<li><a href="#formul%C3%A1rios-aninhados">Formulários Aninhados</a></li>
<li><a href="#o-controller">O <em>Controller</em></a></li>
<li><a href="#removendo-objetos">Removendo objetos</a></li>
<li><a href="#prevenindo-registros-vazios">Prevenindo Registros Vazios</a></li>
<li><a href="#adicionando-campos-dinamicamente">Adicionando campos dinamicamente</a></li>
</ul>
</li>
<li><a href="#utilizando-tags-auxiliares-tag-helpers-sem-um-construtor-de-formul%C3%A1rio">Utilizando Tags Auxiliares (<em>Tag Helpers</em>) Sem Um Construtor de Formulário</a></li>
<li><a href="#usando-form-for-e-form-tag">Usando <code>form_for</code> e <code>form_tag</code></a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <div class="note"><p>Este guia não pretende ser uma documentação completa dos métodos auxiliares de formulários (<em>form helpers</em>) disponíveis e seus argumentos. Por favor para obter uma  referência completa visite <a href="https://api.rubyonrails.org/v7.0.8/">a documentação da API do Rails</a>.</p></div><h3 id="trabalhando-com-formulários-básicos"><a class="anchorlink" href="#trabalhando-com-formul%C3%A1rios-b%C3%A1sicos">1 Trabalhando com formulários básicos.</a></h3><p>O principal auxiliar de formulário (<em>form helper</em>) é o <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormHelper.html#method-i-form_with"><code>form_with</code></a>.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  Conteúdo do formulário
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with do |form| %&gt;
  Conteúdo do formulário
&lt;% end %&gt;
">Copy</button>
</div>
<p>Quando chamado sem nenhum argumento como este, é criado uma <em>tag</em> de formulário que, quando enviado, fará uma requisição HTTP usando o verbo POST para a página atual. Por exemplo, supondo que a página atual seja a inicial, o HTML gerado terá a seguinte aparência:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"J7CBxfHalt49OSHp27hblqK20c9PgwJ108nDHX/8Cts="</span> <span class="nt">/&gt;</span>
  Form contents
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form accept-charset="UTF-8" action="/" method="post"&gt;
  &lt;input name="authenticity_token" type="hidden" value="J7CBxfHalt49OSHp27hblqK20c9PgwJ108nDHX/8Cts=" /&gt;
  Form contents
&lt;/form&gt;
'>Copy</button>
</div>
<p>Note que o HTML contém um elemento <code>input</code> do tipo <code>hidden</code>. Este <code>input</code> é importante porque os formulários não podem ser enviados com sucesso sem ele, exceto formulários com método GET. Esse elemento oculto com o nome <code>authenticity_token</code> é um recurso de segurança do Rails chamado <strong>proteção contra falsificação de solicitação entre sites</strong> (<a href="https://pt.wikipedia.org/wiki/Cross-site_request_forgery"><strong>cross-site request forgery protection</strong></a>), e os <em>helpers</em> de formulário o geram para todos os formulários não GET (desde que esse recurso de segurança esteja ativado). Você poderá ler mais sobre isso no guia <a href="security.html#cross-site-request-forgery-csrf">Segurança em Aplicações Rails</a>.</p><h4 id="formulário-de-pesquisa-genérica"><a class="anchorlink" href="#formul%C3%A1rio-de-pesquisa-gen%C3%A9rica">1.1 Formulário de pesquisa genérica</a></h4><p>Um dos formulários mais básicos que você vê na web é um formulário de pesquisa. Este formulário contém:</p>
<ul>
<li>Um <em>input</em> de formulário com o método GET.</li>
<li>Um <em>label</em> para entrada.</li>
<li>Um <em>input</em> de entrada de texto.</li>
<li>Um <em>input</em> de envio.</li>
</ul>
<p>Para criar este formulário você usará <code>form_with</code> e o objeto para contrução de formulário que o método nos dá. Como o exemplo abaixo:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/search"</span><span class="p">,</span> <span class="ss">method: :get</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:query</span><span class="p">,</span> <span class="s2">"Search for:"</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:query</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="s2">"Search"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with url: "/search", method: :get do |form| %&gt;
  &lt;%= form.label :query, "Search for:" %&gt;
  &lt;%= form.text_field :query %&gt;
  &lt;%= form.submit "Search" %&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
<p>Isso irá gerar o seguinte HTML:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/search"</span> <span class="na">method=</span><span class="s">"get"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"query"</span><span class="nt">&gt;</span>Search for:<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"query"</span> <span class="na">name=</span><span class="s">"query"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Search"</span> <span class="na">data-disable-with=</span><span class="s">"Search"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form action="/search" method="get" accept-charset="UTF-8" &gt;
  &lt;label for="query"&gt;Search for:&lt;/label&gt;
  &lt;input id="query" name="query" type="text" /&gt;
  &lt;input name="commit" type="submit" value="Search" data-disable-with="Search" /&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<div class="info"><p>Passando <code>url: my_speccified_path</code> para <code>form_with</code> indica ao formulário onde fazer a requisição. No entanto, conforme explicado abaixo, você também pode passar objetos Active Record para o formulário.</p></div><div class="info"><p>Para cada entrada de formulário, um atributo ID é gerado a partir de seu nome ("query" no exemplo acima). Esses IDs podem ser muito úteis para estilizar CSS ou manipular controles de formulário com JavaScript.</p></div><div class="warning"><p>Use "GET" como o método para buscas em formulários. Isso permitirá aos usuários marcar uma busca específica e depois retornar nessa mesma busca. De forma geral, o Rails recomenda que você utilize o verbo correto para a ação desejada.</p></div><h4 id="helpers-para-gerar-elementos-de-formulário"><a class="anchorlink" href="#helpers-para-gerar-elementos-de-formul%C3%A1rio">1.2 Helpers para gerar elementos de formulário</a></h4><p>O objeto construtor de formulário gerado pelo <code>form_with</code> fornece vários métodos auxiliares para gerar elementos de formulário, como campos de texto, caixas de seleção (<em>checkboxes</em>) e botões de rádio (<em>radio buttons</em>). O primeiro parâmetro para esses métodos é sempre o nome do <em>input</em>. Quando o formulário for enviado, o nome será passado junto com os dados do formulário e será direcionado para <code>params</code> o controlador com o valor inserido pelo usuário para esse campo. Por exemplo, se o formulário contiver <code>&lt;%= form.text_field :query %&gt;</code>, podendo obter o valor deste campo no controlador com <code>params[:query]</code> .</p><p>Ao nomear entradas, o Rails usa certas convenções que possibilitam enviar parâmetros com valores não escalares, como matrizes ou hashes, que também estarão acessíveis <code>params</code>. Poderá ser lido mais sobre eles no capítulo <a href="#entendendo-convencoes-de-nomeacao-de-parametros">Noções básicas sobre convenções de nomenclatura de parâmetros</a> deste guia. Para detalhes de como usar com precisão esses auxiliares, consulte a <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormTagHelper.html">documentação da API</a>.</p><h5 id="checkboxes-caixas-de-seleção"><a class="anchorlink" href="#checkboxes-caixas-de-sele%C3%A7%C3%A3o">1.2.1 <em>Checkboxes</em> Caixas de seleção</a></h5><p>As caixas de seleção são controles de formulário que fornecem ao usuário um conjunto de opções que podem ser ativados ou desativados pelo usuário.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">check_box</span> <span class="ss">:pet_dog</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:pet_dog</span><span class="p">,</span> <span class="s2">"I own a dog"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">check_box</span> <span class="ss">:pet_cat</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:pet_cat</span><span class="p">,</span> <span class="s2">"I own a cat"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.check_box :pet_dog %&gt;
&lt;%= form.label :pet_dog, "I own a dog" %&gt;
&lt;%= form.check_box :pet_cat %&gt;
&lt;%= form.label :pet_cat, "I own a cat" %&gt;
'>Copy</button>
</div>
<p>Isso gera o seguinte:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">id=</span><span class="s">"pet_dog"</span> <span class="na">name=</span><span class="s">"pet_dog"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"pet_dog"</span><span class="nt">&gt;</span>I own a dog<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">id=</span><span class="s">"pet_cat"</span> <span class="na">name=</span><span class="s">"pet_cat"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"pet_cat"</span><span class="nt">&gt;</span>I own a cat<span class="nt">&lt;/label&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input type="checkbox" id="pet_dog" name="pet_dog" value="1" /&gt;
&lt;label for="pet_dog"&gt;I own a dog&lt;/label&gt;
&lt;input type="checkbox" id="pet_cat" name="pet_cat" value="1" /&gt;
&lt;label for="pet_cat"&gt;I own a cat&lt;/label&gt;
'>Copy</button>
</div>
<p>O primeiro parâmetro para <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-check_box"><code>check_box</code></a>, é o nome da entrada. o valor da checkbox (valor que vai aparecer no <code>params</code>) pode ser especificado pelo terceiro e quarto parâmetros. Veja a documentação da API para detalhes.</p><h5 id="radio-buttons-botões-de-opção"><a class="anchorlink" href="#radio-buttons-bot%C3%B5es-de-op%C3%A7%C3%A3o">1.2.2 <em>Radio Buttons</em> Botões de opção</a></h5><p>Os botões de opção embora semelhantes às caixas de seleção, são controles que especificam um conjunto de opções mutuamente exclusivos (ou seja, o usuário pode escolher apenas uma).</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">radio_button</span> <span class="ss">:age</span><span class="p">,</span> <span class="s2">"child"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:age_child</span><span class="p">,</span> <span class="s2">"I am younger than 21"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">radio_button</span> <span class="ss">:age</span><span class="p">,</span> <span class="s2">"adult"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:age_adult</span><span class="p">,</span> <span class="s2">"I am over 21"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.radio_button :age, "child" %&gt;
&lt;%= form.label :age_child, "I am younger than 21" %&gt;
&lt;%= form.radio_button :age, "adult" %&gt;
&lt;%= form.label :age_adult, "I am over 21" %&gt;
'>Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">id=</span><span class="s">"age_child"</span> <span class="na">name=</span><span class="s">"age"</span> <span class="na">value=</span><span class="s">"child"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"age_child"</span><span class="nt">&gt;</span>I am younger than 21<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">id=</span><span class="s">"age_adult"</span> <span class="na">name=</span><span class="s">"age"</span> <span class="na">value=</span><span class="s">"adult"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"age_adult"</span><span class="nt">&gt;</span>I am over 21<span class="nt">&lt;/label&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input type="radio" id="age_child" name="age" value="child" /&gt;
&lt;label for="age_child"&gt;I am younger than 21&lt;/label&gt;
&lt;input type="radio" id="age_adult" name="age" value="adult" /&gt;
&lt;label for="age_adult"&gt;I am over 21&lt;/label&gt;
'>Copy</button>
</div>
<p>O segundo parâmetro para <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-radio_button"><code>radio_button</code></a> é o valor da entrada. Como esses dois botões compartilham o mesmo nome (<code>age</code>), o usuário poderá selecionar apenas um deles, e <code>params[:age]</code> receberá <code>"child"</code> ou <code>"adult"</code>.</p><div class="note"><p>Sempre use <em>labels</em> para a caixa de seleção e botões de opção. Eles associam o texto a uma opção específica e, ao expandir a região clicável, facilita o clique dos usuários nas entradas.</p></div><h4 id="outros-auxiliares-interessantes"><a class="anchorlink" href="#outros-auxiliares-interessantes">1.3 Outros auxiliares interessantes</a></h4><p>Outros controles de formulários que valem a pena falar são áreas de texto, campos ocultos, campos de senha, campos de número, campos de data e hora e muitos outros:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_area</span> <span class="ss">:message</span><span class="p">,</span> <span class="ss">size: </span><span class="s2">"70x5"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">hidden_field</span> <span class="ss">:parent_id</span><span class="p">,</span> <span class="ss">value: </span><span class="s2">"foo"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">password_field</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">number_field</span> <span class="ss">:price</span><span class="p">,</span> <span class="ss">in: </span><span class="mf">1.0</span><span class="o">..</span><span class="mf">20.0</span><span class="p">,</span> <span class="ss">step: </span><span class="mf">0.5</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">range_field</span> <span class="ss">:discount</span><span class="p">,</span> <span class="ss">in: </span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">date_field</span> <span class="ss">:born_on</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">time_field</span> <span class="ss">:started_at</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">datetime_local_field</span> <span class="ss">:graduation_day</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">month_field</span> <span class="ss">:birthday_month</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">week_field</span> <span class="ss">:birthday_week</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">search_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">email_field</span> <span class="ss">:address</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">telephone_field</span> <span class="ss">:phone</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">url_field</span> <span class="ss">:homepage</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">color_field</span> <span class="ss">:favorite_color</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.text_area :message, size: "70x5" %&gt;
&lt;%= form.hidden_field :parent_id, value: "foo" %&gt;
&lt;%= form.password_field :password %&gt;
&lt;%= form.number_field :price, in: 1.0..20.0, step: 0.5 %&gt;
&lt;%= form.range_field :discount, in: 1..100 %&gt;
&lt;%= form.date_field :born_on %&gt;
&lt;%= form.time_field :started_at %&gt;
&lt;%= form.datetime_local_field :graduation_day %&gt;
&lt;%= form.month_field :birthday_month %&gt;
&lt;%= form.week_field :birthday_week %&gt;
&lt;%= form.search_field :name %&gt;
&lt;%= form.email_field :address %&gt;
&lt;%= form.telephone_field :phone %&gt;
&lt;%= form.url_field :homepage %&gt;
&lt;%= form.color_field :favorite_color %&gt;
'>Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"message"</span> <span class="na">id=</span><span class="s">"message"</span> <span class="na">cols=</span><span class="s">"70"</span> <span class="na">rows=</span><span class="s">"5"</span><span class="nt">&gt;&lt;/textarea&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"parent_id"</span> <span class="na">id=</span><span class="s">"parent_id"</span> <span class="na">value=</span><span class="s">"foo"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">id=</span><span class="s">"password"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"number"</span> <span class="na">name=</span><span class="s">"price"</span> <span class="na">id=</span><span class="s">"price"</span> <span class="na">step=</span><span class="s">"0.5"</span> <span class="na">min=</span><span class="s">"1.0"</span> <span class="na">max=</span><span class="s">"20.0"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"range"</span> <span class="na">name=</span><span class="s">"discount"</span> <span class="na">id=</span><span class="s">"discount"</span> <span class="na">min=</span><span class="s">"1"</span> <span class="na">max=</span><span class="s">"100"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"date"</span> <span class="na">name=</span><span class="s">"born_on"</span> <span class="na">id=</span><span class="s">"born_on"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"time"</span> <span class="na">name=</span><span class="s">"started_at"</span> <span class="na">id=</span><span class="s">"started_at"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"datetime-local"</span> <span class="na">name=</span><span class="s">"graduation_day"</span> <span class="na">id=</span><span class="s">"graduation_day"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"month"</span> <span class="na">name=</span><span class="s">"birthday_month"</span> <span class="na">id=</span><span class="s">"birthday_month"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"week"</span> <span class="na">name=</span><span class="s">"birthday_week"</span> <span class="na">id=</span><span class="s">"birthday_week"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"address"</span> <span class="na">id=</span><span class="s">"address"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"tel"</span> <span class="na">name=</span><span class="s">"phone"</span> <span class="na">id=</span><span class="s">"phone"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"url"</span> <span class="na">name=</span><span class="s">"homepage"</span> <span class="na">id=</span><span class="s">"homepage"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"color"</span> <span class="na">name=</span><span class="s">"favorite_color"</span> <span class="na">id=</span><span class="s">"favorite_color"</span> <span class="na">value=</span><span class="s">"#000000"</span> <span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;textarea name="message" id="message" cols="70" rows="5"&gt;&lt;/textarea&gt;
&lt;input type="hidden" name="parent_id" id="parent_id" value="foo" /&gt;
&lt;input type="password" name="password" id="password" /&gt;
&lt;input type="number" name="price" id="price" step="0.5" min="1.0" max="20.0" /&gt;
&lt;input type="range" name="discount" id="discount" min="1" max="100" /&gt;
&lt;input type="date" name="born_on" id="born_on" /&gt;
&lt;input type="time" name="started_at" id="started_at" /&gt;
&lt;input type="datetime-local" name="graduation_day" id="graduation_day" /&gt;
&lt;input type="month" name="birthday_month" id="birthday_month" /&gt;
&lt;input type="week" name="birthday_week" id="birthday_week" /&gt;
&lt;input type="search" name="name" id="name" /&gt;
&lt;input type="email" name="address" id="address" /&gt;
&lt;input type="tel" name="phone" id="phone" /&gt;
&lt;input type="url" name="homepage" id="homepage" /&gt;
&lt;input type="color" name="favorite_color" id="favorite_color" value="#000000" /&gt;
'>Copy</button>
</div>
<p>Entradas ocultas não são exibidas ao usuário, mas retêm dados como qualquer entrada de texto. Os valores dentro deles podem ser alterados com JavaScript.</p><div class="warning"><p>As entradas de pesquisa, telefone, data, hora, cor, data e hora local e data, mês, semana, URL, email, número e intervalo são controles HTML5. Se você precisar que sua aplicação tenha uma experiência consistente em navegadores antigos, precisará de um polyfill HTML5 (fornecido por css e/ou JavaScript). Definiticamente, <a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills">não faltam soluções disponíveis</a>, embora uma ferramenta popular no momento seja o <a href="https://modernizr.com/">Modernizr</a>, que fornece uma maneira simples de adicionar funcionalidade com base na presença de recursos HTML5 detectados.</p></div><div class="info"><p>Se você estiver usando campos de entradas de senha (para qualquer finalidade), convêm configurar sua aplicação para impedir que esses parâmetros sejam registrados. Você pode aprender sobre este assunto no guia <a href="security.html#logging">Protegendo aplicações Rails</a></p></div><h3 id="trabalhando-com-objetos-model"><a class="anchorlink" href="#trabalhando-com-objetos-model">2 Trabalhando com Objetos <em>Model</em></a></h3><h4 id="vinculando-um-formulário-a-um-objeto"><a class="anchorlink" href="#vinculando-um-formul%C3%A1rio-a-um-objeto">2.1 Vinculando um Formulário a um Objeto</a></h4><p>O argumento <code>:model</code> do <code>form_with</code> nos permite ligar o objeto construtor de um formulário a um objeto <em>model</em>. Isso significa que o escopo do formulário será aquele objeto <em>model</em> e os campos do formulário serão preenchidos com valores desse objeto.</p><p>Por exemplo, se temos um objeto <em>model</em> como <code>@article</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="vi">@article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># =&gt; #&lt;Article id: 42, title: "My Title", body: "My Body"&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='@article = Article.find(42)
# =&gt; #&lt;Article id: 42, title: "My Title", body: "My Body"&gt;
'>Copy</button>
</div>
<p>O seguinte formulário:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@article</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_area</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">size: </span><span class="s2">"60x10"</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with model: @article do |form| %&gt;
  &lt;%= form.text_field :title %&gt;
  &lt;%= form.text_area :body, size: "60x10" %&gt;
  &lt;%= form.submit %&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
<p>Cria o seguinte código:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/articles/42"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"..."</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"article[title]"</span> <span class="na">id=</span><span class="s">"article_title"</span> <span class="na">value=</span><span class="s">"My Title"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"article[body]"</span> <span class="na">id=</span><span class="s">"article_body"</span> <span class="na">cols=</span><span class="s">"60"</span> <span class="na">rows=</span><span class="s">"10"</span><span class="nt">&gt;</span>
    My Body
  <span class="nt">&lt;/textarea&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Update Article"</span> <span class="na">data-disable-with=</span><span class="s">"Update Article"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form action="/articles/42" method="post" accept-charset="UTF-8" &gt;
  &lt;input name="authenticity_token" type="hidden" value="..." /&gt;
  &lt;input type="text" name="article[title]" id="article_title" value="My Title" /&gt;
  &lt;textarea name="article[body]" id="article_body" cols="60" rows="10"&gt;
    My Body
  &lt;/textarea&gt;
  &lt;input type="submit" name="commit" value="Update Article" data-disable-with="Update Article"&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<p>Estas são algumas coisas a serem observadas aqui:</p>
<ul>
<li>A <code>action</code> do formulário é automaticamente preenchida com um valor apropriado para <code>@article</code>.</li>
<li>Os campos do formulário são preenchidos automaticamente com os valores correspondentes do <code>@article</code>.</li>
<li>Os nomes dos campos do formulário têm como escopo <code>article[...]</code>. Isso significa que <code>params[:article]</code> será um <em>hash</em> contendo todos os valores desses campos. Você pode ler mais sobre a importância dos nomes de entradas no capítulo <a href="#entendendo-convencoes-de-nomeacao-de-parametros">Entendendo as Convenções de Nomeação de Parâmetros</a> deste guia.</li>
<li>O botão de envio (<em>submit</em>) recebe automaticamente um valor de texto apropriado.</li>
</ul>
<div class="info"><p>Convencionalmente, suas entradas espelharão os atributos do <em>model</em>. No entanto, eles não precisam! Se houver outras informações de que você precisa, você pode incluí-las em seu formulário da mesma forma que os atributos e acessá-las via <code>params[:article][:my_nifty_non_attribute_input]</code>.</p></div><h5 id="o-auxiliar-fields-for"><a class="anchorlink" href="#o-auxiliar-fields-for">2.1.1 O auxiliar <code>fields_for</code></a></h5><p>The <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-fields_for"><code>fields_for</code></a> helper creates a similar binding but without rendering a
<code>&lt;form&gt;</code> tag. This can be used to render fields for additional model objects
within the same form. For example, if you had a <code>Person</code> model with an
associated <code>ContactDetail</code> model, you could create a single form for both like
so:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">person_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">fields_for</span> <span class="ss">:contact_detail</span><span class="p">,</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">contact_detail</span> <span class="k">do</span> <span class="o">|</span><span class="n">contact_detail_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">contact_detail_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:phone_number</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |person_form| %&gt;
  &lt;%= person_form.text_field :name %&gt;
  &lt;%= fields_for :contact_detail, @person.contact_detail do |contact_detail_form| %&gt;
    &lt;%= contact_detail_form.text_field :phone_number %&gt;
  &lt;% end %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Que produz a seguinte saída:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/people"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"bL13x72pldyDD8bgtkjKQakJCpd4A8JdXGbfksxBDHdf1uC0kCMqe2tvVdUYfidJt0fj3ihC4NxiVHv8GVYxJA=="</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"contact_detail[phone_number]"</span> <span class="na">id=</span><span class="s">"contact_detail_phone_number"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form action="/people" accept-charset="UTF-8" method="post"&gt;
  &lt;input type="hidden" name="authenticity_token" value="bL13x72pldyDD8bgtkjKQakJCpd4A8JdXGbfksxBDHdf1uC0kCMqe2tvVdUYfidJt0fj3ihC4NxiVHv8GVYxJA==" /&gt;
  &lt;input type="text" name="person[name]" id="person_name" /&gt;
  &lt;input type="text" name="contact_detail[phone_number]" id="contact_detail_phone_number" /&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<p>O objeto produzido por <code>fields_for</code> é um construtor de formulário igual ao produzido por
<code>form_with</code>.</p><h4 id="confiando-na-identificação-de-registro"><a class="anchorlink" href="#confiando-na-identifica%C3%A7%C3%A3o-de-registro">2.2 Confiando na Identificação de Registro</a></h4><p>O <em>model</em> Article está disponível para os usuários da aplicação, portanto - seguindo as melhores praticas para desenvolvimento com Rails - você deve declará-lo <strong>um recurso (<em>resource</em>)</strong>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">resources</span> <span class="ss">:articles</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="resources :articles
">Copy</button>
</div>
<div class="info"><p>Declarar um recurso tem vários efeitos colaterais. Consulte <a href="routing.html#roteando-resources-recursos-o-padrao-do-rails">o guia Rotas do Rails de Fora pra Dentro</a> para obter mais informações como configurar e usar recursos.</p></div><p>Ao lidar com recursos RESTful, as chamadas de <code>form_with</code> ficam significativamente mais fáceis se você contar com a <strong>identificação de registros</strong>. Resumindo, você pode apenas passar a instância do modelo e fazer com que o Rails descubra o nome do modelo e o resto. Em ambos os exemplos, o estilo longo e curto têm o mesmo resultado:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="c1">## Creating a new article</span>
<span class="c1"># long-style:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">,</span> <span class="ss">url: </span><span class="n">articles_path</span><span class="p">)</span>
<span class="c1"># short-style:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">)</span>

<span class="c1">## Editing an existing article</span>
<span class="c1"># long-style:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">,</span> <span class="ss">url: </span><span class="n">article_path</span><span class="p">(</span><span class="vi">@article</span><span class="p">),</span> <span class="ss">method: </span><span class="s2">"patch"</span><span class="p">)</span>
<span class="c1"># short-style:</span>
<span class="n">form_with</span><span class="p">(</span><span class="ss">model: </span><span class="vi">@article</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='## Creating a new article
# long-style:
form_with(model: @article, url: articles_path)
# short-style:
form_with(model: @article)

## Editing an existing article
# long-style:
form_with(model: @article, url: article_path(@article), method: "patch")
# short-style:
form_with(model: @article)
'>Copy</button>
</div>
<p>Observe como a chamada de estilo abreviado <code>form_with</code> é convenientemente a mesma, independentemente de o registro ser novo ou existente. A identificação de registros é inteligente o suficiente para descobrir se o registro é novo, chamando <code>record.persisted?</code>. Ele também seleciona o caminho correto para enviar e o nome com base na classe do objeto.</p><p>Se você tiver um <a href="routing.html#singular-resources">singular resource</a>, precisará chamar <code>resource</code> e <code>resolve</code> para que funcione com <code>form_with</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">resource</span> <span class="ss">:geocoder</span>
<span class="n">resolve</span><span class="p">(</span><span class="s1">'Geocoder'</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="ss">:geocoder</span><span class="p">]</span> <span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="resource :geocoder
resolve('Geocoder') { [:geocoder] }
">Copy</button>
</div>
<div class="warning"><p>Quando você está usando herança de tabela única (STI ou <em>single-table inheritance</em>) em seus objetos <em>model</em>, você não pode confiar na identificação de registro em uma subclasse se apenas sua classe pai for declarada um recurso. Você terá que especificar <code>:url</code>, e <code>:scope</code> (o nome do <em>model</em>) explicitamente.</p></div><h5 id="trabalhando-com-namespaces"><a class="anchorlink" href="#trabalhando-com-namespaces">2.2.1 Trabalhando com <em>Namespaces</em></a></h5><p>Se você criou rotas com <em>namespaces</em>, <code>form_with</code> tem uma abreviatura bacana para isso também. Se o seu aplicativo tiver um <em>namespace</em> de administrador,</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">form_with</span> <span class="ss">model: </span><span class="p">[</span><span class="ss">:admin</span><span class="p">,</span> <span class="vi">@article</span><span class="p">]</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="form_with model: [:admin, @article]
">Copy</button>
</div>
<p>irá criar um formulário que submete ao <code>ArticlesController</code> dentro do <em>namespace</em> do administrador (submetendo a <code>admin_article_path(@article)</code> no caso de uma atualização). Se você tiver vários níveis de <em>namespacing</em>, a sintaxe será semelhante:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">form_with</span> <span class="ss">model: </span><span class="p">[</span><span class="ss">:admin</span><span class="p">,</span> <span class="ss">:management</span><span class="p">,</span> <span class="vi">@article</span><span class="p">]</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="form_with model: [:admin, :management, @article]
">Copy</button>
</div>
<p>Para mais informações sobre o sistema de roteamento Rails e as convenções associadas, consulte o <a href="routing.html">guia Rotas do Rails de Fora pra Dentro</a>.</p><h4 id="como-os-formulários-funcionam-com-os-métodos-patch-put-ou-delete-questionmark"><a class="anchorlink" href="#como-os-formul%C3%A1rios-funcionam-com-os-m%C3%A9todos-patch-put-ou-delete-questionmark">2.3 Como os formulários funcionam com os métodos <em>PATCH</em>, <em>PUT</em>, ou <em>DELETE</em>?</a></h4><p>O <em>framework</em> Rails  incentiva o design <em>RESTful</em> de seus aplicativos, o que significa que você fará muitas requisições <em>"PATCH"</em>, <em>"PUT"</em>, e <em>"DELETE"</em> (além de <em>"GET"</em> e <em>"POST"</em>). Entretanto, a maioria dos navegadores <em>não suportam</em> métodos diferentes de <em>"GET"</em> e <em>"POST"</em> quando se trata de envio de formulários.</p><p>O Rails contorna esse problema emulando outros métodos no <em>POST</em> com uma entrada oculta <code>"_method"</code>, que é definida para refletir o método desejado:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">form_with</span><span class="p">(</span><span class="ss">url: </span><span class="n">search_path</span><span class="p">,</span> <span class="ss">method: </span><span class="s2">"patch"</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='form_with(url: search_path, method: "patch")
'>Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/search"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"f755bb0ed134b76c432144748a6d4b7a7ddf2b71"</span> <span class="nt">/&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form accept-charset="UTF-8" action="/search" method="post"&gt;
  &lt;input name="_method" type="hidden" value="patch" /&gt;
  &lt;input name="authenticity_token" type="hidden" value="f755bb0ed134b76c432144748a6d4b7a7ddf2b71" /&gt;
  &lt;!-- ... --&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<p>Ao analisar os dados submetidos pelo <em>POST</em>, o Rails levará em consideração o parâmetro especial <code>_method</code> e agirá como se o método HTTP fosse aquele especificado dentro dele (<em>"PATCH"</em> nesse exemplo).</p><p>Ao renderizar um formulário, os botões de envio podem substituir o atributo <code>method</code> declarado através da palavra-chave <code>formmethod:</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/posts/1"</span><span class="p">,</span> <span class="ss">method: :patch</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">button</span> <span class="s2">"Delete"</span><span class="p">,</span> <span class="ss">formmethod: :delete</span><span class="p">,</span> <span class="ss">data: </span><span class="p">{</span> <span class="ss">confirm: </span><span class="s2">"Are you sure?"</span> <span class="p">}</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">button</span> <span class="s2">"Update"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with url: "/posts/1", method: :patch do |form| %&gt;
  &lt;%= form.button "Delete", formmethod: :delete, data: { confirm: "Are you sure?" } %&gt;
  &lt;%= form.button "Update" %&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
<p>Semelhante aos elementos <code>&lt;form&gt;</code>, a maioria dos navegadores <em>não suporta</em> métodos de substituição de formulário declarados por meio de <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-formmethod">formmethod</a> diferentes de "GET" e "POST".</p><p>O Rails resolve esse problema emulando outros métodos via POST por meio de uma combinação dos atributos <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-formmethod">formmethod</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-value">value</a> e <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#attr-name">name</a>:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/posts/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"f755bb0ed134b76c432144748a6d4b7a7ddf2b71"</span> <span class="nt">/&gt;</span>
  <span class="c">&lt;!-- ... --&gt;</span>

  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">formmethod=</span><span class="s">"post"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"delete"</span> <span class="na">data-confirm=</span><span class="s">"Are you sure?"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"button"</span><span class="nt">&gt;</span>Update<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form accept-charset="UTF-8" action="/posts/1" method="post"&gt;
  &lt;input name="_method" type="hidden" value="patch" /&gt;
  &lt;input name="authenticity_token" type="hidden" value="f755bb0ed134b76c432144748a6d4b7a7ddf2b71" /&gt;
  &lt;!-- ... --&gt;

  &lt;button type="submit" formmethod="post" name="_method" value="delete" data-confirm="Are you sure?"&gt;Delete&lt;/button&gt;
  &lt;button type="submit" name="button"&gt;Update&lt;/button&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<div class="warning"><p>No Rails 6.0 e 5.2, todos os formulários usando <code>form_with</code> implementam <code>remote: true</code> por padrão. Esses formulários enviarão dados usando requisições XHR (<em>Ajax</em>). Para desabilitar isso, inclua <code>local: true</code>. Para se aprofundar, veja o guia <a href="working_with_javascript_in_rails.html#elementos-remotos">Trabalhando com JavaScript no Rails</a>.</p></div><h3 id="criando-caixas-de-seleção-select-boxes-com-facilidade"><a class="anchorlink" href="#criando-caixas-de-sele%C3%A7%C3%A3o-select-boxes-com-facilidade">3 Criando Caixas de Seleção (<em>Select Boxes</em>) com Facilidade</a></h3><p>As caixas de seleção em HTML requerem uma quantidade significativa de marcação, um elemento <code>&lt;option&gt;</code> para cada opção de escolha. Então o Rails provê métodos auxiliares para reduzir esse fardo.</p><p>Por exemplo, digamos que temos uma lista de cidades para o usuário escolher. Podemos usar o auxiliar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-select"><code>select</code></a> assim:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"Madrid"</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.select :city, ["Berlin", "Chicago", "Madrid"] %&gt;
'>Copy</button>
</div>
<p>que gera:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Berlin"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Chicago"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"Madrid"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="city" id="city"&gt;
  &lt;option value="Berlin"&gt;Berlin&lt;/option&gt;
  &lt;option value="Chicago"&gt;Chicago&lt;/option&gt;
  &lt;option value="Madrid"&gt;Madrid&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<p>Também podemos designar valores para <code>&lt;option&gt;</code> que diferem de seus rótulos:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]]</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.select :city, [["Berlin", "BE"], ["Chicago", "CHI"], ["Madrid", "MD"]] %&gt;
'>Copy</button>
</div>
<p>que gera:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="city" id="city"&gt;
  &lt;option value="BE"&gt;Berlin&lt;/option&gt;
  &lt;option value="CHI"&gt;Chicago&lt;/option&gt;
  &lt;option value="MD"&gt;Madrid&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<p>Desta forma, o usuário verá o nome completo da cidade, mas <code>params[: city]</code> será um dos tipos <code>"BE"</code>, <code>"CHI"</code> ou <code>"MD"</code>.</p><p>Por último, podemos especificar uma escolha padrão para a caixa de seleção com o argumento <code>:selected</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]],</span> <span class="ss">selected: </span><span class="s2">"CHI"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.select :city, [["Berlin", "BE"], ["Chicago", "CHI"], ["Madrid", "MD"]], selected: "CHI" %&gt;
'>Copy</button>
</div>
<p>que gera:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="city" id="city"&gt;
  &lt;option value="BE"&gt;Berlin&lt;/option&gt;
  &lt;option value="CHI" selected="selected"&gt;Chicago&lt;/option&gt;
  &lt;option value="MD"&gt;Madrid&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<h4 id="grupos-de-opção"><a class="anchorlink" href="#grupos-de-op%C3%A7%C3%A3o">3.1 Grupos de Opção</a></h4><p>Em alguns casos, podemos querer melhorar a experiência do usuário agrupando opções relacionadas. Podemos fazer isso passando um <code>Hash</code> (ou <code>Array</code> compatível) para <code>select</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="s2">"Europe"</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="p">[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]</span> <span class="p">],</span>
        <span class="s2">"North America"</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">]</span> <span class="p">],</span>
      <span class="p">},</span>
      <span class="ss">selected: </span><span class="s2">"CHI"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form.select :city,
      {
        "Europe" =&gt; [ ["Berlin", "BE"], ["Madrid", "MD"] ],
        "North America" =&gt; [ ["Chicago", "CHI"] ],
      },
      selected: "CHI" %&gt;
'>Copy</button>
</div>
<p>que gera:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"city"</span> <span class="na">id=</span><span class="s">"city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">"Europe"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;/optgroup&gt;</span>
  <span class="nt">&lt;optgroup</span> <span class="na">label=</span><span class="s">"North America"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;/optgroup&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="city" id="city"&gt;
  &lt;optgroup label="Europe"&gt;
    &lt;option value="BE"&gt;Berlin&lt;/option&gt;
    &lt;option value="MD"&gt;Madrid&lt;/option&gt;
  &lt;/optgroup&gt;
  &lt;optgroup label="North America"&gt;
    &lt;option value="CHI" selected="selected"&gt;Chicago&lt;/option&gt;
  &lt;/optgroup&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<h4 id="caixas-de-seleção-select-boxes-com-objetos-model"><a class="anchorlink" href="#caixas-de-sele%C3%A7%C3%A3o-select-boxes-com-objetos-model">3.2 Caixas de Seleção (<em>Select Boxes</em>) com Objetos <em>Model</em></a></h4><p>Como outros formulários, uma caixa de seleção pode ser associada a um atributo de <em>model</em>. Por exemplo, se tivermos um objeto <em>model</em> <code>@person</code> como:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">city: </span><span class="s2">"MD"</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='@person = Person.new(city: "MD")
'>Copy</button>
</div>
<p>O seguinte formulário:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city</span><span class="p">,</span> <span class="p">[[</span><span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"BE"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Chicago"</span><span class="p">,</span> <span class="s2">"CHI"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"Madrid"</span><span class="p">,</span> <span class="s2">"MD"</span><span class="p">]]</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with model: @person do |form| %&gt;
  &lt;%= form.select :city, [["Berlin", "BE"], ["Chicago", "CHI"], ["Madrid", "MD"]] %&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
<p>produz um resultado semelhante a:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[city]"</span> <span class="na">id=</span><span class="s">"person_city"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"BE"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"CHI"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"MD"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="person[city]" id="person_city"&gt;
  &lt;option value="BE"&gt;Berlin&lt;/option&gt;
  &lt;option value="CHI"&gt;Chicago&lt;/option&gt;
  &lt;option value="MD" selected="selected"&gt;Madrid&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<p>Observe que a opção apropriada foi marcada automaticamente como <code>selected=" selected"</code>. Visto que esta caixa de seleção estava ligada a um <em>model</em>, não precisamos especificar um argumento <code>:selected</code>!</p><h4 id="fuso-horário-e-seleção-de-país"><a class="anchorlink" href="#fuso-hor%C3%A1rio-e-sele%C3%A7%C3%A3o-de-pa%C3%ADs">3.3 Fuso horário e Seleção de País</a></h4><p>Para usar o suporte de fuso horário no Rails, você tem que perguntar aos seus usuários em que fuso horário eles estão. Fazer isso exigiria a geração de opções selecionadas de uma lista de objetos <em><a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveSupport/TimeZone.html"><code>ActiveSupport::TimeZone</code></a></em> usando <code>collection_select</code>, mas você pode simplesmente usar o <em>helper</em> <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-time_zone_select"><code>time_zone_select</code></a> que já resolve isto:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">time_zone_select</span> <span class="ss">:time_zone</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form.time_zone_select :time_zone %&gt;
">Copy</button>
</div>
<p>O Rails tinha um <em>helper</em> <code>country_select</code> para escolher os países, mas foi extraído para o <a href="https://github.com/stefanpenner/country_select">plugin country_select</a>.</p><h3 id="usando-form-helpers-para-data-e-hora"><a class="anchorlink" href="#usando-form-helpers-para-data-e-hora">4 Usando <em>Form Helpers</em> para Data e Hora</a></h3><p>Se você não deseja usar os <em>helpers</em> de formulário que geram campos de data e hora em HTML5, o Rails fornece <em>helpers</em> de data e hora alternativos que renderizam formulários em texto simples. Esses <em>helpers</em> renderizam uma caixa de seleção para cada componente de tempo (por exemplo, ano, mês, dia, etc.). Por exemplo, se tivermos um objeto de <em>model</em> <code>@person</code> como:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">birth_date: </span><span class="no">Date</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="@person = Person.new(birth_date: Date.new(1995, 12, 21))
">Copy</button>
</div>
<p>O seguinte formulário:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">date_select</span> <span class="ss">:birth_date</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  &lt;%= form.date_select :birth_date %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>vai gerar algo como:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(1i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_1i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1990"</span><span class="nt">&gt;</span>1990<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1991"</span><span class="nt">&gt;</span>1991<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1992"</span><span class="nt">&gt;</span>1992<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1993"</span><span class="nt">&gt;</span>1993<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1994"</span><span class="nt">&gt;</span>1994<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1995"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>1995<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1996"</span><span class="nt">&gt;</span>1996<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1997"</span><span class="nt">&gt;</span>1997<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1998"</span><span class="nt">&gt;</span>1998<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1999"</span><span class="nt">&gt;</span>1999<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2000"</span><span class="nt">&gt;</span>2000<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(2i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_2i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>January<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>February<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"3"</span><span class="nt">&gt;</span>March<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"4"</span><span class="nt">&gt;</span>April<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"5"</span><span class="nt">&gt;</span>May<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"6"</span><span class="nt">&gt;</span>June<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"7"</span><span class="nt">&gt;</span>July<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"8"</span><span class="nt">&gt;</span>August<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"9"</span><span class="nt">&gt;</span>September<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"10"</span><span class="nt">&gt;</span>October<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"11"</span><span class="nt">&gt;</span>November<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"12"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>December<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[birth_date(3i)]"</span> <span class="na">id=</span><span class="s">"person_birth_date_3i"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/option&gt;</span>
  ...
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"21"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>21<span class="nt">&lt;/option&gt;</span>
  ...
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"31"</span><span class="nt">&gt;</span>31<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="person[birth_date(1i)]" id="person_birth_date_1i"&gt;
  &lt;option value="1990"&gt;1990&lt;/option&gt;
  &lt;option value="1991"&gt;1991&lt;/option&gt;
  &lt;option value="1992"&gt;1992&lt;/option&gt;
  &lt;option value="1993"&gt;1993&lt;/option&gt;
  &lt;option value="1994"&gt;1994&lt;/option&gt;
  &lt;option value="1995" selected="selected"&gt;1995&lt;/option&gt;
  &lt;option value="1996"&gt;1996&lt;/option&gt;
  &lt;option value="1997"&gt;1997&lt;/option&gt;
  &lt;option value="1998"&gt;1998&lt;/option&gt;
  &lt;option value="1999"&gt;1999&lt;/option&gt;
  &lt;option value="2000"&gt;2000&lt;/option&gt;
&lt;/select&gt;
&lt;select name="person[birth_date(2i)]" id="person_birth_date_2i"&gt;
  &lt;option value="1"&gt;January&lt;/option&gt;
  &lt;option value="2"&gt;February&lt;/option&gt;
  &lt;option value="3"&gt;March&lt;/option&gt;
  &lt;option value="4"&gt;April&lt;/option&gt;
  &lt;option value="5"&gt;May&lt;/option&gt;
  &lt;option value="6"&gt;June&lt;/option&gt;
  &lt;option value="7"&gt;July&lt;/option&gt;
  &lt;option value="8"&gt;August&lt;/option&gt;
  &lt;option value="9"&gt;September&lt;/option&gt;
  &lt;option value="10"&gt;October&lt;/option&gt;
  &lt;option value="11"&gt;November&lt;/option&gt;
  &lt;option value="12" selected="selected"&gt;December&lt;/option&gt;
&lt;/select&gt;
&lt;select name="person[birth_date(3i)]" id="person_birth_date_3i"&gt;
  &lt;option value="1"&gt;1&lt;/option&gt;
  ...
  &lt;option value="21" selected="selected"&gt;21&lt;/option&gt;
  ...
  &lt;option value="31"&gt;31&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<p>Observe que, quando o formulário for enviado, não haverá um único valor no <em>hash</em> <code>params</code> que contenha a data completa. Em vez disso, haverá vários valores com nomes especiais como <code>"birth_date(1i) "</code>. O <em>Active Record</em> sabe como reunir esses valores com nomes especiais em uma data ou hora completa, com base no tipo declarado do atributo do <em>model</em>. Portanto, podemos passar <code>params [:person]</code> para, por exemplo, <code>Person.new</code> ou <code>Person#update</code> exatamente como faríamos se o formulário usasse um único campo para representar a data completa.</p><p>Além do auxiliar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-date_select"><code>date_select</code></a>, o Rails provê os auxiliares <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-time_select"><code>time_select</code></a> e <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-datetime_select"><code>datetime_select</code></a>.</p><h4 id="caixas-de-seleção-select-boxes-para-componentes-individuais-de-tempo"><a class="anchorlink" href="#caixas-de-sele%C3%A7%C3%A3o-select-boxes-para-componentes-individuais-de-tempo">4.1 Caixas de Seleção (<em>Select Boxes</em>) para Componentes Individuais de Tempo</a></h4><p>O Rails também fornece auxiliares para renderizar caixas de seleção para componentes temporais individuais: <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_year"><code>select_year</code></a>, <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_month"><code>select_month</code></a>, <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_day"><code>select_day</code></a>, <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_hour"><code>select_hour</code></a>, <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_minute"><code>select_minute</code></a>, and <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/DateHelper.html#method-i-select_second"><code>select_second</code></a>. Esses auxiliares são métodos "básicos", o que significa que não são chamados em uma instância do construtor de formulários. Por exemplo:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">select_year</span> <span class="mi">1999</span><span class="p">,</span> <span class="ss">prefix: </span><span class="s2">"party"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= select_year 1999, prefix: "party" %&gt;
'>Copy</button>
</div>
<p>Cria uma caixa de seleção como essa:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"party[year]"</span> <span class="na">id=</span><span class="s">"party_year"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1994"</span><span class="nt">&gt;</span>1994<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1995"</span><span class="nt">&gt;</span>1995<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1996"</span><span class="nt">&gt;</span>1996<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1997"</span><span class="nt">&gt;</span>1997<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1998"</span><span class="nt">&gt;</span>1998<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1999"</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>1999<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2000"</span><span class="nt">&gt;</span>2000<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2001"</span><span class="nt">&gt;</span>2001<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2002"</span><span class="nt">&gt;</span>2002<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2003"</span><span class="nt">&gt;</span>2003<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2004"</span><span class="nt">&gt;</span>2004<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="party[year]" id="party_year"&gt;
  &lt;option value="1994"&gt;1994&lt;/option&gt;
  &lt;option value="1995"&gt;1995&lt;/option&gt;
  &lt;option value="1996"&gt;1996&lt;/option&gt;
  &lt;option value="1997"&gt;1997&lt;/option&gt;
  &lt;option value="1998"&gt;1998&lt;/option&gt;
  &lt;option value="1999" selected="selected"&gt;1999&lt;/option&gt;
  &lt;option value="2000"&gt;2000&lt;/option&gt;
  &lt;option value="2001"&gt;2001&lt;/option&gt;
  &lt;option value="2002"&gt;2002&lt;/option&gt;
  &lt;option value="2003"&gt;2003&lt;/option&gt;
  &lt;option value="2004"&gt;2004&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<p>Para cada um desses auxiliares, você pode especificar um objeto de data ou hora em vez de um número como o valor padrão e o componente temporal apropriado será extraído e usado.</p><h3 id="escolhas-a-partir-de-uma-coleção-de-objetos-arbitrários"><a class="anchorlink" href="#escolhas-a-partir-de-uma-cole%C3%A7%C3%A3o-de-objetos-arbitr%C3%A1rios">5 Escolhas a partir de uma Coleção de Objetos Arbitrários</a></h3><p>Sometimes, we want to generate a set of choices from a collection of arbitrary objects. For example, if we have a <code>City</code> model and corresponding <code>belongs_to :city</code> association:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">City</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:city</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class City &lt; ApplicationRecord
end

class Person &lt; ApplicationRecord
  belongs_to :city
end
">Copy</button>
</div>
<div class="code_container">
<pre><code class="highlight ruby"><span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">city</span><span class="o">|</span> <span class="p">[</span><span class="n">city</span><span class="p">.</span><span class="nf">name</span><span class="p">,</span> <span class="n">city</span><span class="p">.</span><span class="nf">id</span><span class="p">]</span> <span class="p">}</span>
<span class="c1"># =&gt; [["Berlin", 3], ["Chicago", 1], ["Madrid", 2]]</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='City.order(:name).map { |city| [city.name, city.id] }
# =&gt; [["Berlin", 3], ["Chicago", 1], ["Madrid", 2]]
'>Copy</button>
</div>
<p>Then we can allow the user to choose a city from the database with the following form:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">).</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">city</span><span class="o">|</span> <span class="p">[</span><span class="n">city</span><span class="p">.</span><span class="nf">name</span><span class="p">,</span> <span class="n">city</span><span class="p">.</span><span class="nf">id</span><span class="p">]</span> <span class="p">}</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  &lt;%= form.select :city_id, City.order(:name).map { |city| [city.name, city.id] } %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<div class="note"><p>When rendering a field for a <code>belongs_to</code> association, you must specify the name of the foreign key (<code>city_id</code> in the above example), rather than the name of the association itself.</p></div><p>However, Rails provides helpers that generate choices from a collection without having to explicitly iterate over it. These helpers determine the value and text label of each choice by calling specified methods on each object in the collection.</p><h4 id="o-auxiliar-collection-select"><a class="anchorlink" href="#o-auxiliar-collection-select">5.1 O auxiliar <code>collection_select</code></a></h4><p>Para gerar uma caixa de seleção (<em>select box</em>) podemos utilizar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_select"><code>collection_select</code></a>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form.collection_select :city_id, City.order(:name), :id, :name %&gt;
">Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">id=</span><span class="s">"person_city_id"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"3"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;select name="person[city_id]" id="person_city_id"&gt;
  &lt;option value="3"&gt;Berlin&lt;/option&gt;
  &lt;option value="1"&gt;Chicago&lt;/option&gt;
  &lt;option value="2"&gt;Madrid&lt;/option&gt;
&lt;/select&gt;
'>Copy</button>
</div>
<div class="note"><p>Utilizando <code>collection_select</code> devemos especificar primeiramente o método para o valor (<code>:id</code> no exemplo acima), e em seguida o método do texto descritivo (<code>:name</code> no exemplo acima).  Essa ordem é inversa a quando especificamos escolhas para o <em>helper</em> <code>select</code>, onde primeiramente passamos o texto descritivo e em seguida o valor.</p></div><h4 id="o-auxiliar-collection-radio-buttons"><a class="anchorlink" href="#o-auxiliar-collection-radio-buttons">5.2 O auxiliar <code>collection_radio_buttons</code></a></h4><p>Para gerar um conjunto de botões de rádio (<em>radio buttons</em>), podemos utilizar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_radio_buttons"><code>collection_radio_buttons</code></a>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_radio_buttons</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form.collection_radio_buttons :city_id, City.order(:name), :id, :name %&gt;
">Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">value=</span><span class="s">"3"</span> <span class="na">id=</span><span class="s">"person_city_id_3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_3"</span><span class="nt">&gt;</span>Berlin<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">id=</span><span class="s">"person_city_id_1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_1"</span><span class="nt">&gt;</span>Chicago<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">name=</span><span class="s">"person[city_id]"</span> <span class="na">value=</span><span class="s">"2"</span> <span class="na">id=</span><span class="s">"person_city_id_2"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_city_id_2"</span><span class="nt">&gt;</span>Madrid<span class="nt">&lt;/label&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input type="radio" name="person[city_id]" value="3" id="person_city_id_3"&gt;
&lt;label for="person_city_id_3"&gt;Berlin&lt;/label&gt;

&lt;input type="radio" name="person[city_id]" value="1" id="person_city_id_1"&gt;
&lt;label for="person_city_id_1"&gt;Chicago&lt;/label&gt;

&lt;input type="radio" name="person[city_id]" value="2" id="person_city_id_2"&gt;
&lt;label for="person_city_id_2"&gt;Madrid&lt;/label&gt;
'>Copy</button>
</div>
<h4 id="o-auxiliar-collection-check-boxes"><a class="anchorlink" href="#o-auxiliar-collection-check-boxes">5.3 O auxiliar <code>collection_check_boxes</code></a></h4><p>To generate a set of check boxes — for example, to support a <code>has_and_belongs_to_many</code> association — we can use <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-collection_check_boxes"><code>collection_check_boxes</code></a>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">collection_check_boxes</span> <span class="ss">:interest_ids</span><span class="p">,</span> <span class="no">Interest</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:name</span><span class="p">),</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form.collection_check_boxes :interest_ids, Interest.order(:name), :id, :name %&gt;
">Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"3"</span> <span class="na">id=</span><span class="s">"person_interest_id_3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_3"</span><span class="nt">&gt;</span>Engineering<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"4"</span> <span class="na">id=</span><span class="s">"person_interest_id_4"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_4"</span><span class="nt">&gt;</span>Math<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="na">id=</span><span class="s">"person_interest_id_1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_1"</span><span class="nt">&gt;</span>Science<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"person[interest_id][]"</span> <span class="na">value=</span><span class="s">"2"</span> <span class="na">id=</span><span class="s">"person_interest_id_2"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"person_interest_id_2"</span><span class="nt">&gt;</span>Technology<span class="nt">&lt;/label&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input type="checkbox" name="person[interest_id][]" value="3" id="person_interest_id_3"&gt;
&lt;label for="person_interest_id_3"&gt;Engineering&lt;/label&gt;

&lt;input type="checkbox" name="person[interest_id][]" value="4" id="person_interest_id_4"&gt;
&lt;label for="person_interest_id_4"&gt;Math&lt;/label&gt;

&lt;input type="checkbox" name="person[interest_id][]" value="1" id="person_interest_id_1"&gt;
&lt;label for="person_interest_id_1"&gt;Science&lt;/label&gt;

&lt;input type="checkbox" name="person[interest_id][]" value="2" id="person_interest_id_2"&gt;
&lt;label for="person_interest_id_2"&gt;Technology&lt;/label&gt;
'>Copy</button>
</div>
<h3 id="enviando-arquivos"><a class="anchorlink" href="#enviando-arquivos">6 Enviando Arquivos</a></h3><p>Uma tarefa muito comum é fazer o envio de arquivos, seja a imagem de uma pessoa ou um arquivo CSV contendo dados a serem processados. Campos para upload de arquivos podem ser renderizados com o auxiliar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-file_field"><code>file_field</code></a>.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">file_field</span> <span class="ss">:picture</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  &lt;%= form.file_field :picture %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>O mais importante a se lembrar quando se faz envio de arquivos é que o atributo <code>enctype</code> do formulário renderizado <strong>deve</strong> ser "multipart/form-data". Isso pode ser feito automaticamente se você usar <code>file_field</code> dentro de um <code>form_with</code>. Você pode definir o atributo manualmente:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s2">"/uploads"</span><span class="p">,</span> <span class="ss">multipart: </span><span class="kp">true</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">file_field_tag</span> <span class="ss">:picture</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with url: "/uploads", multipart: true do |form| %&gt;
  &lt;%= file_field_tag :picture %&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
<p>Observe que, de acordo com as convenções do <code>form_with</code>, os nomes dos campos nas duas formas acima também serão diferentes. Ou seja, o nome do campo no primeiro formulário será <code>person[picture]</code> (acessível via <code>params[:person][:picture]</code>), e o nome do campo no segundo formulário será apenas <code>picture</code> (acessível via <code>params[:picture]</code>).</p><h4 id="o-que-é-enviado"><a class="anchorlink" href="#o-que-%C3%A9-enviado">6.1 O que é enviado</a></h4><p>O objeto em <code>params</code> é uma instância de <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionDispatch/Http/UploadedFile.html"><code>ActionDispatch::Http::UploadedFile</code></a>. O trecho de código a seguir salva o arquivo enviado em <code>#{Rails.root}/public/uploads</code> contendo o mesmo nome do arquivo original.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">upload</span>
  <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:picture</span><span class="p">]</span>
  <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'public'</span><span class="p">,</span> <span class="s1">'uploads'</span><span class="p">,</span> <span class="n">uploaded_file</span><span class="p">.</span><span class="nf">original_filename</span><span class="p">),</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
    <span class="n">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">.</span><span class="nf">read</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def upload
  uploaded_file = params[:picture]
  File.open(Rails.root.join('public', 'uploads', uploaded_file.original_filename), 'wb') do |file|
    file.write(uploaded_file.read)
  end
end
">Copy</button>
</div>
<p>Uma vez que o arquivo é enviado, há uma infinidade de tarefas em potencial, variando entre onde armazenar os arquivos (no Disco, Amazon S3, etc), associá-lo com models, redimensionar arquivos de imagem e gerar miniaturas, etc. O <a href="active_storage_overview.html">Active Storage</a> é destinado a ajudar com essas tarefas.</p><h3 id="customizando-os-construtores-de-formulários"><a class="anchorlink" href="#customizando-os-construtores-de-formul%C3%A1rios">7 Customizando os Construtores de Formulários</a></h3><p>The object yielded by <code>form_with</code> and <code>fields_for</code> is an instance of
<a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html"><code>ActionView::Helpers::FormBuilder</code></a>.
Form builders encapsulate the notion of displaying form elements for a single object. While you can write helpers for
your forms in the usual way, you can also create a subclass of <code>ActionView::Helpers::FormBuilder</code>, and add the helpers
there. For example, assuming you have a helper method defined in your application called <code>text_field_with_label</code> as the
following</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">module</span> <span class="nn">ApplicationHelper</span>
  <span class="k">def</span> <span class="nf">text_field_with_label</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
    <span class="n">form</span><span class="p">.</span><span class="nf">label</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="module ApplicationHelper
  def text_field_with_label(form, attribute)
    form.label(attribute) + form.text_field(attribute)
  end
end
">Copy</button>
</div>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">text_field_with_label</span> <span class="n">form</span><span class="p">,</span> <span class="ss">:first_name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  &lt;%= text_field_with_label form, :first_name %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>pode ser substituído por</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span><span class="p">,</span> <span class="ss">builder: </span><span class="no">LabellingFormBuilder</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:first_name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person, builder: LabellingFormBuilder do |form| %&gt;
  &lt;%= form.text_field :first_name %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Por meio da definição de uma classe <code>LabellingFormBuilder</code> parecida com a que segue:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">LabellingFormBuilder</span> <span class="o">&lt;</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">Helpers</span><span class="o">::</span><span class="no">FormBuilder</span>
  <span class="k">def</span> <span class="nf">text_field</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{})</span>
    <span class="n">label</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">+</span> <span class="k">super</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class LabellingFormBuilder &lt; ActionView::Helpers::FormBuilder
  def text_field(attribute, options={})
    label(attribute) + super
  end
end
">Copy</button>
</div>
<p>Se você reutilizar isso frequentemente, você pode definir um <em>helper</em> <code>labeled_form_with</code> que automaticamente
aplica a opção <code>builder: LabellingFormBuilder</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">module</span> <span class="nn">ApplicationHelper</span>
  <span class="k">def</span> <span class="nf">labeled_form_with</span><span class="p">(</span><span class="ss">model: </span><span class="kp">nil</span><span class="p">,</span> <span class="ss">scope: </span><span class="kp">nil</span><span class="p">,</span> <span class="ss">url: </span><span class="kp">nil</span><span class="p">,</span> <span class="ss">format: </span><span class="kp">nil</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
    <span class="n">options</span><span class="p">.</span><span class="nf">merge!</span> <span class="ss">builder: </span><span class="no">LabellingFormBuilder</span>
    <span class="n">form_with</span> <span class="ss">model: </span><span class="n">model</span><span class="p">,</span> <span class="ss">scope: </span><span class="n">scope</span><span class="p">,</span> <span class="ss">url: </span><span class="n">url</span><span class="p">,</span> <span class="ss">format: </span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="module ApplicationHelper
  def labeled_form_with(model: nil, scope: nil, url: nil, format: nil, **options, &amp;block)
    options.merge! builder: LabellingFormBuilder
    form_with model: model, scope: scope, url: url, format: format, **options, &amp;block
  end
end
">Copy</button>
</div>
<p>O construtor de formulários utilizado também determina o que acontece quando você escreve:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="n">f</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= render partial: f %&gt;
">Copy</button>
</div>
<p>Se <code>f</code> for uma instância de <code>ActionView::Helpers::FormBuilder</code>, então isso vai renderizar a <em>partial</em> <code>form</code>,
passando o objeto da <em>partial</em> para o construtor de formulários. Se o construtor de formulário for da classe
<code>LabellingFormBuilder</code> então a partial <code>labelling_form</code> é que seria renderizada.</p><h3 id="entendendo-convenções-de-nomeação-de-parâmetros"><a class="anchorlink" href="#entendendo-conven%C3%A7%C3%B5es-de-nomea%C3%A7%C3%A3o-de-par%C3%A2metros">8 Entendendo Convenções de Nomeação de Parâmetros</a></h3><p>Valores de formulários podem ficar no topo do <em>hash</em> <code>params</code> ou aninhados em outro <em>hash</em>. Por exemplo, numa ação <code>create</code> padrão para um <em>model</em> <code>Person</code>, <code>params[:person]</code> normalmente seria um <em>hash</em> de todos os atributos necessários para criar uma pessoa. O <em>hash</em> <code>params</code> também pode conter <em>arrays</em>, <em>arrays</em> de <em>hashes</em>, e por aí vai.</p><p>Fundamentalmente formulários HTML não tem conhecimento de nenhum tipo de dado estruturado, tudo que eles geram são pares de nomes e valores, onde os pares são <em>strings</em> simples. Os <em>arrays</em> e <em>hashes</em> que você vê na sua aplicação são o resultado de algumas convenções de nomeação que o Rails utiliza.</p><h4 id="estruturas-básicas"><a class="anchorlink" href="#estruturas-b%C3%A1sicas">8.1 Estruturas Básicas</a></h4><p>As duas estruturas básicas são <em>arrays</em> e <em>hashes</em>. <em>Hashes</em> copiam a sintaxe utilizada para acessar o valor em <code>params</code>. Por exemplo, se um formulário contém:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"Henry"</span><span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input id="person_name" name="person[name]" type="text" value="Henry"/&gt;
'>Copy</button>
</div>
<p>o <em>hash</em> <code>params</code> conterá</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span><span class="s1">'person'</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Henry'</span><span class="p">}}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{'person' =&gt; {'name' =&gt; 'Henry'}}
">Copy</button>
</div>
<p>e <code>params[:person][:name]</code> buscará o valor enviado dentro do <em>controller</em>.</p><p><em>Hashes</em> podem ser aninhados em quantos níveis for necessário, por exemplo:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_city"</span> <span class="na">name=</span><span class="s">"person[address][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"New York"</span><span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input id="person_address_city" name="person[address][city]" type="text" value="New York"/&gt;
'>Copy</button>
</div>
<p>resultará no <em>hash</em> <code>params</code> como</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span><span class="s1">'person'</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s1">'address'</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s1">'city'</span> <span class="o">=&gt;</span> <span class="s1">'New York'</span><span class="p">}}}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{'person' =&gt; {'address' =&gt; {'city' =&gt; 'New York'}}}
">Copy</button>
</div>
<p>Normalmente o Rails ignora nomes de parâmetros duplicados. Se o parâmetro <em>name</em> termina em um conjunto vazio de colchetes <code>[]</code> então eles serão acumulados em um <em>array</em>. Se você queria que os usuários pudessem informar vários números de telefone, você poderia colocar isto no formulário:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[phone_number][]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input name="person[phone_number][]" type="text"/&gt;
&lt;input name="person[phone_number][]" type="text"/&gt;
&lt;input name="person[phone_number][]" type="text"/&gt;
'>Copy</button>
</div>
<p>Isto resultará em <code>params[:person][:phone_number]</code> como um <em>array</em> contendo os números de telefone informados.</p><h4 id="combinando-os-conceitos"><a class="anchorlink" href="#combinando-os-conceitos">8.2 Combinando os Conceitos</a></h4><p>Podemos combinar estes dois conceitos. Um elemento de um <em>hash</em> pode ser um <em>array</em> como no exemplo anterior, ou você pode ter um <em>array</em> de <em>hashes</em>. Por exemplo, um formulário pode permitir a criação de um número arbitrário de <em>addresses</em> ao repetir o fragmento de formulário seguinte</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line1]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line2]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][city]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line1]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][line2]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"person[addresses][][city]"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input name="person[addresses][][line1]" type="text"/&gt;
&lt;input name="person[addresses][][line2]" type="text"/&gt;
&lt;input name="person[addresses][][city]" type="text"/&gt;
&lt;input name="person[addresses][][line1]" type="text"/&gt;
&lt;input name="person[addresses][][line2]" type="text"/&gt;
&lt;input name="person[addresses][][city]" type="text"/&gt;
'>Copy</button>
</div>
<p>Isto resultará em <code>params[:person][:addresses]</code> como um <em>array</em> de <em>hashes</em> com as chaves <code>line1</code>, <code>line2</code>, e <code>city</code>.</p><p>Porém, há uma restrição. Enquanto os <em>hashes</em> podem ser aninhados de forma arbitrária, só é permitido um nível de <em>"arrayness"</em>. <em>Arrays</em> normalmente podem ser trocados por <em>hashes</em>; por exemplo, ao invés de usar um <em>array</em> de <em>model objects</em>, é possível usar um <em>hash</em> de <em>model objects</em> distinguidos pelo seu <em>id</em>, um índice do <em>array</em>, ou algum outro parâmetro.</p><div class="warning"><p>Parâmetros de <em>array</em> não funcionam bem com o <em>helper</em> <code>check_box</code>. De acordo com a especificação HTML <em>checkboxes</em> desmarcadas não enviam nenhum valor. Porém pode ser conveniente fazer com que uma <em>checkbox</em> sempre envie um valor. O <em>helper</em> <code>check_box</code> simula isto ao criar um <em>input</em> auxiliar com o mesmo nome. Se a <em>checkbox</em> estiver desmarcada apenas o <em>input</em> escondido será enviado e se estiver marcada então os dois serão enviados mas o valor da <em>checkbox</em> recebe uma prioridade maior.</p></div><h4 id="utilizando-o-auxiliar-fields-for-com-a-opção-index"><a class="anchorlink" href="#utilizando-o-auxiliar-fields-for-com-a-op%C3%A7%C3%A3o-index">8.3 Utilizando o auxiliar <code>fields_for</code> com a opção <code>:index</code></a></h4><p>Digamos que queremos renderizar um formulário com um conjunto de campos para cada endereço de uma pessoa. O auxiliar <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormBuilder.html#method-i-fields_for"><code>fields_for</code></a> e seu argumento<code>: index</code> podem ajudar com isso:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">person_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">addresses</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">address</span><span class="o">|</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">person_form</span><span class="p">.</span><span class="nf">fields_for</span> <span class="n">address</span><span class="p">,</span> <span class="ss">index: </span><span class="n">address</span><span class="p">.</span><span class="nf">id</span> <span class="k">do</span> <span class="o">|</span><span class="n">address_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">address_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:city</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |person_form| %&gt;
  &lt;%= person_form.text_field :name %&gt;
  &lt;% @person.addresses.each do |address| %&gt;
    &lt;%= person_form.fields_for address, index: address.id do |address_form| %&gt;
      &lt;%= address_form.text_field :city %&gt;
    &lt;% end %&gt;
  &lt;% end %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Presumindo que a pessoa (<em>person</em>) tenha dois endereços (<em>addresses</em>), com <em>ids</em> 23 e 45 o formulário acima trará um resultado similar a este:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/people/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_name"</span> <span class="na">name=</span><span class="s">"person[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_23_city"</span> <span class="na">name=</span><span class="s">"person[address][23][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_45_city"</span> <span class="na">name=</span><span class="s">"person[address][45][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;form accept-charset="UTF-8" action="/people/1" method="post"&gt;
  &lt;input name="_method" type="hidden" value="patch" /&gt;
  &lt;input id="person_name" name="person[name]" type="text" /&gt;
  &lt;input id="person_address_23_city" name="person[address][23][city]" type="text" /&gt;
  &lt;input id="person_address_45_city" name="person[address][45][city]" type="text" /&gt;
&lt;/form&gt;
'>Copy</button>
</div>
<p>Isto resultará em um <em>hash</em> <code>params</code> parecido com:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="s2">"person"</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Bob"</span><span class="p">,</span>
    <span class="s2">"address"</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s2">"23"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"Paris"</span>
      <span class="p">},</span>
      <span class="s2">"45"</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s2">"city"</span> <span class="o">=&gt;</span> <span class="s2">"London"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  "person" =&gt; {
    "name" =&gt; "Bob",
    "address" =&gt; {
      "23" =&gt; {
        "city" =&gt; "Paris"
      },
      "45" =&gt; {
        "city" =&gt; "London"
      }
    }
  }
}
'>Copy</button>
</div>
<p>All of the form inputs map to the <code>"person"</code> hash because we called <code>fields_for</code>
on the <code>person_form</code> form builder. By specifying an <code>:index</code> option, we mapped
the address inputs to <code>person[address][#{address.id}][city]</code> instead of
<code>person[address][city]</code>. Thus we are able to determine which Address records
should be modified when processing the <code>params</code> hash.</p><p>Você pode passar outros números ou <em>strings</em> de significância através da opção <code>:index</code>.
Você pode até passar <code>nil</code>, que produzirá um parâmetro de array.</p><p>Para criar aninhamentos mais complexos, você pode especificar a parte inicial do
nome de entrada explicitamente. Por exemplo:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">fields_for</span> <span class="s1">'person[address][primary]'</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="ss">index: </span><span class="n">address</span><span class="p">.</span><span class="nf">id</span> <span class="k">do</span> <span class="o">|</span><span class="n">address_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">address_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:city</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= fields_for 'person[address][primary]', address, index: address.id do |address_form| %&gt;
  &lt;%= address_form.text_field :city %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>criará <em>inputs</em> como:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"person_address_primary_23_city"</span> <span class="na">name=</span><span class="s">"person[address][primary][23][city]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"Paris"</span> <span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input id="person_address_primary_23_city" name="person[address][primary][23][city]" type="text" value="Paris" /&gt;
'>Copy</button>
</div>
<p>Você também pode passar uma opção <code>:index</code> diretamente para auxiliares como <code>text_field</code>,
mas geralmente é menos repetitivo especificar isso no nível do construtor de formulários
do que em campos de entrada individuais.</p><p>Falando de forma geral, o nome do <em>input</em> final será uma concatenação do nome
dado a <code>fields_for</code> / <code>form_with</code>, o valor da opção <code>:index</code> e o nome do
o atributo.</p><p>Por último, como um atalho, ao invés de especificar um ID para <code>:index</code> (<code>index: address:id</code>), você pode usar <code>"[]"</code> ao nome e omitir a opção <code>:index</code>. Por exemplo:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">fields_for</span> <span class="s1">'person[address][primary][]'</span><span class="p">,</span> <span class="n">address</span> <span class="k">do</span> <span class="o">|</span><span class="n">address_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">address_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:city</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= fields_for 'person[address][primary][]', address do |address_form| %&gt;
  &lt;%= address_form.text_field :city %&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>produz exatamente o mesmo resultado que o exemplo original.</p><h3 id="formulários-para-recursos-externos"><a class="anchorlink" href="#formul%C3%A1rios-para-recursos-externos">9 Formulários para Recursos Externos</a></h3><p>Os <em>helpers</em> de formulários do Rails também podem ser usados para construir formulários para enviar dados para recursos externos. Entretanto em alguns momentos pode ser necessário definir um <code>authenticity_token</code> para o recurso; isso pode ser feito passando um parâmetro <code>authenticity_token: 'your_external_token'</code> para as opções do <code>form_with</code></p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s1">'http://farfar.away/form'</span><span class="p">,</span> <span class="ss">authenticity_token: </span><span class="s1">'external_token'</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Form contents
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with url: 'http://farfar.away/form', authenticity_token: 'external_token' do %&gt;
  Form contents
&lt;% end %&gt;
">Copy</button>
</div>
<p>Às vezes ao submeter dados para um recurso externo, como um <em>gateway</em> de pagamento, os campos que podem ser usado no formulário são limitados por uma API externa e pode ser indesejável gerar um <code>authenticity_token</code>. Para não enviar um token, simplesmente passe <code>false</code> para o parâmetro <code>:authenticity_token</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">url: </span><span class="s1">'http://farfar.away/form'</span><span class="p">,</span> <span class="ss">authenticity_token: </span><span class="kp">false</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Form contents
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with url: 'http://farfar.away/form', authenticity_token: false do %&gt;
  Form contents
&lt;% end %&gt;
">Copy</button>
</div>
<h3 id="trabalhando-com-formulários-complexos"><a class="anchorlink" href="#trabalhando-com-formul%C3%A1rios-complexos">10 Trabalhando com Formulários Complexos</a></h3><p>Muitas aplicações vão além de uma edição de um único objeto em um formulário simples. Por exemplo, quando estamos criando um <em>model</em> <code>Person</code> você pode querer que o usuário permita (no mesmo formulário) criar múltiplos registros de endereços (casa, trabalho, etc.). Mais tarde, quando estivesse editando este formulário, seria possível adicionar, remover, ou corrigir os endereços relacionados caso fosse necessário.</p><h4 id="configurando-o-model"><a class="anchorlink" href="#configurando-o-model">10.1 Configurando o <em>Model</em></a></h4><p>O Active Record fornece suporte a níveis de modelo através do método <a href="https://api.rubyonrails.org/v7.0.8/classes/ActiveRecord/NestedAttributes/ClassMethods.html#method-i-accepts_nested_attributes_for"><code>accepts_nested_attributes_for</code></a>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">inverse_of: :person</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Address</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:person</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class Person &lt; ApplicationRecord
  has_many :addresses, inverse_of: :person
  accepts_nested_attributes_for :addresses
end

class Address &lt; ApplicationRecord
  belongs_to :person
end
">Copy</button>
</div>
<p>Isso criará um método chamado <code>addresses_attributes=</code> no model <code>Person</code> para permitir criar, atualizar e (opcionalmente) destruir endereços.</p><h4 id="formulários-aninhados"><a class="anchorlink" href="#formul%C3%A1rios-aninhados">10.2 Formulários Aninhados</a></h4><p>O formulário a seguir permite ao usuário criar uma <code>Pessoa</code> e seus endereços associados.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  Endereços:
  <span class="nt">&lt;ul&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;li&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:kind</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:kind</span> <span class="cp">%&gt;</span>

        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:street</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:street</span> <span class="cp">%&gt;</span>
        ...
      <span class="nt">&lt;/li&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  Endereços:
  &lt;ul&gt;
    &lt;%= form_with model: @person do |f| %&gt;
      &lt;li&gt;
        &lt;%= addresses_form.label :kind %&gt;
        &lt;%= addresses_form.text_field :kind %&gt;

        &lt;%= addresses_form.label :street %&gt;
        &lt;%= addresses_form.text_field :street %&gt;
        ...
      &lt;/li&gt;
    &lt;% end %&gt;
  &lt;/ul&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Quando uma associação aceita atributos aninhados, o método <code>fields_for</code> renderiza esse bloco uma vez para cada elemento da associação. Em particular, se a pessoa não tiver endereços nada será renderizado. Um padrão comum é o controller criar um ou mais filhos vazios para que pelo menos um bloco de campos seja exibido ao usuário. O exemplo a seguir irá resultar em dois blocos de campos de endereços no formulário de uma nova pessoa.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">new</span>
  <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span>
  <span class="mi">2</span><span class="p">.</span><span class="nf">times</span> <span class="p">{</span> <span class="vi">@person</span><span class="p">.</span><span class="nf">addresses</span><span class="p">.</span><span class="nf">build</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def new
  @person = Person.new
  2.times { @person.addresses.build }
end
">Copy</button>
</div>
<p>O método<code>fields_for</code> produz um construtor de formulário. Os nomes dos parâmetros serão o que o
<code>accepts_nested_attributes_for</code> espera. Por exemplo, quando criamos uma pessoa com dois endereços,
os parâmetros enviados serão:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="p">{</span>
  <span class="s1">'person'</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'John Doe'</span><span class="p">,</span>
    <span class="s1">'addresses_attributes'</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="s1">'0'</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s1">'kind'</span> <span class="o">=&gt;</span> <span class="s1">'Home'</span><span class="p">,</span>
        <span class="s1">'street'</span> <span class="o">=&gt;</span> <span class="s1">'221b Baker Street'</span>
      <span class="p">},</span>
      <span class="s1">'1'</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="s1">'kind'</span> <span class="o">=&gt;</span> <span class="s1">'Office'</span><span class="p">,</span>
        <span class="s1">'street'</span> <span class="o">=&gt;</span> <span class="s1">'31 Spooner Street'</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  'person' =&gt; {
    'name' =&gt; 'John Doe',
    'addresses_attributes' =&gt; {
      '0' =&gt; {
        'kind' =&gt; 'Home',
        'street' =&gt; '221b Baker Street'
      },
      '1' =&gt; {
        'kind' =&gt; 'Office',
        'street' =&gt; '31 Spooner Street'
      }
    }
  }
}
">Copy</button>
</div>
<p>As chaves da hash <code>:addresses_attributes</code> não são importantes, eles apenas precisam ser diferentes para cada endereço.</p><p>Se o objeto associado já estiver salvo, o método <code>fields_for</code> ir gerá automaticamente uma entrada oculta com o <code>id</code> do registro salvo.
Você pode desabilitar isso passando <code>include_id: false</code> para o <code>fields_for</code>.</p><h4 id="o-controller"><a class="anchorlink" href="#o-controller">10.3 O <em>Controller</em></a></h4><p>Como de costume, você precisa <a href="action_controller_overview.html#parametros-fortes">declarar os parâmetros permitidos</a>
dentro do controller antes de enviá-los para o <em>model</em>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">create</span>
  <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">person_params</span><span class="p">)</span>
  <span class="c1"># ...</span>
<span class="k">end</span>

<span class="kp">private</span>
  <span class="k">def</span> <span class="nf">person_params</span>
    <span class="n">params</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="ss">:person</span><span class="p">).</span><span class="nf">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">addresses_attributes: </span><span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:kind</span><span class="p">,</span> <span class="ss">:street</span><span class="p">])</span>
  <span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def create
  @person = Person.new(person_params)
  # ...
end

private
  def person_params
    params.require(:person).permit(:name, addresses_attributes: [:id, :kind, :street])
  end
">Copy</button>
</div>
<h4 id="removendo-objetos"><a class="anchorlink" href="#removendo-objetos">10.4 Removendo objetos</a></h4><p>Você pode permitir os usuários deletarem os objetos associados ao passar o parâmetro <code>allow_destroy: true</code> para o <code>accepts_nested_attributes_for</code></p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">allow_destroy: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class Person &lt; ApplicationRecord
  has_many :addresses
  accepts_nested_attributes_for :addresses, allow_destroy: true
end
">Copy</button>
</div>
<p>Se a <em>hash</em> de atributos de um objeto contém a chave <code>_destroy</code> com um valor que
representa <code>true</code> (ex: 1, '1', true ou 'true'), então o objeto será destruído.
O formulário a seguir permite o usuário remover endereços:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="vi">@person</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  Addresses:
  <span class="nt">&lt;ul&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">fields_for</span> <span class="ss">:addresses</span> <span class="k">do</span> <span class="o">|</span><span class="n">addresses_form</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;li&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">check_box</span> <span class="ss">:_destroy</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">label</span> <span class="ss">:tipo</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">addresses_form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:tipo</span> <span class="cp">%&gt;</span>
        ...
      <span class="nt">&lt;/li&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: @person do |form| %&gt;
  Addresses:
  &lt;ul&gt;
    &lt;%= form.fields_for :addresses do |addresses_form| %&gt;
      &lt;li&gt;
        &lt;%= addresses_form.check_box :_destroy %&gt;
        &lt;%= addresses_form.label :tipo %&gt;
        &lt;%= addresses_form.text_field :tipo %&gt;
        ...
      &lt;/li&gt;
    &lt;% end %&gt;
  &lt;/ul&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Não esqueça de atualizar a lista de parâmetros permitidos no seu <em>controller</em> para
incluir também o campo <code>_destroy</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">person_params</span>
  <span class="n">params</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="ss">:person</span><span class="p">).</span><span class="nf">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">addresses_attributes: </span><span class="p">[</span><span class="ss">:id</span><span class="p">,</span> <span class="ss">:kind</span><span class="p">,</span> <span class="ss">:street</span><span class="p">,</span> <span class="ss">:_destroy</span><span class="p">])</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def person_params
  params.require(:person).permit(:name, addresses_attributes: [:id, :kind, :street, :_destroy])
end
">Copy</button>
</div>
<h4 id="prevenindo-registros-vazios"><a class="anchorlink" href="#prevenindo-registros-vazios">10.5 Prevenindo Registros Vazios</a></h4><p>Pode ser útil ignorar um conjunto de campos que o usuário não preencheu. Você pode controlar isso ao passar um proc <code>:reject_if</code> para o
<code>accepts_nested_attributes_for</code>. Essa <em>proc</em> será chamada com cada <em>hash</em> de atributos enviados pelo formulário. Se a proc retornar <code>true</code> então o Active Record não irá construir o objeto associado para essa <em>hash</em>. O exemplo abaixo tenta construir um endereço apenas se o campo <code>kind</code> for informado.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Person</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:addresses</span>
  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:addresses</span><span class="p">,</span> <span class="ss">reject_if: </span><span class="nb">lambda</span> <span class="p">{</span><span class="o">|</span><span class="n">attributes</span><span class="o">|</span> <span class="n">attributes</span><span class="p">[</span><span class="s1">'kind'</span><span class="p">].</span><span class="nf">blank?</span><span class="p">}</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class Person &lt; ApplicationRecord
  has_many :addresses
  accepts_nested_attributes_for :addresses, reject_if: lambda {|attributes| attributes['kind'].blank?}
end
">Copy</button>
</div>
<p>Para facilitar, você pode passar o <em>symbol</em> <code>:all_blank</code> no lugar, que irá criar uma proc para rejeitar os registros onde todos os atributos
são vazios, excluindo qualquer valor para o <code>_destroy</code>.</p><h4 id="adicionando-campos-dinamicamente"><a class="anchorlink" href="#adicionando-campos-dinamicamente">10.6 Adicionando campos dinamicamente</a></h4><p>No lugar de renderizar múltiplos blocos de campos antecipadamente, você pode desejar adicioná-los apenas quando o usuário clicar em um botão "Adicionar novo endereço". O Rails não possui nenhum suporte nativo para isso. Quando geramos um novo bloco de campos, devemos
garantir que a chave do array associado é único - utilizar a data atual via JavaScript em milissegundos <a href="https://pt.wikipedia.org/wiki/Era_Unix">era unix</a>, é bastante comum.</p><h3 id="utilizando-tags-auxiliares-tag-helpers-sem-um-construtor-de-formulário"><a class="anchorlink" href="#utilizando-tags-auxiliares-tag-helpers-sem-um-construtor-de-formul%C3%A1rio">11 Utilizando Tags Auxiliares (<em>Tag Helpers</em>) Sem Um Construtor de Formulário</a></h3><p>Caso você precise renderizar campos de formulário fora do contexto de um construtor de formulário, o Rails oferece tags auxiliares para elementos comuns de formulário. Por exemplo, <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormTagHelper.html#method-i-check_box_tag"><code>check_box_tag</code></a>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">check_box_tag</span> <span class="s2">"accept"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= check_box_tag "accept" %&gt;
'>Copy</button>
</div>
<p>Resultado:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"accept"</span> <span class="na">id=</span><span class="s">"accept"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;input type="checkbox" name="accept" id="accept" value="1" /&gt;
'>Copy</button>
</div>
<p>Geralmente, esses <em>helpers</em> tem o mesmo nome dos <em>helpers</em> do Construtor de Formulários, porém adicionando o sufixo <code>_tag</code>.  Para uma lista completa, consulte a <a href="https://api.rubyonrails.org/v7.0.8/classes/ActionView/Helpers/FormTagHelper.html">documentação da API <code>FormTagHelper</code></a>.</p><h3 id="usando-form-for-e-form-tag"><a class="anchorlink" href="#usando-form-for-e-form-tag">12 Usando <code>form_for</code> e <code>form_tag</code></a></h3><p>Antes do <code>form_with</code> ser introduzido no Rails 5.1 sua funcionalidade costumava ser divida entre <a href="https://api.rubyonrails.org/v5.2/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag"><code>form_tag</code></a> e <a href="https://api.rubyonrails.org/v5.2/classes/ActionView/Helpers/FormHelper.html#method-i-form_for"><code>form_for</code></a>. Ambos estão agora depreciados (<em>soft-deprecated</em>). A documentação sobre seu uso pode ser encontrada na <a href="https://guides.rubyonrails.org/v5.2/form_helpers.html">versão antiga deste guia</a>.</p>

        <h3>Feedback</h3>
        <p>
          Você é incentivado a ajudar a melhorar a qualidade deste guia.
        </p>
        <p>
          Por favor, contribua caso veja quaisquer erros, inclusive erros de digitação.
          Para começar, você pode ler nossa sessão de <a href="https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">contribuindo com a documentação</a>.
        </p>
        <p>
          Você também pode encontrar conteúdo incompleto ou coisas que não estão atualizadas.
          Por favor, adicione qualquer documentação em falta na main do Rails. Certifique-se de checar o
          <a href="http://edgeguides.rubyonrails.org">Edge Guides (en-US)</a> primeiro para verificar
          se o problema já foi resolvido ou não no branch main.
          Verifique as <a href="ruby_on_rails_guides_guidelines.html">Diretrizes do Guia Ruby on Rails</a>
          para estilo e convenções.
        </p>
        <p>
          Se, por qualquer motivo, você encontrar algo para consertar, mas não conseguir consertá-lo, por favor
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">abra uma issue no nosso Guia</a>.
        </p>
        <p>
          E por último, mas não menos importante, qualquer tipo de discussão sobre a documentação do Ruby on Rails
          é muito bem vinda na <a href="https://discuss.rubyonrails.org/c/rubyonrails-docs">forum oficial do Ruby on Rails</a> e nas
          <a href="https://github.com/campuscode/rails-guides-pt-BR/issues">issues do Guia em português</a>.
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p> Este projeto está licenciado sob uma licença <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a></p>
<p>"Rails", "Ruby on Rails", e o logotipo Rails são marcas comerciais de David Heinemeier Hansson. Todos os direitos reservados.</p>

    </div>
  </div>
  <div id="toggle">
    <img alt="dark theme icon" class="icon">
  </div>
</body>
</html>
